<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{-|
Copyright   : Predictable Network Solutions Ltd., 2003-2024
License     : BSD-3-Clause
Description : Plot 'DeltaQ'.

Plot instances of 'DeltaQ' using &quot;Graphics.Rendering.Chart&quot;.
-}</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="DeltaQ.Plot.html"><span class="hs-identifier">DeltaQ.Plot</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DeltaQ.Plot.html#plotCDF"><span class="hs-identifier">plotCDF</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Plot.html#plotCDFs"><span class="hs-identifier">plotCDFs</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Plot.html#plotCDFWithQuantiles"><span class="hs-identifier">plotCDFWithQuantiles</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Plot.html#plotInverseCDF"><span class="hs-identifier">plotInverseCDF</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Plot.html#plotInverseCDFs"><span class="hs-identifier">plotInverseCDFs</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Plot.html#plotInverseCDFWithQuantiles"><span class="hs-identifier">plotInverseCDFWithQuantiles</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="DeltaQ.Class.html"><span class="hs-identifier">DeltaQ.Class</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#Outcome"><span class="hs-identifier">Outcome</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier">Duration</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier">DeltaQ</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#Eventually"><span class="hs-identifier">Eventually</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#eventually"><span class="hs-identifier">eventually</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#maybeFromEventually"><span class="hs-identifier">maybeFromEventually</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Rendering.Chart.Easy</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Rendering.Chart.Easy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Plot
    CDF
------------------------------------------------------------------------------}</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Plot the cumulative distribution function (CDF) of a 'DeltaQ',</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- with title.</span><span>
</span><span id="line-39"></span><span id="local-6989586621679158915"><span class="annot"><a href="DeltaQ.Plot.html#plotCDF"><span class="hs-identifier hs-type">plotCDF</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158915"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-41"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158915"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158915"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158915"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158915"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Title</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679158915"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Outcome to plot</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Layout</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span>
</span><span id="line-49"></span><span id="plotCDF"><span class="annot"><span class="annottext">plotCDF :: forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o),
 Real (Duration o), Real (Probability o)) =&gt;
String -&gt; o -&gt; Layout Double Double
</span><a href="DeltaQ.Plot.html#plotCDF"><span class="hs-identifier hs-var hs-var">plotCDF</span></a></span></span><span> </span><span id="local-6989586621679159081"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159081"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span id="local-6989586621679159082"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159082"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; [(String, o)] -&gt; Layout Double Double
forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o),
 Real (Duration o), Real (Probability o)) =&gt;
String -&gt; [(String, o)] -&gt; Layout Double Double
</span><a href="DeltaQ.Plot.html#plotCDFs"><span class="hs-identifier hs-var">plotCDFs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159081"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159082"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- | Plot multiple CDFs in a single plot,</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- with title.</span><span>
</span><span id="line-54"></span><span id="local-6989586621679158921"><span class="annot"><a href="DeltaQ.Plot.html#plotCDFs"><span class="hs-identifier hs-type">plotCDFs</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-56"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Title</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679158921"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Outcomes with names</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Layout</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span>
</span><span id="line-64"></span><span id="plotCDFs"><span class="annot"><span class="annottext">plotCDFs :: forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o),
 Real (Duration o), Real (Probability o)) =&gt;
String -&gt; [(String, o)] -&gt; Layout Double Double
</span><a href="DeltaQ.Plot.html#plotCDFs"><span class="hs-identifier hs-var hs-var">plotCDFs</span></a></span></span><span> </span><span id="local-6989586621679159130"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159130"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span id="local-6989586621679159131"><span class="annot"><span class="annottext">[(String, o)]
</span><a href="#local-6989586621679159131"><span class="hs-identifier hs-var">namedOutcomes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EC (Layout Double Double) () -&gt; Layout Double Double
forall l a. Default l =&gt; EC l a -&gt; l
</span><span class="hs-identifier hs-var">G.execEC</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double Double) () -&gt; Layout Double Double)
-&gt; EC (Layout Double Double) () -&gt; Layout Double Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; Layout Double Double -&gt; Identity (Layout Double Double)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double Double -&gt; Identity (Layout Double Double))
-&gt; String -&gt; EC (Layout Double Double) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159130"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="annottext">[o] -&gt; EC (Layout Double Double) ()
forall o y.
(DeltaQ o, Real (Duration o), Fractional (Duration o),
 PlotValue y) =&gt;
[o] -&gt; EC (Layout Double y) ()
</span><a href="DeltaQ.Plot.html#add_x_axis"><span class="hs-identifier hs-var">add_x_axis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String, o) -&gt; o) -&gt; [(String, o)] -&gt; [o]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(String, o) -&gt; o
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(String, o)]
</span><a href="#local-6989586621679159131"><span class="hs-identifier hs-var">namedOutcomes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">(LayoutAxis Double -&gt; Identity (LayoutAxis Double))
-&gt; Layout Double Double -&gt; Identity (Layout Double Double)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(LayoutAxis y -&gt; f (LayoutAxis y)) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_y_axis</span></span><span> </span><span class="annot"><span class="annottext">((LayoutAxis Double -&gt; Identity (LayoutAxis Double))
 -&gt; Layout Double Double -&gt; Identity (Layout Double Double))
-&gt; ((String -&gt; Identity String)
    -&gt; LayoutAxis Double -&gt; Identity (LayoutAxis Double))
-&gt; (String -&gt; Identity String)
-&gt; Layout Double Double
-&gt; Identity (Layout Double Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; LayoutAxis Double -&gt; Identity (LayoutAxis Double)
forall x (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; LayoutAxis x -&gt; f (LayoutAxis x)
</span><span class="hs-identifier hs-var">G.laxis_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double Double -&gt; Identity (Layout Double Double))
-&gt; String -&gt; EC (Layout Double Double) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cumulative Probabilty&quot;</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">((String, o) -&gt; EC (Layout Double Double) ())
-&gt; [(String, o)] -&gt; EC (Layout Double Double) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">(String, o) -&gt; EC (Layout Double Double) ()
</span><a href="#local-6989586621679159140"><span class="hs-identifier hs-var">plotOne</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, o)]
</span><a href="#local-6989586621679159131"><span class="hs-identifier hs-var">namedOutcomes</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679159149"><span class="annot"><span class="annottext">cv1 :: Duration o -&gt; Double
</span><a href="#local-6989586621679159149"><span class="hs-identifier hs-var hs-var">cv1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double)
-&gt; (Duration o -&gt; Rational) -&gt; Duration o -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679159156"><span class="annot"><span class="annottext">cv2 :: Probability o -&gt; Double
</span><a href="#local-6989586621679159156"><span class="hs-identifier hs-var hs-var">cv2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double)
-&gt; (Probability o -&gt; Rational) -&gt; Probability o -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621679159140"><span class="annot"><span class="annottext">plotOne :: (String, o) -&gt; EC (Layout Double Double) ()
</span><a href="#local-6989586621679159140"><span class="hs-identifier hs-var hs-var">plotOne</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159157"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159157"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159158"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159158"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EC (Layout Double Double) (PlotLines Double Double)
-&gt; EC (Layout Double Double) ()
forall (p :: * -&gt; * -&gt; *) x y.
ToPlot p =&gt;
EC (Layout x y) (p x y) -&gt; EC (Layout x y) ()
</span><span class="hs-identifier hs-var">G.plot</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double Double) (PlotLines Double Double)
 -&gt; EC (Layout Double Double) ())
-&gt; EC (Layout Double Double) (PlotLines Double Double)
-&gt; EC (Layout Double Double) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; [[(Double, Double)]]
-&gt; EC (Layout Double Double) (PlotLines Double Double)
forall x y l. String -&gt; [[(x, y)]] -&gt; EC l (PlotLines x y)
</span><span class="hs-identifier hs-var">G.line</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159157"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o -&gt; Double
</span><a href="#local-6989586621679159149"><span class="hs-identifier hs-var">cv1</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159161"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Double
</span><a href="#local-6989586621679159156"><span class="hs-identifier hs-var">cv2</span></a></span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159162"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159161"><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159161"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159162"><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159162"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">o -&gt; [(Duration o, Probability o)]
forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o)) =&gt;
o -&gt; [(Duration o, Probability o)]
</span><a href="DeltaQ.Plot.html#toXY"><span class="hs-identifier hs-var">toXY</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159158"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Plot the cumulative distribution function (CDF) of a 'DeltaQ',</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- with title, and annotated with quantiles.</span><span>
</span><span id="line-76"></span><span id="local-6989586621679158983"><span class="annot"><a href="DeltaQ.Plot.html#plotCDFWithQuantiles"><span class="hs-identifier hs-type">plotCDFWithQuantiles</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-78"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Title</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Quantiles to highlight</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679158983"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Outcome to plot</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Layout</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span>
</span><span id="line-87"></span><span id="plotCDFWithQuantiles"><span class="annot"><span class="annottext">plotCDFWithQuantiles :: forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o),
 Real (Duration o), Real (Probability o)) =&gt;
String -&gt; [Probability o] -&gt; o -&gt; Layout Double Double
</span><a href="DeltaQ.Plot.html#plotCDFWithQuantiles"><span class="hs-identifier hs-var hs-var">plotCDFWithQuantiles</span></a></span></span><span> </span><span id="local-6989586621679159207"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159207"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span id="local-6989586621679159208"><span class="annot"><span class="annottext">[Probability o]
</span><a href="#local-6989586621679159208"><span class="hs-identifier hs-var">quantiles</span></a></span></span><span> </span><span id="local-6989586621679159209"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159209"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EC (Layout Double Double) () -&gt; Layout Double Double
forall l a. Default l =&gt; EC l a -&gt; l
</span><span class="hs-identifier hs-var">G.execEC</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double Double) () -&gt; Layout Double Double)
-&gt; EC (Layout Double Double) () -&gt; Layout Double Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; Layout Double Double -&gt; Identity (Layout Double Double)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double Double -&gt; Identity (Layout Double Double))
-&gt; String -&gt; EC (Layout Double Double) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159207"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">[o] -&gt; EC (Layout Double Double) ()
forall o y.
(DeltaQ o, Real (Duration o), Fractional (Duration o),
 PlotValue y) =&gt;
[o] -&gt; EC (Layout Double y) ()
</span><a href="DeltaQ.Plot.html#add_x_axis"><span class="hs-identifier hs-var">add_x_axis</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159209"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">(LayoutAxis Double -&gt; Identity (LayoutAxis Double))
-&gt; Layout Double Double -&gt; Identity (Layout Double Double)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(LayoutAxis y -&gt; f (LayoutAxis y)) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_y_axis</span></span><span> </span><span class="annot"><span class="annottext">((LayoutAxis Double -&gt; Identity (LayoutAxis Double))
 -&gt; Layout Double Double -&gt; Identity (Layout Double Double))
-&gt; ((String -&gt; Identity String)
    -&gt; LayoutAxis Double -&gt; Identity (LayoutAxis Double))
-&gt; (String -&gt; Identity String)
-&gt; Layout Double Double
-&gt; Identity (Layout Double Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; LayoutAxis Double -&gt; Identity (LayoutAxis Double)
forall x (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; LayoutAxis x -&gt; f (LayoutAxis x)
</span><span class="hs-identifier hs-var">G.laxis_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double Double -&gt; Identity (Layout Double Double))
-&gt; String -&gt; EC (Layout Double Double) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cumulative Probabilty&quot;</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">EC (Layout Double Double) (PlotLines Double Double)
-&gt; EC (Layout Double Double) ()
forall (p :: * -&gt; * -&gt; *) x y.
ToPlot p =&gt;
EC (Layout x y) (p x y) -&gt; EC (Layout x y) ()
</span><span class="hs-identifier hs-var">G.plot</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double Double) (PlotLines Double Double)
 -&gt; EC (Layout Double Double) ())
-&gt; EC (Layout Double Double) (PlotLines Double Double)
-&gt; EC (Layout Double Double) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; [[(Double, Double)]]
-&gt; EC (Layout Double Double) (PlotLines Double Double)
forall x y l. String -&gt; [[(x, y)]] -&gt; EC l (PlotLines x y)
</span><span class="hs-identifier hs-var">G.line</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o -&gt; Double
</span><a href="#local-6989586621679159210"><span class="hs-identifier hs-var">cv1</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159211"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Double
</span><a href="#local-6989586621679159212"><span class="hs-identifier hs-var">cv2</span></a></span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159213"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159211"><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159211"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159213"><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159213"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">o -&gt; [(Duration o, Probability o)]
forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o)) =&gt;
o -&gt; [(Duration o, Probability o)]
</span><a href="DeltaQ.Plot.html#toXY"><span class="hs-identifier hs-var">toXY</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159209"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">(Probability o -&gt; EC (Layout Double Double) ())
-&gt; [Probability o] -&gt; EC (Layout Double Double) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; EC (Layout Double Double) ()
</span><a href="#local-6989586621679159214"><span class="hs-identifier hs-var">plotQuantile</span></a></span><span> </span><span class="annot"><span class="annottext">[Probability o]
</span><a href="#local-6989586621679159208"><span class="hs-identifier hs-var">quantiles</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679159210"><span class="annot"><span class="annottext">cv1 :: Duration o -&gt; Double
</span><a href="#local-6989586621679159210"><span class="hs-identifier hs-var hs-var">cv1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double)
-&gt; (Duration o -&gt; Rational) -&gt; Duration o -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679159212"><span class="annot"><span class="annottext">cv2 :: Probability o -&gt; Double
</span><a href="#local-6989586621679159212"><span class="hs-identifier hs-var hs-var">cv2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double)
-&gt; (Probability o -&gt; Rational) -&gt; Probability o -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679159214"><span class="annot"><span class="annottext">plotQuantile :: Probability o -&gt; EC (Layout Double Double) ()
</span><a href="#local-6989586621679159214"><span class="hs-identifier hs-var hs-var">plotQuantile</span></a></span></span><span> </span><span id="local-6989586621679159227"><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159227"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">o -&gt; Probability o -&gt; Eventually (Duration o)
forall o. DeltaQ o =&gt; o -&gt; Probability o -&gt; Eventually (Duration o)
</span><a href="DeltaQ.Class.html#quantile"><span class="hs-identifier hs-var">quantile</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159209"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159227"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><span class="annottext">Eventually (Duration o)
</span><a href="DeltaQ.Class.html#Abandoned"><span class="hs-identifier hs-var">Abandoned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EC (Layout Double Double) ()
forall a. a -&gt; StateT (Layout Double Double) (State CState) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><a href="DeltaQ.Class.html#Occurs"><span class="hs-identifier hs-type">Occurs</span></a></span><span> </span><span id="local-6989586621679159231"><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159231"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EC (Layout Double Double) (PlotLines Double Double)
-&gt; EC (Layout Double Double) ()
forall (p :: * -&gt; * -&gt; *) x y.
ToPlot p =&gt;
EC (Layout x y) (p x y) -&gt; EC (Layout x y) ()
</span><span class="hs-identifier hs-var">G.plot</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double Double) (PlotLines Double Double)
 -&gt; EC (Layout Double Double) ())
-&gt; EC (Layout Double Double) (PlotLines Double Double)
-&gt; EC (Layout Double Double) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlotLines Double Double
-&gt; EC (Layout Double Double) (PlotLines Double Double)
forall a. a -&gt; StateT (Layout Double Double) (State CState) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PlotLines Double Double
 -&gt; EC (Layout Double Double) (PlotLines Double Double))
-&gt; PlotLines Double Double
-&gt; EC (Layout Double Double) (PlotLines Double Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; PlotLines Double Double
forall x y. (PlotValue x, PlotValue y) =&gt; (x, y) -&gt; PlotLines x y
</span><a href="DeltaQ.Plot.html#focusOnPoint"><span class="hs-identifier hs-var">focusOnPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o -&gt; Double
</span><a href="#local-6989586621679159210"><span class="hs-identifier hs-var">cv1</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159231"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Double
</span><a href="#local-6989586621679159212"><span class="hs-identifier hs-var">cv2</span></a></span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159227"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Plot
    Inverse CDF
------------------------------------------------------------------------------}</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Plot the inverse cumulative distribution function (CDF) of a 'DeltaQ',</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- with title.</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- Visualizes the tail of the distribution better.</span><span>
</span><span id="line-108"></span><span id="local-6989586621679158994"><span class="annot"><a href="DeltaQ.Plot.html#plotInverseCDF"><span class="hs-identifier hs-type">plotInverseCDF</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-110"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Title</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679158994"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Outcome</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Layout</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.LogValue</span></span></span><span>
</span><span id="line-118"></span><span id="plotInverseCDF"><span class="annot"><span class="annottext">plotInverseCDF :: forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o),
 Real (Duration o), Real (Probability o)) =&gt;
String -&gt; o -&gt; Layout Double LogValue
</span><a href="DeltaQ.Plot.html#plotInverseCDF"><span class="hs-identifier hs-var hs-var">plotInverseCDF</span></a></span></span><span> </span><span id="local-6989586621679159243"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159243"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span id="local-6989586621679159244"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159244"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; [(String, o)] -&gt; Layout Double LogValue
forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o),
 Real (Duration o), Real (Probability o)) =&gt;
String -&gt; [(String, o)] -&gt; Layout Double LogValue
</span><a href="DeltaQ.Plot.html#plotInverseCDFs"><span class="hs-identifier hs-var">plotInverseCDFs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159243"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159244"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Plot the mulltiple inverse CDFs of a 'DeltaQ',</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- with title.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- Visualizes the tail of the distribution better.</span><span>
</span><span id="line-125"></span><span id="local-6989586621679158997"><span class="annot"><a href="DeltaQ.Plot.html#plotInverseCDFs"><span class="hs-identifier hs-type">plotInverseCDFs</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158997"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-127"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158997"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158997"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158997"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158997"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Title</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679158997"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Outcomes with names</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Layout</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.LogValue</span></span></span><span>
</span><span id="line-135"></span><span id="plotInverseCDFs"><span class="annot"><span class="annottext">plotInverseCDFs :: forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o),
 Real (Duration o), Real (Probability o)) =&gt;
String -&gt; [(String, o)] -&gt; Layout Double LogValue
</span><a href="DeltaQ.Plot.html#plotInverseCDFs"><span class="hs-identifier hs-var hs-var">plotInverseCDFs</span></a></span></span><span> </span><span id="local-6989586621679159283"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159283"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span id="local-6989586621679159284"><span class="annot"><span class="annottext">[(String, o)]
</span><a href="#local-6989586621679159284"><span class="hs-identifier hs-var">namedOutcomes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EC (Layout Double LogValue) () -&gt; Layout Double LogValue
forall l a. Default l =&gt; EC l a -&gt; l
</span><span class="hs-identifier hs-var">G.execEC</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double LogValue) () -&gt; Layout Double LogValue)
-&gt; EC (Layout Double LogValue) () -&gt; Layout Double LogValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue))
-&gt; String -&gt; EC (Layout Double LogValue) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159283"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">[o] -&gt; EC (Layout Double LogValue) ()
forall o y.
(DeltaQ o, Real (Duration o), Fractional (Duration o),
 PlotValue y) =&gt;
[o] -&gt; EC (Layout Double y) ()
</span><a href="DeltaQ.Plot.html#add_x_axis"><span class="hs-identifier hs-var">add_x_axis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String, o) -&gt; o) -&gt; [(String, o)] -&gt; [o]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(String, o) -&gt; o
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(String, o)]
</span><a href="#local-6989586621679159284"><span class="hs-identifier hs-var">namedOutcomes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">(LayoutAxis LogValue -&gt; Identity (LayoutAxis LogValue))
-&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(LayoutAxis y -&gt; f (LayoutAxis y)) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_y_axis</span></span><span> </span><span class="annot"><span class="annottext">((LayoutAxis LogValue -&gt; Identity (LayoutAxis LogValue))
 -&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue))
-&gt; ((String -&gt; Identity String)
    -&gt; LayoutAxis LogValue -&gt; Identity (LayoutAxis LogValue))
-&gt; (String -&gt; Identity String)
-&gt; Layout Double LogValue
-&gt; Identity (Layout Double LogValue)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; LayoutAxis LogValue -&gt; Identity (LayoutAxis LogValue)
forall x (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; LayoutAxis x -&gt; f (LayoutAxis x)
</span><span class="hs-identifier hs-var">G.laxis_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue))
-&gt; String -&gt; EC (Layout Double LogValue) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Log Inverse Cumulative Probabilty&quot;</span></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="annottext">((String, o) -&gt; EC (Layout Double LogValue) ())
-&gt; [(String, o)] -&gt; EC (Layout Double LogValue) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">(String, o) -&gt; EC (Layout Double LogValue) ()
</span><a href="#local-6989586621679159285"><span class="hs-identifier hs-var">plotOne</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, o)]
</span><a href="#local-6989586621679159284"><span class="hs-identifier hs-var">namedOutcomes</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679159292"><span class="annot"><span class="annottext">cv1 :: Duration o -&gt; Double
</span><a href="#local-6989586621679159292"><span class="hs-identifier hs-var hs-var">cv1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double)
-&gt; (Duration o -&gt; Rational) -&gt; Duration o -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679159300"><span class="annot"><span class="annottext">cv2 :: Probability o -&gt; LogValue
</span><a href="#local-6989586621679159300"><span class="hs-identifier hs-var hs-var">cv2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; LogValue
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; LogValue)
-&gt; (Probability o -&gt; Rational) -&gt; Probability o -&gt; LogValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679159285"><span class="annot"><span class="annottext">plotOne :: (String, o) -&gt; EC (Layout Double LogValue) ()
</span><a href="#local-6989586621679159285"><span class="hs-identifier hs-var hs-var">plotOne</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159301"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159301"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159302"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159302"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EC (Layout Double LogValue) (PlotLines Double LogValue)
-&gt; EC (Layout Double LogValue) ()
forall (p :: * -&gt; * -&gt; *) x y.
ToPlot p =&gt;
EC (Layout x y) (p x y) -&gt; EC (Layout x y) ()
</span><span class="hs-identifier hs-var">G.plot</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double LogValue) (PlotLines Double LogValue)
 -&gt; EC (Layout Double LogValue) ())
-&gt; EC (Layout Double LogValue) (PlotLines Double LogValue)
-&gt; EC (Layout Double LogValue) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; [[(Double, LogValue)]]
-&gt; EC (Layout Double LogValue) (PlotLines Double LogValue)
forall x y l. String -&gt; [[(x, y)]] -&gt; EC l (PlotLines x y)
</span><span class="hs-identifier hs-var">G.line</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159301"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o -&gt; Double
</span><a href="#local-6989586621679159292"><span class="hs-identifier hs-var">cv1</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159303"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LogValue
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">LogValue -&gt; LogValue -&gt; LogValue
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; LogValue
</span><a href="#local-6989586621679159300"><span class="hs-identifier hs-var">cv2</span></a></span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159304"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159303"><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159303"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159304"><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159304"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">o -&gt; [(Duration o, Probability o)]
forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o)) =&gt;
o -&gt; [(Duration o, Probability o)]
</span><a href="DeltaQ.Plot.html#toXY"><span class="hs-identifier hs-var">toXY</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159302"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Plot the cumulative distribution function (CDF) of a 'DeltaQ',</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- with title, and annotated with quantiles.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- Visualizes the tail of the distribution better.</span><span>
</span><span id="line-149"></span><span id="local-6989586621679159000"><span class="annot"><a href="DeltaQ.Plot.html#plotInverseCDFWithQuantiles"><span class="hs-identifier hs-type">plotInverseCDFWithQuantiles</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159000"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-151"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159000"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159000"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159000"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159000"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Title</span></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159000"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Quantiles to highlight</span></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159000"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Outcome to plot</span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Layout</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.LogValue</span></span></span><span>
</span><span id="line-160"></span><span id="plotInverseCDFWithQuantiles"><span class="annot"><span class="annottext">plotInverseCDFWithQuantiles :: forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o),
 Real (Duration o), Real (Probability o)) =&gt;
String -&gt; [Probability o] -&gt; o -&gt; Layout Double LogValue
</span><a href="DeltaQ.Plot.html#plotInverseCDFWithQuantiles"><span class="hs-identifier hs-var hs-var">plotInverseCDFWithQuantiles</span></a></span></span><span> </span><span id="local-6989586621679159350"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159350"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span id="local-6989586621679159351"><span class="annot"><span class="annottext">[Probability o]
</span><a href="#local-6989586621679159351"><span class="hs-identifier hs-var">quantiles</span></a></span></span><span> </span><span id="local-6989586621679159352"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159352"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EC (Layout Double LogValue) () -&gt; Layout Double LogValue
forall l a. Default l =&gt; EC l a -&gt; l
</span><span class="hs-identifier hs-var">G.execEC</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double LogValue) () -&gt; Layout Double LogValue)
-&gt; EC (Layout Double LogValue) () -&gt; Layout Double LogValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue))
-&gt; String -&gt; EC (Layout Double LogValue) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159350"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">[o] -&gt; EC (Layout Double LogValue) ()
forall o y.
(DeltaQ o, Real (Duration o), Fractional (Duration o),
 PlotValue y) =&gt;
[o] -&gt; EC (Layout Double y) ()
</span><a href="DeltaQ.Plot.html#add_x_axis"><span class="hs-identifier hs-var">add_x_axis</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159352"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="annottext">(LayoutAxis LogValue -&gt; Identity (LayoutAxis LogValue))
-&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(LayoutAxis y -&gt; f (LayoutAxis y)) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_y_axis</span></span><span> </span><span class="annot"><span class="annottext">((LayoutAxis LogValue -&gt; Identity (LayoutAxis LogValue))
 -&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue))
-&gt; ((String -&gt; Identity String)
    -&gt; LayoutAxis LogValue -&gt; Identity (LayoutAxis LogValue))
-&gt; (String -&gt; Identity String)
-&gt; Layout Double LogValue
-&gt; Identity (Layout Double LogValue)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; LayoutAxis LogValue -&gt; Identity (LayoutAxis LogValue)
forall x (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; LayoutAxis x -&gt; f (LayoutAxis x)
</span><span class="hs-identifier hs-var">G.laxis_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double LogValue -&gt; Identity (Layout Double LogValue))
-&gt; String -&gt; EC (Layout Double LogValue) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Log Inverse Cumulative Probabilty&quot;</span></span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><span class="annottext">EC (Layout Double LogValue) (PlotLines Double LogValue)
-&gt; EC (Layout Double LogValue) ()
forall (p :: * -&gt; * -&gt; *) x y.
ToPlot p =&gt;
EC (Layout x y) (p x y) -&gt; EC (Layout x y) ()
</span><span class="hs-identifier hs-var">G.plot</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double LogValue) (PlotLines Double LogValue)
 -&gt; EC (Layout Double LogValue) ())
-&gt; EC (Layout Double LogValue) (PlotLines Double LogValue)
-&gt; EC (Layout Double LogValue) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; [[(Double, LogValue)]]
-&gt; EC (Layout Double LogValue) (PlotLines Double LogValue)
forall x y l. String -&gt; [[(x, y)]] -&gt; EC l (PlotLines x y)
</span><span class="hs-identifier hs-var">G.line</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o -&gt; Double
</span><a href="#local-6989586621679159353"><span class="hs-identifier hs-var">cv1</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159354"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LogValue
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">LogValue -&gt; LogValue -&gt; LogValue
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; LogValue
</span><a href="#local-6989586621679159355"><span class="hs-identifier hs-var">cv2</span></a></span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159356"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159354"><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159354"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159356"><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159356"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">o -&gt; [(Duration o, Probability o)]
forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o)) =&gt;
o -&gt; [(Duration o, Probability o)]
</span><a href="DeltaQ.Plot.html#toXY"><span class="hs-identifier hs-var">toXY</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159352"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">(Probability o -&gt; EC (Layout Double LogValue) ())
-&gt; [Probability o] -&gt; EC (Layout Double LogValue) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; EC (Layout Double LogValue) ()
</span><a href="#local-6989586621679159357"><span class="hs-identifier hs-var">plotQuantile</span></a></span><span> </span><span class="annot"><span class="annottext">[Probability o]
</span><a href="#local-6989586621679159351"><span class="hs-identifier hs-var">quantiles</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679159353"><span class="annot"><span class="annottext">cv1 :: Duration o -&gt; Double
</span><a href="#local-6989586621679159353"><span class="hs-identifier hs-var hs-var">cv1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double)
-&gt; (Duration o -&gt; Rational) -&gt; Duration o -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679159355"><span class="annot"><span class="annottext">cv2 :: Probability o -&gt; LogValue
</span><a href="#local-6989586621679159355"><span class="hs-identifier hs-var hs-var">cv2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; LogValue
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; LogValue)
-&gt; (Probability o -&gt; Rational) -&gt; Probability o -&gt; LogValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679159357"><span class="annot"><span class="annottext">plotQuantile :: Probability o -&gt; EC (Layout Double LogValue) ()
</span><a href="#local-6989586621679159357"><span class="hs-identifier hs-var hs-var">plotQuantile</span></a></span></span><span> </span><span id="local-6989586621679159370"><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159370"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">o -&gt; Probability o -&gt; Eventually (Duration o)
forall o. DeltaQ o =&gt; o -&gt; Probability o -&gt; Eventually (Duration o)
</span><a href="DeltaQ.Class.html#quantile"><span class="hs-identifier hs-var">quantile</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159352"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159370"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">Eventually (Duration o)
</span><a href="DeltaQ.Class.html#Abandoned"><span class="hs-identifier hs-var">Abandoned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; EC (Layout Double LogValue) ()
forall a. a -&gt; StateT (Layout Double LogValue) (State CState) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><a href="DeltaQ.Class.html#Occurs"><span class="hs-identifier hs-type">Occurs</span></a></span><span> </span><span id="local-6989586621679159371"><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159371"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EC (Layout Double LogValue) (PlotLines Double LogValue)
-&gt; EC (Layout Double LogValue) ()
forall (p :: * -&gt; * -&gt; *) x y.
ToPlot p =&gt;
EC (Layout x y) (p x y) -&gt; EC (Layout x y) ()
</span><span class="hs-identifier hs-var">G.plot</span></span><span> </span><span class="annot"><span class="annottext">(EC (Layout Double LogValue) (PlotLines Double LogValue)
 -&gt; EC (Layout Double LogValue) ())
-&gt; EC (Layout Double LogValue) (PlotLines Double LogValue)
-&gt; EC (Layout Double LogValue) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlotLines Double LogValue
-&gt; EC (Layout Double LogValue) (PlotLines Double LogValue)
forall a. a -&gt; StateT (Layout Double LogValue) (State CState) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PlotLines Double LogValue
 -&gt; EC (Layout Double LogValue) (PlotLines Double LogValue))
-&gt; PlotLines Double LogValue
-&gt; EC (Layout Double LogValue) (PlotLines Double LogValue)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, LogValue) -&gt; PlotLines Double LogValue
forall x y. (PlotValue x, PlotValue y) =&gt; (x, y) -&gt; PlotLines x y
</span><a href="DeltaQ.Plot.html#focusOnPoint"><span class="hs-identifier hs-var">focusOnPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o -&gt; Double
</span><a href="#local-6989586621679159353"><span class="hs-identifier hs-var">cv1</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159371"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; LogValue
</span><a href="#local-6989586621679159355"><span class="hs-identifier hs-var">cv2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Probability o
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Probability o -&gt; Probability o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159370"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Helper functions
    Plot
------------------------------------------------------------------------------}</span><span>
</span><span id="line-177"></span><span class="annot"><span class="hs-comment">-- | Add a common @x@-axis to the plot.</span></span><span>
</span><span id="line-178"></span><span id="local-6989586621679158957"><span id="local-6989586621679158958"><span class="annot"><a href="DeltaQ.Plot.html#add_x_axis"><span class="hs-identifier hs-type">add_x_axis</span></a></span><span> </span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158957"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158957"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158957"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.PlotValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158958"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679158957"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.EC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.Layout</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621679158958"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-182"></span><span id="add_x_axis"><span class="annot"><span class="annottext">add_x_axis :: forall o y.
(DeltaQ o, Real (Duration o), Fractional (Duration o),
 PlotValue y) =&gt;
[o] -&gt; EC (Layout Double y) ()
</span><a href="DeltaQ.Plot.html#add_x_axis"><span class="hs-identifier hs-var hs-var">add_x_axis</span></a></span></span><span> </span><span id="local-6989586621679159405"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679159405"><span class="hs-identifier hs-var">outcomes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">(LayoutAxis Double -&gt; Identity (LayoutAxis Double))
-&gt; Layout Double y -&gt; Identity (Layout Double y)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(LayoutAxis x -&gt; f (LayoutAxis x)) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_x_axis</span></span><span> </span><span class="annot"><span class="annottext">((LayoutAxis Double -&gt; Identity (LayoutAxis Double))
 -&gt; Layout Double y -&gt; Identity (Layout Double y))
-&gt; ((String -&gt; Identity String)
    -&gt; LayoutAxis Double -&gt; Identity (LayoutAxis Double))
-&gt; (String -&gt; Identity String)
-&gt; Layout Double y
-&gt; Identity (Layout Double y)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Identity String)
-&gt; LayoutAxis Double -&gt; Identity (LayoutAxis Double)
forall x (f :: * -&gt; *).
Functor f =&gt;
(String -&gt; f String) -&gt; LayoutAxis x -&gt; f (LayoutAxis x)
</span><span class="hs-identifier hs-var">G.laxis_title</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Identity String)
 -&gt; Layout Double y -&gt; Identity (Layout Double y))
-&gt; String -&gt; StateT (Layout Double y) (State CState) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Time (s)&quot;</span></span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">(LayoutAxis Double -&gt; Identity (LayoutAxis Double))
-&gt; Layout Double y -&gt; Identity (Layout Double y)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(LayoutAxis x -&gt; f (LayoutAxis x)) -&gt; Layout x y -&gt; f (Layout x y)
</span><span class="hs-identifier hs-var">G.layout_x_axis</span></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">((LayoutAxis Double -&gt; Identity (LayoutAxis Double))
 -&gt; Layout Double y -&gt; Identity (Layout Double y))
-&gt; ((AxisFn Double -&gt; Identity (AxisFn Double))
    -&gt; LayoutAxis Double -&gt; Identity (LayoutAxis Double))
-&gt; (AxisFn Double -&gt; Identity (AxisFn Double))
-&gt; Layout Double y
-&gt; Identity (Layout Double y)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AxisFn Double -&gt; Identity (AxisFn Double))
-&gt; LayoutAxis Double -&gt; Identity (LayoutAxis Double)
forall x (f :: * -&gt; *).
Functor f =&gt;
(AxisFn x -&gt; f (AxisFn x)) -&gt; LayoutAxis x -&gt; f (LayoutAxis x)
</span><span class="hs-identifier hs-var">G.laxis_generate</span></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="annottext">((AxisFn Double -&gt; Identity (AxisFn Double))
 -&gt; Layout Double y -&gt; Identity (Layout Double y))
-&gt; AxisFn Double -&gt; StateT (Layout Double y) (State CState) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">AxisFn Double
-&gt; (Double -&gt; AxisFn Double) -&gt; Maybe Double -&gt; AxisFn Double
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">AxisFn Double
forall a. PlotValue a =&gt; AxisFn a
</span><span class="hs-identifier hs-var">G.autoAxis</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679159410"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679159410"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LinearAxisParams Double -&gt; (Double, Double) -&gt; AxisFn Double
forall a. RealFloat a =&gt; LinearAxisParams a -&gt; (a, a) -&gt; AxisFn a
</span><span class="hs-identifier hs-var">G.scaledAxis</span></span><span> </span><span class="annot"><span class="annottext">LinearAxisParams Double
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">G.def</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.05</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679159410"><span class="hs-identifier hs-var">u'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Double
</span><a href="#local-6989586621679159414"><span class="hs-identifier hs-var">maxX</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679159421"><span class="annot"><span class="annottext">fromDuration :: Duration o -&gt; Double
</span><a href="#local-6989586621679159421"><span class="hs-identifier hs-var hs-var">fromDuration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double)
-&gt; (Duration o -&gt; Rational) -&gt; Duration o -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679159414"><span class="annot"><span class="annottext">maxX :: Maybe Double
</span><a href="#local-6989586621679159414"><span class="hs-identifier hs-var hs-var">maxX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679159405"><span class="hs-identifier hs-var">outcomes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Double
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">[o]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-192"></span><span>            </span><span class="annot"><span class="annottext">(Duration o -&gt; Double) -&gt; Maybe (Duration o) -&gt; Maybe Double
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Double
</span><a href="#local-6989586621679159421"><span class="hs-identifier hs-var">fromDuration</span></a></span><span>
</span><span id="line-193"></span><span>            </span><span class="annot"><span class="annottext">(Maybe (Duration o) -&gt; Maybe Double)
-&gt; Maybe (Duration o) -&gt; Maybe Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Duration o)] -&gt; Maybe (Duration o)
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><span class="annottext">([Maybe (Duration o)] -&gt; Maybe (Duration o))
-&gt; [Maybe (Duration o)] -&gt; Maybe (Duration o)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(o -&gt; Maybe (Duration o)) -&gt; [o] -&gt; [Maybe (Duration o)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eventually (Duration o) -&gt; Maybe (Duration o)
forall a. Eventually a -&gt; Maybe a
</span><a href="DeltaQ.Class.html#maybeFromEventually"><span class="hs-identifier hs-var">maybeFromEventually</span></a></span><span> </span><span class="annot"><span class="annottext">(Eventually (Duration o) -&gt; Maybe (Duration o))
-&gt; (o -&gt; Eventually (Duration o)) -&gt; o -&gt; Maybe (Duration o)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">o -&gt; Eventually (Duration o)
forall o. DeltaQ o =&gt; o -&gt; Eventually (Duration o)
</span><a href="DeltaQ.Class.html#deadline"><span class="hs-identifier hs-var">deadline</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679159405"><span class="hs-identifier hs-var">outcomes</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><span class="hs-comment">-- | Focus on a point by plotting dashed lines that connect it to the axes.</span></span><span>
</span><span id="line-197"></span><span id="local-6989586621679158992"><span id="local-6989586621679158993"><span class="annot"><a href="DeltaQ.Plot.html#focusOnPoint"><span class="hs-identifier hs-type">focusOnPoint</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.PlotValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158992"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.PlotValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679158993"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679158992"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679158993"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.PlotLines</span></span><span> </span><span class="annot"><a href="#local-6989586621679158992"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158993"><span class="hs-identifier hs-type">y</span></a></span></span></span><span>
</span><span id="line-200"></span><span id="focusOnPoint"><span class="annot"><span class="annottext">focusOnPoint :: forall x y. (PlotValue x, PlotValue y) =&gt; (x, y) -&gt; PlotLines x y
</span><a href="DeltaQ.Plot.html#focusOnPoint"><span class="hs-identifier hs-var hs-var">focusOnPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159442"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679159442"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679159443"><span class="annot"><span class="annottext">y
</span><a href="#local-6989586621679159443"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EC (PlotLines x y) () -&gt; PlotLines x y
forall l a. Default l =&gt; EC l a -&gt; l
</span><span class="hs-identifier hs-var">G.execEC</span></span><span> </span><span class="annot"><span class="annottext">(EC (PlotLines x y) () -&gt; PlotLines x y)
-&gt; EC (PlotLines x y) () -&gt; PlotLines x y
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">(LineStyle -&gt; Identity LineStyle)
-&gt; PlotLines x y -&gt; Identity (PlotLines x y)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(LineStyle -&gt; f LineStyle) -&gt; PlotLines x y -&gt; f (PlotLines x y)
</span><span class="hs-identifier hs-var">G.plot_lines_style</span></span><span> </span><span class="annot"><span class="annottext">((LineStyle -&gt; Identity LineStyle)
 -&gt; PlotLines x y -&gt; Identity (PlotLines x y))
-&gt; ((AlphaColour Double -&gt; Identity (AlphaColour Double))
    -&gt; LineStyle -&gt; Identity LineStyle)
-&gt; (AlphaColour Double -&gt; Identity (AlphaColour Double))
-&gt; PlotLines x y
-&gt; Identity (PlotLines x y)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AlphaColour Double -&gt; Identity (AlphaColour Double))
-&gt; LineStyle -&gt; Identity LineStyle
Lens' LineStyle (AlphaColour Double)
</span><span class="hs-identifier hs-var">G.line_color</span></span><span> </span><span class="annot"><span class="annottext">((AlphaColour Double -&gt; Identity (AlphaColour Double))
 -&gt; PlotLines x y -&gt; Identity (PlotLines x y))
-&gt; AlphaColour Double -&gt; EC (PlotLines x y) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Colour Double -&gt; AlphaColour Double
forall a. Num a =&gt; Colour a -&gt; AlphaColour a
</span><span class="hs-identifier hs-var">G.opaque</span></span><span> </span><span class="annot"><span class="annottext">Colour Double
forall a. Num a =&gt; Colour a
</span><span class="hs-identifier hs-var">G.black</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">(LineStyle -&gt; Identity LineStyle)
-&gt; PlotLines x y -&gt; Identity (PlotLines x y)
forall x y (f :: * -&gt; *).
Functor f =&gt;
(LineStyle -&gt; f LineStyle) -&gt; PlotLines x y -&gt; f (PlotLines x y)
</span><span class="hs-identifier hs-var">G.plot_lines_style</span></span><span> </span><span class="annot"><span class="annottext">((LineStyle -&gt; Identity LineStyle)
 -&gt; PlotLines x y -&gt; Identity (PlotLines x y))
-&gt; (([Double] -&gt; Identity [Double])
    -&gt; LineStyle -&gt; Identity LineStyle)
-&gt; ([Double] -&gt; Identity [Double])
-&gt; PlotLines x y
-&gt; Identity (PlotLines x y)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Identity [Double]) -&gt; LineStyle -&gt; Identity LineStyle
Lens' LineStyle [Double]
</span><span class="hs-identifier hs-var">G.line_dashes</span></span><span> </span><span class="annot"><span class="annottext">(([Double] -&gt; Identity [Double])
 -&gt; PlotLines x y -&gt; Identity (PlotLines x y))
-&gt; [Double] -&gt; EC (PlotLines x y) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">([[(Limit x, Limit y)]] -&gt; Identity [[(Limit x, Limit y)]])
-&gt; PlotLines x y -&gt; Identity (PlotLines x y)
forall x y (f :: * -&gt; *).
Functor f =&gt;
([[(Limit x, Limit y)]] -&gt; f [[(Limit x, Limit y)]])
-&gt; PlotLines x y -&gt; f (PlotLines x y)
</span><span class="hs-identifier hs-var">G.plot_lines_limit_values</span></span><span> </span><span class="annot"><span class="annottext">(([[(Limit x, Limit y)]] -&gt; Identity [[(Limit x, Limit y)]])
 -&gt; PlotLines x y -&gt; Identity (PlotLines x y))
-&gt; [[(Limit x, Limit y)]] -&gt; EC (PlotLines x y) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><span class="hs-operator hs-var">.=</span></span><span>
</span><span id="line-204"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Limit x
forall a. Limit a
</span><span class="hs-identifier hs-var">G.LMin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">y -&gt; Limit y
forall a. a -&gt; Limit a
</span><span class="hs-identifier hs-var">G.LValue</span></span><span> </span><span class="annot"><span class="annottext">y
</span><a href="#local-6989586621679159443"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Limit x
forall a. a -&gt; Limit a
</span><span class="hs-identifier hs-var">G.LValue</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679159442"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">y -&gt; Limit y
forall a. a -&gt; Limit a
</span><span class="hs-identifier hs-var">G.LValue</span></span><span> </span><span class="annot"><span class="annottext">y
</span><a href="#local-6989586621679159443"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Limit x
forall a. a -&gt; Limit a
</span><span class="hs-identifier hs-var">G.LValue</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679159442"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">y -&gt; Limit y
forall a. a -&gt; Limit a
</span><span class="hs-identifier hs-var">G.LValue</span></span><span> </span><span class="annot"><span class="annottext">y
</span><a href="#local-6989586621679159443"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Limit x
forall a. a -&gt; Limit a
</span><span class="hs-identifier hs-var">G.LValue</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679159442"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Limit y
forall a. Limit a
</span><span class="hs-identifier hs-var">G.LMin</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Helper functions
    Calculations
------------------------------------------------------------------------------}</span><span>
</span><span id="line-212"></span><span class="annot"><span class="hs-comment">-- | Create a graph for an 'Outcome', with sensible defaults for plotting.</span></span><span>
</span><span id="line-213"></span><span id="local-6989586621679158982"><span class="annot"><a href="DeltaQ.Plot.html#toXY"><span class="hs-identifier hs-type">toXY</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158982"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-217"></span><span id="toXY"><span class="annot"><span class="annottext">toXY :: forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o)) =&gt;
o -&gt; [(Duration o, Probability o)]
</span><a href="DeltaQ.Plot.html#toXY"><span class="hs-identifier hs-var hs-var">toXY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; o -&gt; [(Duration o, Probability o)]
forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o)) =&gt;
Int -&gt; Double -&gt; o -&gt; [(Duration o, Probability o)]
</span><a href="DeltaQ.Plot.html#toXY%27"><span class="hs-identifier hs-var">toXY'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2048</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.05</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><span class="hs-comment">-- | Create a graph for an 'Outcome', given some parameters.</span></span><span>
</span><span id="line-220"></span><span id="local-6989586621679159044"><span class="annot"><a href="DeltaQ.Plot.html#toXY%27"><span class="hs-identifier hs-type">toXY'</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#DeltaQ"><span class="hs-identifier hs-type">DeltaQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Number of points to plot.</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ \&quot;Overshoot\&quot; (as a fraction of the range)</span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Outcome to convert</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="DeltaQ.Class.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DeltaQ.Class.html#Probability"><span class="hs-identifier hs-type">Probability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159044"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-226"></span><span id="toXY%27"><span class="annot"><span class="annottext">toXY' :: forall o.
(DeltaQ o, Enum (Duration o), Fractional (Duration o)) =&gt;
Int -&gt; Double -&gt; o -&gt; [(Duration o, Probability o)]
</span><a href="DeltaQ.Plot.html#toXY%27"><span class="hs-identifier hs-var hs-var">toXY'</span></a></span></span><span> </span><span id="local-6989586621679159505"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159505"><span class="hs-identifier hs-var">numPoints</span></a></span></span><span> </span><span id="local-6989586621679159506"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679159506"><span class="hs-identifier hs-var">overshoot</span></a></span></span><span> </span><span id="local-6989586621679159507"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159507"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">[(Duration o, Probability o)] -&gt; [(Duration o, Probability o)]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="DeltaQ.Plot.html#deduplicate"><span class="hs-identifier hs-var">deduplicate</span></a></span><span> </span><span class="annot"><span class="annottext">([(Duration o, Probability o)] -&gt; [(Duration o, Probability o)])
-&gt; [(Duration o, Probability o)] -&gt; [(Duration o, Probability o)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Duration o, Probability o)]
</span><a href="#local-6989586621679159509"><span class="hs-identifier hs-var">leftEdge</span></a></span><span> </span><span class="annot"><span class="annottext">[(Duration o, Probability o)]
-&gt; [(Duration o, Probability o)] -&gt; [(Duration o, Probability o)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Duration o, Probability o)]
</span><a href="#local-6989586621679159510"><span class="hs-identifier hs-var">middle</span></a></span><span> </span><span class="annot"><span class="annottext">[(Duration o, Probability o)]
-&gt; [(Duration o, Probability o)] -&gt; [(Duration o, Probability o)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Duration o, Probability o)]
</span><a href="#local-6989586621679159511"><span class="hs-identifier hs-var">rightEdge</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679159512"><span class="annot"><span class="annottext">range :: Duration o
</span><a href="#local-6989586621679159512"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159513"><span class="hs-identifier hs-var">upperX</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159514"><span class="hs-identifier hs-var">lowerX</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679159515"><span class="annot"><span class="annottext">eps :: Duration o
</span><a href="#local-6989586621679159515"><span class="hs-identifier hs-var hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159512"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Duration o
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159505"><span class="hs-identifier hs-var">numPoints</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679159514"><span class="annot"><span class="annottext">lowerX :: Duration o
</span><a href="#local-6989586621679159514"><span class="hs-identifier hs-var hs-var">lowerX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Duration o
-&gt; (Duration o -&gt; Duration o)
-&gt; Eventually (Duration o)
-&gt; Duration o
forall b a. b -&gt; (a -&gt; b) -&gt; Eventually a -&gt; b
</span><a href="DeltaQ.Class.html#eventually"><span class="hs-identifier hs-var">eventually</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Eventually (Duration o) -&gt; Duration o)
-&gt; Eventually (Duration o) -&gt; Duration o
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">o -&gt; Eventually (Duration o)
forall o. DeltaQ o =&gt; o -&gt; Eventually (Duration o)
</span><a href="DeltaQ.Class.html#earliest"><span class="hs-identifier hs-var">earliest</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159507"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679159513"><span class="annot"><span class="annottext">upperX :: Duration o
</span><a href="#local-6989586621679159513"><span class="hs-identifier hs-var hs-var">upperX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Duration o
-&gt; (Duration o -&gt; Duration o)
-&gt; Eventually (Duration o)
-&gt; Duration o
forall b a. b -&gt; (a -&gt; b) -&gt; Eventually a -&gt; b
</span><a href="DeltaQ.Class.html#eventually"><span class="hs-identifier hs-var">eventually</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159519"><span class="hs-identifier hs-var">halfLifeCarbon14</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Eventually (Duration o) -&gt; Duration o)
-&gt; Eventually (Duration o) -&gt; Duration o
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">o -&gt; Eventually (Duration o)
forall o. DeltaQ o =&gt; o -&gt; Eventually (Duration o)
</span><a href="DeltaQ.Class.html#deadline"><span class="hs-identifier hs-var">deadline</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159507"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621679159519"><span class="annot"><span class="annottext">halfLifeCarbon14 :: Duration o
</span><a href="#local-6989586621679159519"><span class="hs-identifier hs-var hs-var">halfLifeCarbon14</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">5730</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">365</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">24</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">60</span></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679159529"><span class="annot"><span class="annottext">success :: Probability o
</span><a href="#local-6989586621679159529"><span class="hs-identifier hs-var hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Probability o
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Probability o -&gt; Probability o -&gt; Probability o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">o -&gt; Probability o
forall o. DeltaQ o =&gt; o -&gt; Probability o
</span><a href="DeltaQ.Class.html#failure"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159507"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679159531"><span class="annot"><span class="annottext">sw :: Duration o -&gt; Probability o
</span><a href="#local-6989586621679159531"><span class="hs-identifier hs-var hs-var">sw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">o -&gt; Duration o -&gt; Probability o
forall o. DeltaQ o =&gt; o -&gt; Duration o -&gt; Probability o
</span><a href="DeltaQ.Class.html#successWithin"><span class="hs-identifier hs-var">successWithin</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679159507"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621679159509"><span class="annot"><span class="annottext">leftEdge :: [(Duration o, Probability o)]
</span><a href="#local-6989586621679159509"><span class="hs-identifier hs-var hs-var">leftEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Probability o
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159514"><span class="hs-identifier hs-var">lowerX</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159515"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Probability o
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159514"><span class="hs-identifier hs-var">lowerX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Probability o
</span><a href="#local-6989586621679159531"><span class="hs-identifier hs-var">sw</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159514"><span class="hs-identifier hs-var">lowerX</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679159511"><span class="annot"><span class="annottext">rightEdge :: [(Duration o, Probability o)]
</span><a href="#local-6989586621679159511"><span class="hs-identifier hs-var hs-var">rightEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159513"><span class="hs-identifier hs-var">upperX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159529"><span class="hs-identifier hs-var">success</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159513"><span class="hs-identifier hs-var">upperX</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Duration o
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Duration o)
-&gt; (Double -&gt; Rational) -&gt; Double -&gt; Duration o
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Duration o) -&gt; Double -&gt; Duration o
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679159506"><span class="hs-identifier hs-var">overshoot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159512"><span class="hs-identifier hs-var">range</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Probability o
</span><a href="#local-6989586621679159529"><span class="hs-identifier hs-var">success</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679159510"><span class="annot"><span class="annottext">middle :: [(Duration o, Probability o)]
</span><a href="#local-6989586621679159510"><span class="hs-identifier hs-var hs-var">middle</span></a></span></span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159515"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159535"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Probability o
</span><a href="#local-6989586621679159531"><span class="hs-identifier hs-var">sw</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159535"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679159535"><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159535"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159514"><span class="hs-identifier hs-var">lowerX</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159515"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159514"><span class="hs-identifier hs-var">lowerX</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159515"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159513"><span class="hs-identifier hs-var">upperX</span></a></span><span> </span><span class="annot"><span class="annottext">Duration o -&gt; Duration o -&gt; Duration o
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Duration o
</span><a href="#local-6989586621679159515"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><span class="hs-comment">-- | Remove neighboring occurrences of the same element from the list.</span></span><span>
</span><span id="line-250"></span><span id="local-6989586621679159051"><span class="annot"><a href="DeltaQ.Plot.html#deduplicate"><span class="hs-identifier hs-type">deduplicate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679159051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679159051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679159051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-251"></span><span id="deduplicate"><span class="annot"><span class="annottext">deduplicate :: forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="DeltaQ.Plot.html#deduplicate"><span class="hs-identifier hs-var hs-var">deduplicate</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-252"></span><span class="annot"><a href="DeltaQ.Plot.html#deduplicate"><span class="hs-identifier hs-var">deduplicate</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159538"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159538"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679159539"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679159539"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159538"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall {a}. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679159540"><span class="hs-identifier hs-var">dedup'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159538"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679159539"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679159540"><span class="annot"><span class="annottext">dedup' :: a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679159540"><span class="hs-identifier hs-var hs-var">dedup'</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="#local-6989586621679159540"><span class="hs-identifier hs-var">dedup'</span></a></span><span> </span><span id="local-6989586621679159543"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159543"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159544"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159544"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679159545"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679159545"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159543"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159544"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679159540"><span class="hs-identifier hs-var">dedup'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159543"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679159545"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-257"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159544"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679159540"><span class="hs-identifier hs-var">dedup'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679159544"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679159545"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-258"></span></pre></body></html>