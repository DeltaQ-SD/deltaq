<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="annot"><span class="hs-comment">{-|
Copyright   : Predictable Network Solutions Ltd., 2020-2024
License     : BSD-3-Clause
Description : Polynomials and computations with them.
-}</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html"><span class="hs-identifier">Numeric.Polynomial.Simple</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Basic operations</span></span><span>
</span><span id="line-13"></span><span>      </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier">Poly</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier">eval</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier">degree</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier">constant</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier">zero</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier">monomial</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier">fromCoefficients</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier">toCoefficients</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier">scale</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#scaleX"><span class="hs-identifier">scaleX</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Advanced operations</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Convenience</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#display"><span class="hs-identifier">display</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#lineFromTo"><span class="hs-identifier">lineFromTo</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Algebraic</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#translate"><span class="hs-identifier">translate</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#integrate"><span class="hs-identifier">integrate</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier">differentiate</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier">euclidianDivision</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier">convolve</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Numerical</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#compareToZero"><span class="hs-identifier">compareToZero</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier">countRoots</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#isMonotonicallyIncreasingOn"><span class="hs-identifier">isMonotonicallyIncreasingOn</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#root"><span class="hs-identifier">root</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#squareFreeFactorisation"><span class="hs-identifier">squareFreeFactorisation</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">NFData</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NFData1</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Generic</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Generic1</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Math.Combinatorics.Exact.Binomial</span></span><span> </span><span class="hs-comment">-- needed to automatically derive NFData</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">choose</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.Function.Class.html"><span class="hs-identifier">Data.Function.Class</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fun</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Basic operations
------------------------------------------------------------------------------}</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">-- | Polynomial with coefficients in @a@.</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">newtype</span><span> </span><span id="Poly"><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span></span><span> </span><span id="local-6989586621679064396"><span class="annot"><a href="#local-6989586621679064396"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Poly"><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064396"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">-- INVARIANT: List of coefficients from lowest to highest degree.</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- INVARIANT: The empty list is not allowed,</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- the zero polynomial is represented as [0].</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064546"><span id="local-6989586621679064552"><span id="local-6989586621679064556"><span class="annot"><span class="annottext">Int -&gt; Poly a -&gt; ShowS
[Poly a] -&gt; ShowS
Poly a -&gt; String
(Int -&gt; Poly a -&gt; ShowS)
-&gt; (Poly a -&gt; String) -&gt; ([Poly a] -&gt; ShowS) -&gt; Show (Poly a)
forall a. Show a =&gt; Int -&gt; Poly a -&gt; ShowS
forall a. Show a =&gt; [Poly a] -&gt; ShowS
forall a. Show a =&gt; Poly a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Poly a -&gt; ShowS
showsPrec :: Int -&gt; Poly a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Poly a -&gt; String
show :: Poly a -&gt; String
$cshowList :: forall a. Show a =&gt; [Poly a] -&gt; ShowS
showList :: [Poly a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064561"><span id="local-6989586621679064563"><span class="annot"><span class="annottext">(forall x. Poly a -&gt; Rep (Poly a) x)
-&gt; (forall x. Rep (Poly a) x -&gt; Poly a) -&gt; Generic (Poly a)
forall x. Rep (Poly a) x -&gt; Poly a
forall x. Poly a -&gt; Rep (Poly a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (Poly a) x -&gt; Poly a
forall a x. Poly a -&gt; Rep (Poly a) x
$cfrom :: forall a x. Poly a -&gt; Rep (Poly a) x
from :: forall x. Poly a -&gt; Rep (Poly a) x
$cto :: forall a x. Rep (Poly a) x -&gt; Poly a
to :: forall x. Rep (Poly a) x -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064569"><span id="local-6989586621679064571"><span class="annot"><span class="annottext">(forall a. Poly a -&gt; Rep1 Poly a)
-&gt; (forall a. Rep1 Poly a -&gt; Poly a) -&gt; Generic1 Poly
forall a. Rep1 Poly a -&gt; Poly a
forall a. Poly a -&gt; Rep1 Poly a
forall k (f :: k -&gt; *).
(forall (a :: k). f a -&gt; Rep1 f a)
-&gt; (forall (a :: k). Rep1 f a -&gt; f a) -&gt; Generic1 f
$cfrom1 :: forall a. Poly a -&gt; Rep1 Poly a
from1 :: forall a. Poly a -&gt; Rep1 Poly a
$cto1 :: forall a. Rep1 Poly a -&gt; Poly a
to1 :: forall a. Rep1 Poly a -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic1</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064381"><span id="local-6989586621679064578"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679064381"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064381"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064595"><span class="annot"><span class="hs-identifier hs-type">NFData1</span></span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064390"><span id="local-6989586621679064612"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064390"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064390"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064390"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621679064622"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064622"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064623"><span class="annot"><span class="annottext">== :: Poly a -&gt; Poly a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679064624"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064624"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><span class="annottext">Poly a -&gt; [a]
forall a. Poly a -&gt; [a]
</span><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-var">toCoefficients</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064622"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [a]
forall a. Poly a -&gt; [a]
</span><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-var">toCoefficients</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064624"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">{-| The constant polynomial.

&gt; eval (constant a) = const a
-}</span></span><span>
</span><span id="line-81"></span><span id="local-6989586621679064394"><span class="annot"><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-type">constant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679064394"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064394"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-82"></span><span id="constant"><span class="annot"><span class="annottext">constant :: forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var hs-var">constant</span></a></span></span><span> </span><span id="local-6989586621679064626"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064626"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064626"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><span class="hs-comment">-- | The zero polynomial.</span></span><span>
</span><span id="line-85"></span><span id="local-6989586621679064397"><span class="annot"><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-type">zero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064397"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064397"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-86"></span><span id="zero"><span class="annot"><span class="annottext">zero :: forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var hs-var">zero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><span class="hs-comment">{-| Degree of a polynomial.

The degree of a constant polynomial is @0@, but
the degree of the zero polynomial is @-1@ for Euclidean division.
-}</span></span><span>
</span><span id="line-93"></span><span id="local-6989586621679064400"><span class="annot"><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-type">degree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064400"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064400"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064400"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-94"></span><span id="degree"><span class="annot"><span class="annottext">degree :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var hs-var">degree</span></a></span></span><span> </span><span id="local-6989586621679064642"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064642"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064642"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064643"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064643"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064643"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><span class="hs-comment">-- | remove top zeroes</span></span><span>
</span><span id="line-99"></span><span id="local-6989586621679064393"><span class="annot"><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-type">trimPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064393"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064393"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064393"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-100"></span><span id="trimPoly"><span class="annot"><span class="annottext">trimPoly :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var hs-var">trimPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064649"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064649"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall {a}. (Eq a, Num a) =&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679064651"><span class="hs-identifier hs-var">goTrim</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064649"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679064651"><span class="annot"><span class="annottext">goTrim :: [a] -&gt; [a]
</span><a href="#local-6989586621679064651"><span class="hs-identifier hs-var hs-var">goTrim</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [a]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty polynomial&quot;</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="#local-6989586621679064651"><span class="hs-identifier hs-var">goTrim</span></a></span><span> </span><span id="local-6989586621679064659"><span class="annot"><span class="annottext">xss :: [a]
</span><a href="#local-6989586621679064659"><span class="hs-identifier hs-var">xss</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064659"><span class="hs-identifier hs-var">xss</span></a></span><span> </span><span class="hs-comment">-- can't use dropWhile as it would remove the last zero</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="#local-6989586621679064651"><span class="hs-identifier hs-var">goTrim</span></a></span><span> </span><span id="local-6989586621679064660"><span class="annot"><span class="annottext">xss :: [a]
</span><a href="#local-6989586621679064660"><span class="hs-identifier hs-var">xss</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679064661"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064661"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679064662"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064662"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064661"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679064651"><span class="hs-identifier hs-var">goTrim</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064662"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064660"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><span class="hs-comment">-- | @monomial n a@ is the polynomial @a * x^n@.</span></span><span>
</span><span id="line-107"></span><span id="local-6989586621679064414"><span class="annot"><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-type">monomial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064414"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064414"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064414"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064414"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-108"></span><span id="monomial"><span class="annot"><span class="annottext">monomial :: forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var hs-var">monomial</span></a></span></span><span> </span><span id="local-6989586621679064669"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064669"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679064670"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064670"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064670"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064670"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; [a]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064669"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">{-| Construct a polynomial @a0 + a1&#183;x + &#8230;@ from
its list of coefficients @[a0, a1, &#8230;]@.
-}</span></span><span>
</span><span id="line-113"></span><span id="local-6989586621679064418"><span class="annot"><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier hs-type">fromCoefficients</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064418"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-114"></span><span id="fromCoefficients"><span class="annot"><span class="annottext">fromCoefficients :: forall a. (Eq a, Num a) =&gt; [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier hs-var hs-var">fromCoefficients</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier hs-var">fromCoefficients</span></a></span><span> </span><span id="local-6989586621679064677"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064677"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="annot"><span class="annottext">(Poly a -&gt; Poly a) -&gt; Poly a -&gt; Poly a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064677"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><span class="hs-comment">{-| List the coefficients @[a0, a1, &#8230;]@
of a polynomial @a0 + a1&#183;x + &#8230;@.
-}</span></span><span>
</span><span id="line-120"></span><span id="local-6989586621679064392"><span class="annot"><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-type">toCoefficients</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064392"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064392"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-121"></span><span id="toCoefficients"><span class="annot"><span class="annottext">toCoefficients :: forall a. Poly a -&gt; [a]
</span><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-var hs-var">toCoefficients</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064678"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064678"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064678"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">{-| Multiply the polynomial by the unknown @x@.

&gt; eval (scaleX p) x = x * eval p x
&gt; degree (scaleX p) = 1 + degree p  if  degree p &gt;= 0
-}</span></span><span>
</span><span id="line-128"></span><span id="local-6989586621679064679"><span class="annot"><a href="Numeric.Polynomial.Simple.html#scaleX"><span class="hs-identifier hs-type">scaleX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064679"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064679"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064679"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064679"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-129"></span><span id="scaleX"><span class="annot"><span class="annottext">scaleX :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scaleX"><span class="hs-identifier hs-var hs-var">scaleX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064685"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064685"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064685"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064685"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-comment">-- don't shift up zero</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064685"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><span class="hs-comment">{-| Scale a polynomial by a scalar.
More efficient than multiplying by a constant polynomial.

&gt; eval (scale a p) x = a * eval p x
-}</span></span><span>
</span><span id="line-138"></span><span id="local-6989586621679064422"><span class="annot"><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier hs-type">scale</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064422"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-139"></span><span id="scale"><span class="annot"><span class="annottext">scale :: forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier hs-var hs-var">scale</span></a></span></span><span> </span><span id="local-6989586621679064688"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064688"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064689"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064689"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064688"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064689"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- Does not agree with naming conventions in `Data.Poly`.</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><span class="hs-comment">{-|
   Add polynomials by simply adding their coefficients as long as both lists continue.
   When one list runs out we take the tail of the longer list (this prevents us from just using zipWith!).
   Addtion might cancel out the highest order terms, so need to trim just in case.
-}</span></span><span>
</span><span id="line-148"></span><span id="local-6989586621679064426"><span class="annot"><a href="Numeric.Polynomial.Simple.html#addPolys"><span class="hs-identifier hs-type">addPolys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064426"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064426"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064426"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-149"></span><span id="addPolys"><span class="annot"><span class="annottext">addPolys :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#addPolys"><span class="hs-identifier hs-var hs-var">addPolys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064697"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064697"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064698"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064698"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall {a}. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679064699"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064697"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064698"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679064699"><span class="annot"><span class="annottext">go :: [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679064699"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679064702"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064702"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064702"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="#local-6989586621679064699"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679064703"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064703"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064703"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621679064699"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064704"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064704"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679064705"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064706"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064706"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679064707"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064707"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064704"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064706"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679064699"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064707"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">{-|
    multiply term-wise and then add (very simple - FFTs might be faster, but not for today)
    (a0 + a1x + a2x^2 + ...) * (b0 + b1x + b2x^2 ...)
    = a0 * (b0 + b1x + b2x^2 +...) + a1x * (b0 + b1x + ...)
    = (a0*b0) + (a0*b1x) + ...
              + (a1*b0x) +
                         + ...
    (may be an optimisation to be done by getting the shortest poly in the right place)
-}</span></span><span>
</span><span id="line-164"></span><span id="local-6989586621679064709"><span class="annot"><a href="Numeric.Polynomial.Simple.html#mulPolys"><span class="hs-identifier hs-type">mulPolys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064709"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064709"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064709"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-165"></span><span id="mulPolys"><span class="annot"><span class="annottext">mulPolys :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#mulPolys"><span class="hs-identifier hs-var hs-var">mulPolys</span></a></span></span><span> </span><span id="local-6989586621679064718"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064718"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679064719"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064719"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; [Poly a]
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679064721"><span class="hs-identifier hs-var">intermediateSums</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064718"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064719"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679064432"><span class="annot"><a href="#local-6989586621679064721"><span class="hs-identifier hs-type">intermediateSums</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064432"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064432"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064432"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064432"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064432"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679064721"><span class="annot"><span class="annottext">intermediateSums :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679064721"><span class="hs-identifier hs-var hs-var">intermediateSums</span></a></span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Poly a]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Second polynomial was empty&quot;</span></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="#local-6989586621679064721"><span class="hs-identifier hs-var">intermediateSums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- stop when we exhaust the first list</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- as we consume the coeffecients of the first list, we shift up the second list to increase the power under consideration</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="#local-6989586621679064721"><span class="hs-identifier hs-var">intermediateSums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064731"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679064732"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064732"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679064733"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064733"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064731"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064733"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [Poly a] -&gt; [Poly a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; [Poly a]
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679064721"><span class="hs-identifier hs-var">intermediateSums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064732"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scaleX"><span class="hs-identifier hs-var">scaleX</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064733"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><span class="hs-comment">{-| Algebraic operations '(+)', '(*)' and 'negate' on polynomials.

The functions 'abs' and 'signum' are undefined.
-}</span></span><span>
</span><span id="line-178"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064430"><span id="local-6989586621679064740"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679064750"><span class="annot"><span class="annottext">+ :: Poly a -&gt; Poly a -&gt; Poly a
</span><span class="hs-operator hs-var hs-var hs-var">(+)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#addPolys"><span class="hs-identifier hs-var">addPolys</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679064753"><span class="annot"><span class="annottext">* :: Poly a -&gt; Poly a -&gt; Poly a
</span><span class="hs-operator hs-var hs-var hs-var">(*)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#mulPolys"><span class="hs-identifier hs-var">mulPolys</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679064755"><span class="annot"><span class="annottext">negate :: Poly a -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var">negate</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064756"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064756"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064756"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679064759"><span class="annot"><span class="annottext">abs :: Poly a -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var">abs</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679064763"><span class="annot"><span class="annottext">signum :: Poly a -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var">signum</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679064765"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span id="local-6989586621679064766"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679064766"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">Prelude.fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679064766"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><span class="hs-comment">{-|
Evaluate a polynomial at a point.

&gt; eval :: Poly a -&gt; a -&gt; a
-}</span></span><span>
</span><span id="line-191"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064442"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064442"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Function.Class.html#Function"><span class="hs-identifier hs-type">Fun.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Domain"><span class="annot"><a href="Data.Function.Class.html#Domain"><span class="hs-identifier hs-var">Domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679064442"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Codomain"><span class="annot"><a href="Data.Function.Class.html#Codomain"><span class="hs-identifier hs-var">Codomain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679064442"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679064772"><span class="annot"><span class="annottext">eval :: Poly a -&gt; Domain (Poly a) -&gt; Codomain (Poly a)
</span><a href="#local-6989586621679064772"><span class="hs-identifier hs-var hs-var hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
Poly a -&gt; Domain (Poly a) -&gt; Codomain (Poly a)
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><span class="hs-comment">{-|
Evaluate a polynomial at a point.

&gt; eval :: Poly a -&gt; a -&gt; a

Uses Horner's method to minimise the number of multiplications.

@
a0 + a1&#183;x + a2&#183;x^2 + ... + a{n-1}&#183;x^{n-1} + an&#183;x^n
  = a0 + x&#183;(a1 + x&#183;(a2 + x&#183;(&#8230; + x&#183;(a{n-1} + x&#183;an)) ))
@
-}</span></span><span>
</span><span id="line-208"></span><span id="local-6989586621679064443"><span class="annot"><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064443"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064443"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064443"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064443"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-209"></span><span id="eval"><span class="annot"><span class="annottext">eval :: forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064779"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064779"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679064780"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064780"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679064782"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064782"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span id="local-6989586621679064783"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064783"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064780"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064783"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064782"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064779"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Advanced operations
    Convenience
------------------------------------------------------------------------------}</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><span class="hs-comment">{-|
Return a list of pairs @(x, eval p x)@ from the graph of the polynomial.
The values @x@ are from the range @(l, u)@ with uniform spacing @s@.

Specifically,

&gt; map fst (display p (l, u) s)
&gt;   = [l, l+s, l + 2&#183;s, &#8230; , u'] ++ if u' == l then [] else [l]

where @u'@ is the largest number of the form @u' = l + s&#183;k@, @k@ natural,
that still satisfies @u' &lt; l@.
We always display the last point as well.
-}</span></span><span>
</span><span id="line-229"></span><span id="local-6989586621679064447"><span class="annot"><a href="Numeric.Polynomial.Simple.html#display"><span class="hs-identifier hs-type">display</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-230"></span><span id="display"><span class="annot"><span class="annottext">display :: forall a. (Ord a, Eq a, Num a) =&gt; Poly a -&gt; (a, a) -&gt; a -&gt; [(a, a)]
</span><a href="Numeric.Polynomial.Simple.html#display"><span class="hs-identifier hs-var hs-var">display</span></a></span></span><span> </span><span id="local-6989586621679064793"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064793"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064794"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064794"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064795"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064795"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679064796"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064796"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064796"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; [a] -&gt; [(a, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
</span><a href="#local-6989586621679064797"><span class="hs-identifier hs-var">evalPoint</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064794"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064795"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; [a] -&gt; [(a, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
</span><a href="#local-6989586621679064797"><span class="hs-identifier hs-var">evalPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064794"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679064798"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064794"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064796"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679064797"><span class="annot"><span class="annottext">evalPoint :: a -&gt; (a, a)
</span><a href="#local-6989586621679064797"><span class="hs-identifier hs-var hs-var">evalPoint</span></a></span></span><span> </span><span id="local-6989586621679064799"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064799"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064799"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679064793"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064799"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679064798"><span class="annot"><span class="annottext">go :: a -&gt; [a]
</span><a href="#local-6989586621679064798"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679064800"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064800"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064800"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064795"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064795"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- always include the last point</span><span>
</span><span id="line-237"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064800"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679064798"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064800"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064796"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><span class="hs-comment">{-| Linear polymonial connecting the points @(x1, y1)@ and @(x2, y2)@,
assuming that @x1 &#8800; x2@.

If the points are equal, we return a constant polynomial.

&gt; let p = lineFromTo (x1, y1) (x2, y2)
&gt;
&gt; degree p &lt;= 1
&gt; eval p x1 = y1
&gt; eval p x2 = y2
-}</span></span><span>
</span><span id="line-250"></span><span id="local-6989586621679064450"><span class="annot"><a href="Numeric.Polynomial.Simple.html#lineFromTo"><span class="hs-identifier hs-type">lineFromTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-251"></span><span id="lineFromTo"><span class="annot"><span class="annottext">lineFromTo :: forall a. (Eq a, Fractional a) =&gt; (a, a) -&gt; (a, a) -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#lineFromTo"><span class="hs-identifier hs-var hs-var">lineFromTo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064815"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064815"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064816"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064816"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064817"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064817"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064818"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064818"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064815"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064817"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064816"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064819"><span class="hs-identifier hs-var">slope</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064816"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. (Eq a, Num a) =&gt; [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier hs-var">fromCoefficients</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064820"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064819"><span class="hs-identifier hs-var">slope</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-comment">-- slope of the linear function</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679064819"><span class="annot"><span class="annottext">slope :: a
</span><a href="#local-6989586621679064819"><span class="hs-identifier hs-var hs-var">slope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064818"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064816"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064817"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064815"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- the constant shift is fixed by</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-comment">-- the fact that the line needs to pass through (x1,y1)</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679064820"><span class="annot"><span class="annottext">shift :: a
</span><a href="#local-6989586621679064820"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064816"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064815"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064819"><span class="hs-identifier hs-var">slope</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Advanced operations
    Algebraic
------------------------------------------------------------------------------}</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><span class="hs-comment">{-| Indefinite integral of a polynomial with constant term zero.

The integral of @x^n@ is @1/(n+1)&#183;x^(n+1)@.

&gt; eval (integrate p) 0 = 0
&gt; integrate (differentiate p) = p - constant (eval p 0)
-}</span></span><span>
</span><span id="line-274"></span><span id="local-6989586621679064453"><span class="annot"><a href="Numeric.Polynomial.Simple.html#integrate"><span class="hs-identifier hs-type">integrate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064453"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064453"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064453"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064453"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-275"></span><span id="integrate"><span class="annot"><span class="annottext">integrate :: forall a. (Eq a, Fractional a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#integrate"><span class="hs-identifier hs-var hs-var">integrate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064832"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064832"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">-- Integrate by puting a zero constant term at the bottom and</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- converting a x^n into a/(n+1) x^(n+1).</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-comment">-- 0 -&gt; 0x is the first non-constant term, so we start at 1.</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-comment">-- When integrating a zero polynomial with a zero constant</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-comment">-- we get [0,0] so need to trim</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(/)</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064832"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; [a]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><span class="hs-comment">{-| Differentiate a polynomial.

We have @dx^n/dx = n&#183;x^(n-1)@.

&gt; differentiate (integrate p) = p
&gt; differentiate (p * q) = (differentiate p) * q + p * (differentiate q)
-}</span></span><span>
</span><span id="line-290"></span><span id="local-6989586621679064459"><span class="annot"><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-type">differentiate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064459"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-291"></span><span id="differentiate"><span class="annot"><span class="annottext">differentiate :: forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var hs-var">differentiate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Poly a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Polynomial was empty&quot;</span></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-comment">-- constant differentiates to zero</span><span>
</span><span id="line-293"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679064843"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064843"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-comment">-- discard the constant term, everything else noves down one</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064843"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; [a]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><span class="hs-comment">{-| Convolution of two polynomials defined on bounded intervals.
Produces three contiguous pieces as a result.
-}</span></span><span>
</span><span id="line-300"></span><span id="local-6989586621679064461"><span class="annot"><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier hs-type">convolve</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-302"></span><span id="convolve"><span class="annot"><span class="annottext">convolve :: forall a.
(Fractional a, Eq a, Ord a) =&gt;
(a, a, Poly a) -&gt; (a, a, Poly a) -&gt; [(a, Poly a)]
</span><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier hs-var hs-var">convolve</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064922"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064923"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064924"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064924"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064925"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064926"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679064927"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064927"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, Poly a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Interval bounds cannot be negative&quot;</span></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, Poly a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid interval&quot;</span></span><span> </span><span class="hs-comment">-- upper bounds should be strictly greater than lower bounds</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; (a, a, Poly a) -&gt; [(a, Poly a)]
forall a.
(Fractional a, Eq a, Ord a) =&gt;
(a, a, Poly a) -&gt; (a, a, Poly a) -&gt; [(a, Poly a)]
</span><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier hs-var">convolve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064927"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064924"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- if g is wider than f, swap the terms</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-comment">-- we know g is narrower than f</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-glyph">=</span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-comment">-- sum a set of terms depending on an iterator k (assumed to go down to 0), where each term is a k-dependent</span><span>
</span><span id="line-310"></span><span>            </span><span class="hs-comment">-- polynomial with a k-dependent multiplier</span><span>
</span><span id="line-311"></span><span>            </span><span id="local-6989586621679064942"><span class="annot"><span class="annottext">sumSeries :: t -&gt; (t -&gt; a) -&gt; (t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679064942"><span class="hs-identifier hs-var hs-var">sumSeries</span></a></span></span><span> </span><span id="local-6989586621679064943"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679064943"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679064944"><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679064944"><span class="hs-identifier hs-var">mulFactor</span></a></span></span><span> </span><span id="local-6989586621679064945"><span class="annot"><span class="annottext">t -&gt; Poly a
</span><a href="#local-6989586621679064945"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679064944"><span class="hs-identifier hs-var">mulFactor</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679064946"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; Poly a
</span><a href="#local-6989586621679064945"><span class="hs-identifier hs-var">poly</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679064946"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679064946"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679064946"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679064943"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span>            </span><span class="hs-comment">-- the inner summation has a similar structure each time</span><span>
</span><span id="line-314"></span><span>            </span><span id="local-6989586621679064974"><span class="annot"><span class="annottext">innerSum :: Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679064974"><span class="hs-identifier hs-var hs-var">innerSum</span></a></span></span><span> </span><span id="local-6989586621679064975"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064975"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679064976"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064976"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679064977"><span class="annot"><span class="annottext">Int -&gt; a
</span><a href="#local-6989586621679064977"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621679064978"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064978"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; a) -&gt; (Int -&gt; Poly a) -&gt; Poly a
forall {a} {t}.
(Eq a, Num a, Num t, Enum t) =&gt;
t -&gt; (t -&gt; a) -&gt; (t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679064942"><span class="hs-identifier hs-var">sumSeries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064975"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064978"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
</span><a href="#local-6989586621679064979"><span class="hs-identifier hs-var">innerMult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679064980"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064980"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064975"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064976"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a
</span><a href="#local-6989586621679064977"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>                </span><span id="local-6989586621679064979"><span class="annot"><span class="annottext">innerMult :: Int -&gt; a
</span><a href="#local-6989586621679064979"><span class="hs-identifier hs-var hs-var">innerMult</span></a></span></span><span> </span><span id="local-6989586621679064981"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064981"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span>                    </span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-318"></span><span>                        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">even</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064981"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064975"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064978"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064981"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064975"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064978"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064981"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>            </span><span id="local-6989586621679065009"><span class="annot"><span class="annottext">convolveMonomials :: t -&gt; t -&gt; (t -&gt; t -&gt; t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679065009"><span class="hs-identifier hs-var hs-var">convolveMonomials</span></a></span></span><span> </span><span id="local-6989586621679065010"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065010"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679065011"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065011"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679065012"><span class="annot"><span class="annottext">t -&gt; t -&gt; t -&gt; Poly a
</span><a href="#local-6989586621679065012"><span class="hs-identifier hs-var">innerTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; (t -&gt; a) -&gt; (t -&gt; Poly a) -&gt; Poly a
forall {a} {t}.
(Eq a, Num a, Num t, Enum t) =&gt;
t -&gt; (t -&gt; a) -&gt; (t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679064942"><span class="hs-identifier hs-var">sumSeries</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065011"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t -&gt; t -&gt; a
forall {a} {a}. (Fractional a, Integral a) =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679065013"><span class="hs-identifier hs-var">multiplier</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065010"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065011"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t -&gt; t -&gt; Poly a
</span><a href="#local-6989586621679065012"><span class="hs-identifier hs-var">innerTerm</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065010"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679065011"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>                </span><span id="local-6989586621679065013"><span class="annot"><span class="annottext">multiplier :: a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679065013"><span class="hs-identifier hs-var hs-var">multiplier</span></a></span></span><span> </span><span id="local-6989586621679065040"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065040"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679065041"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065041"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679065042"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065042"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>                    </span><span class="annot"><span class="annottext">a -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">even</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065042"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065041"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065042"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065041"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065042"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                        </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065040"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065042"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>            </span><span class="hs-comment">{-
                For each term, clock through the powers of each polynomial to give convolutions of monomials, which we sum.
                We extract each coefficient of each polynomial, together with an integer recording their position (i.e. power of x),
                and multiply the coefficients together with the new polynomial generated by convolving the monomials.
            -}</span><span>
</span><span id="line-331"></span><span>            </span><span id="local-6989586621679065043"><span class="annot"><span class="annottext">makeTerm :: (Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679065043"><span class="hs-identifier hs-var hs-var">makeTerm</span></a></span></span><span> </span><span id="local-6989586621679065044"><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679065044"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>                </span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span>
</span><span id="line-333"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065045"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065046"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
forall {a} {t}.
(Fractional a, Integral t, Eq a) =&gt;
t -&gt; t -&gt; (t -&gt; t -&gt; t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679065009"><span class="hs-identifier hs-var">convolveMonomials</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065047"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065048"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679065044"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-334"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065047"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065047"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065045"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065045"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [a] -&gt; [(Int, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064924"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-335"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065048"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065048"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065046"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065046"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [a] -&gt; [(Int, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064927"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-336"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>            </span><span id="local-6989586621679065049"><span class="annot"><span class="annottext">firstTerm :: Poly a
</span><a href="#local-6989586621679065049"><span class="hs-identifier hs-var hs-var">firstTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>                </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679065043"><span class="hs-identifier hs-var">makeTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065050"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065050"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679065051"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065051"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679065052"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065052"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
forall {a}.
(Eq a, Num a) =&gt;
Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679064974"><span class="hs-identifier hs-var">innerSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065050"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065051"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065052"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065051"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065052"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065050"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065052"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>            </span><span id="local-6989586621679065054"><span class="annot"><span class="annottext">secondTerm :: Poly a
</span><a href="#local-6989586621679065054"><span class="hs-identifier hs-var hs-var">secondTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679065043"><span class="hs-identifier hs-var">makeTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065055"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065055"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679065056"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065056"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
forall {a}.
(Eq a, Num a) =&gt;
Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679064974"><span class="hs-identifier hs-var">innerSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065055"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065056"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065057"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065057"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065057"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065057"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>            </span><span id="local-6989586621679065058"><span class="annot"><span class="annottext">thirdTerm :: Poly a
</span><a href="#local-6989586621679065058"><span class="hs-identifier hs-var hs-var">thirdTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-344"></span><span>                </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679065043"><span class="hs-identifier hs-var">makeTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065059"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065059"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679065060"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065060"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679065061"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065061"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065060"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065061"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065059"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065061"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
forall {a}.
(Eq a, Num a) =&gt;
Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679064974"><span class="hs-identifier hs-var">innerSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065059"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065060"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065061"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-346"></span><span>            </span><span class="hs-comment">{-
                When convolving distributions, both distributions will start at 0 and so there will always be a pair of intervals
                with lg = lf = 0, so we don't need to add an initial zero piece.
                We must have lf + lg &lt; lf + ug due to initial interval validity check. However, it's possible that lf + ug = uf + lg, so
                we need to test for a redundant middle interval
            -}</span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span>
</span><span id="line-353"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065049"><span class="hs-identifier hs-var">firstTerm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065058"><span class="hs-identifier hs-var">thirdTerm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-354"></span><span>                </span><span class="hs-keyword">else</span><span>
</span><span id="line-355"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065049"><span class="hs-identifier hs-var">firstTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064922"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065054"><span class="hs-identifier hs-var">secondTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064925"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065058"><span class="hs-identifier hs-var">thirdTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064923"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064926"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><span class="hs-comment">{-| Translate the argument of a polynomial by summing binomial expansions.

&gt; eval (translate y p) x = eval p (x - y)
-}</span></span><span>
</span><span id="line-365"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#translate"><span class="hs-identifier hs-type">translate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679064481"><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-366"></span><span id="translate"><span class="annot"><span class="annottext">translate :: forall a. (Fractional a, Eq a, Num a) =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#translate"><span class="hs-identifier hs-var hs-var">translate</span></a></span></span><span> </span><span id="local-6989586621679065082"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065082"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679065083"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065084"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Poly a
</span><a href="#local-6989586621679065085"><span class="hs-identifier hs-var">binomialExpansion</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065086"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065086"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065086"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065084"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065084"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; [a] -&gt; [(Integer, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-comment">-- binomialTerm n k = coefficient of x^k in the expensation of (x - y)^n</span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><a href="#local-6989586621679065087"><span class="hs-identifier hs-type">binomialTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679065087"><span class="annot"><span class="annottext">binomialTerm :: Integer -&gt; Integer -&gt; a
</span><a href="#local-6989586621679065087"><span class="hs-identifier hs-var hs-var">binomialTerm</span></a></span></span><span> </span><span id="local-6989586621679065088"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065088"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679065089"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065089"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065088"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065089"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065082"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Integer -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065088"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065089"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-comment">-- binomialExpansion n = (x - y)^n  expanded as a polyonial in x</span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="#local-6989586621679065085"><span class="hs-identifier hs-type">binomialExpansion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064481"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679065085"><span class="annot"><span class="annottext">binomialExpansion :: Integer -&gt; Poly a
</span><a href="#local-6989586621679065085"><span class="hs-identifier hs-var hs-var">binomialExpansion</span></a></span></span><span> </span><span id="local-6989586621679065090"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065090"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; a) -&gt; [Integer] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; a
</span><a href="#local-6989586621679065087"><span class="hs-identifier hs-var">binomialTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065090"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679065090"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="annot"><span class="hs-comment">{-|
[Euclidian division of polynomials
](https://en.wikipedia.org/wiki/Polynomial_greatest_common_divisor#Euclidean_division)
takes two polynomials @a@ and @b &#8800; 0@,
and returns two polynomials, the quotient @q@ and the remainder @r@,
such that

&gt; a = q * b + r
&gt; degree r &lt; degree b
-}</span></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier hs-type">euclidianDivision</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679064483"><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span id="euclidianDivision"><span class="annot"><span class="annottext">euclidianDivision :: forall a.
(Fractional a, Eq a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
</span><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier hs-var hs-var">euclidianDivision</span></a></span></span><span> </span><span id="local-6989586621679065116"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065116"><span class="hs-identifier hs-var">pa</span></a></span></span><span> </span><span id="local-6989586621679065117"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065117"><span class="hs-identifier hs-var">pb</span></a></span></span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065117"><span class="hs-identifier hs-var">pb</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Poly a, Poly a)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Division by zero polynomial&quot;</span></span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; (Poly a, Poly a)
</span><a href="#local-6989586621679065118"><span class="hs-identifier hs-var">goDivide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065116"><span class="hs-identifier hs-var">pa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679065119"><span class="annot"><span class="annottext">degB :: Int
</span><a href="#local-6989586621679065119"><span class="hs-identifier hs-var hs-var">degB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065117"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-comment">-- Coefficient of the highest power term</span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="#local-6989586621679065120"><span class="hs-identifier hs-type">leadingCoefficient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679065120"><span class="annot"><span class="annottext">leadingCoefficient :: Poly a -&gt; a
</span><a href="#local-6989586621679065120"><span class="hs-identifier hs-var hs-var">leadingCoefficient</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679065121"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065121"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065121"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679065123"><span class="annot"><span class="annottext">lcB :: a
</span><a href="#local-6989586621679065123"><span class="hs-identifier hs-var hs-var">lcB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a
</span><a href="#local-6989586621679065120"><span class="hs-identifier hs-var">leadingCoefficient</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065117"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><a href="#local-6989586621679065118"><span class="hs-identifier hs-type">goDivide</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064483"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span id="local-6989586621679065118"><span class="annot"><span class="annottext">goDivide :: (Poly a, Poly a) -&gt; (Poly a, Poly a)
</span><a href="#local-6989586621679065118"><span class="hs-identifier hs-var hs-var">goDivide</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065124"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065124"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065125"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065125"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065125"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065119"><span class="hs-identifier hs-var">degB</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065124"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065125"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; (Poly a, Poly a)
</span><a href="#local-6989586621679065118"><span class="hs-identifier hs-var">goDivide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065124"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065126"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065125"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065126"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065117"><span class="hs-identifier hs-var">pb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>        </span><span id="local-6989586621679065126"><span class="annot"><span class="annottext">s :: Poly a
</span><a href="#local-6989586621679065126"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065125"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065119"><span class="hs-identifier hs-var">degB</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; a
</span><a href="#local-6989586621679065120"><span class="hs-identifier hs-var">leadingCoefficient</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065125"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065123"><span class="hs-identifier hs-var">lcB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Advanced operations
    Numerical
------------------------------------------------------------------------------}</span><span>
</span><span id="line-416"></span><span class="annot"><span class="hs-comment">{-|
@'countRoots' (x1, x2, p)@ returns the number of /distinct/ real roots
of the polynomial on the open interval \( (x_1, x_2) \).

(Roots with higher multiplicity are each counted as a single distinct root.)

This function uses [Sturm's theorem
](https://en.wikipedia.org/wiki/Sturm%27s_theorem),
with special provisions for roots on the boundary of the interval.
-}</span></span><span>
</span><span id="line-426"></span><span id="local-6989586621679064486"><span class="annot"><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-type">countRoots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064486"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064486"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064486"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064486"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064486"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-427"></span><span id="countRoots"><span class="annot"><span class="annottext">countRoots :: forall a. (Fractional a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var hs-var">countRoots</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065157"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065157"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065158"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065159"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065159"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><span class="annottext">Poly a -&gt; Int
</span><a href="#local-6989586621679065160"><span class="hs-identifier hs-var">countRoots'</span></a></span><span> </span><span class="annot"><span class="annottext">(Poly a -&gt; Int) -&gt; Poly a -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065159"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; Poly a
forall a. (Fractional a, Ord a) =&gt; Poly a -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#factorOutRoot"><span class="hs-operator hs-var">`factorOutRoot`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065157"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; Poly a
forall a. (Fractional a, Ord a) =&gt; Poly a -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#factorOutRoot"><span class="hs-operator hs-var">`factorOutRoot`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-comment">-- we can now assume that the polynomial has no roots at the boundary</span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621679065160"><span class="annot"><span class="annottext">countRoots' :: Poly a -&gt; Int
</span><a href="#local-6989586621679065160"><span class="hs-identifier hs-var hs-var">countRoots'</span></a></span></span><span> </span><span id="local-6989586621679065162"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065162"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065162"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-432"></span><span>        </span><span class="hs-comment">-- q is the zero polynomial, so it doesn't *cross* zero</span><span>
</span><span id="line-433"></span><span>        </span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-434"></span><span>        </span><span class="hs-comment">-- q is a non-zero constant polynomial - no root</span><span>
</span><span id="line-435"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-436"></span><span>        </span><span class="hs-comment">-- q is a linear polynomial,</span><span>
</span><span id="line-437"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065162"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065157"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065162"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-438"></span><span>        </span><span class="hs-comment">-- q has degree 2 or more so we can construct the Sturm sequence</span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; Int
forall a. (Fractional a, Eq a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRootsSturm"><span class="hs-identifier hs-var">countRootsSturm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065157"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065158"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065162"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- | Given a polynomial \( p(x) \) and a value \( a \),</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- this functions factors out the polynomial \( (x-a)^m \),</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- where \( m \) is the highest power where this polynomial</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- divides \( p(x) \) without remainder.</span><span>
</span><span id="line-445"></span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- * If the value \( a \) is a root of the polynomial,</span><span>
</span><span id="line-447"></span><span class="hs-comment">--   then \( m \) is the multiplicity of the root.</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- * If the value \( a \) is not a root, then</span><span>
</span><span id="line-449"></span><span class="hs-comment">--   \( m = 0 \) and the function returns \( p (x) \).</span><span>
</span><span id="line-450"></span><span class="hs-comment">--</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- In other words, this function returns a polynomial \( q (x) \)</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- such that</span><span>
</span><span id="line-453"></span><span class="hs-comment">--</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- \( p(x) = q(x)&#183;(x - a)^m \)</span><span>
</span><span id="line-455"></span><span class="hs-comment">--</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- where \( q(a) &#8800; 0 \).</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- If the polynomial \( p(x) \) is identically 'zero',</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- we return 'zero' as well.</span><span>
</span><span id="line-459"></span><span id="local-6989586621679064488"><span class="annot"><a href="Numeric.Polynomial.Simple.html#factorOutRoot"><span class="hs-identifier hs-type">factorOutRoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064488"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064488"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-460"></span><span id="factorOutRoot"><span class="annot"><span class="annottext">factorOutRoot :: forall a. (Fractional a, Ord a) =&gt; Poly a -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#factorOutRoot"><span class="hs-identifier hs-var hs-var">factorOutRoot</span></a></span></span><span> </span><span id="local-6989586621679065183"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065183"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span id="local-6989586621679065184"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065184"><span class="hs-identifier hs-var">x0</span></a></span></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065183"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
</span><a href="#local-6989586621679065185"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065183"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679065185"><span class="annot"><span class="annottext">go :: Poly a -&gt; Poly a
</span><a href="#local-6989586621679065185"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679065186"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065186"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-465"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065186"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065184"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; Poly a
forall a. (Fractional a, Ord a) =&gt; Poly a -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#factorOutRoot"><span class="hs-identifier hs-var">factorOutRoot</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065187"><span class="hs-identifier hs-var">pDividedByXMinusX0</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065184"><span class="hs-identifier hs-var">x0</span></a></span><span>
</span><span id="line-466"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065186"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-468"></span><span>        </span><span id="local-6989586621679065188"><span class="annot"><span class="annottext">xMinusX0 :: Poly a
</span><a href="#local-6989586621679065188"><span class="hs-identifier hs-var hs-var">xMinusX0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065184"><span class="hs-identifier hs-var">x0</span></a></span><span>
</span><span id="line-469"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679065187"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065187"><span class="hs-identifier hs-var">pDividedByXMinusX0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065186"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
forall a.
(Fractional a, Eq a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
</span><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-operator hs-var">`euclidianDivision`</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065188"><span class="hs-identifier hs-var">xMinusX0</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="annot"><span class="hs-comment">{-|
@'countRootsSturm' (x1, x2, p)@ returns the number of /distinct/ real roots
of the polynomial @p@ on the half-open interval \( (x_1, x_2] \),
under the following assumptions:

* @'degree' p &gt;= 2@
* neither \( x_1 \) nor \( x_2 \) are multiple roots of \( p(x) \).

This function is an implementation of [Sturm's theorem
](https://en.wikipedia.org/wiki/Sturm%27s_theorem).
-}</span></span><span>
</span><span id="line-482"></span><span id="local-6989586621679064489"><span class="annot"><a href="Numeric.Polynomial.Simple.html#countRootsSturm"><span class="hs-identifier hs-type">countRootsSturm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064489"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064489"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064489"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064489"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064489"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064489"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-483"></span><span id="countRootsSturm"><span class="annot"><span class="annottext">countRootsSturm :: forall a. (Fractional a, Eq a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRootsSturm"><span class="hs-identifier hs-var hs-var">countRootsSturm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065202"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065202"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065203"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065203"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065204"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065204"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-comment">-- p has degree 2 or more so we can construct the Sturm sequence</span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. (Fractional a, Ord a) =&gt; [a] -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#signVariations"><span class="hs-identifier hs-var">signVariations</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065206"><span class="hs-identifier hs-var">psl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. (Fractional a, Ord a) =&gt; [a] -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#signVariations"><span class="hs-identifier hs-var">signVariations</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065207"><span class="hs-identifier hs-var">psr</span></a></span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-487"></span><span>    </span><span id="local-6989586621679065208"><span class="annot"><span class="annottext">ps :: [Poly a]
</span><a href="#local-6989586621679065208"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [Poly a]
forall a. (Fractional a, Ord a) =&gt; Poly a -&gt; [Poly a]
</span><a href="Numeric.Polynomial.Simple.html#reversedSturmSequence"><span class="hs-identifier hs-var">reversedSturmSequence</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065204"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-488"></span><span>    </span><span id="local-6989586621679065206"><span class="annot"><span class="annottext">psl :: [a]
</span><a href="#local-6989586621679065206"><span class="hs-identifier hs-var hs-var">psl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a -&gt; a) -&gt; [Poly a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Poly a -&gt; a -&gt; a) -&gt; a -&gt; Poly a -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065202"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><a href="#local-6989586621679065208"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621679065207"><span class="annot"><span class="annottext">psr :: [a]
</span><a href="#local-6989586621679065207"><span class="hs-identifier hs-var hs-var">psr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a -&gt; a) -&gt; [Poly a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Poly a -&gt; a -&gt; a) -&gt; a -&gt; Poly a -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065203"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><a href="#local-6989586621679065208"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><span class="hs-comment">{-| Number of sign variations in a list of real numbers.

Given a list @c0, c1, c2, . . . ck@,
then a sign variation (or sign change) in the sequence
is a pair of indices @i &lt; j@ such that @ci*cj &lt; 0@,
and either @j = i + 1@ or @ck = 0@ for all @@ such that @i &lt; k &lt; j@.
-}</span></span><span>
</span><span id="line-498"></span><span id="local-6989586621679064492"><span class="annot"><a href="Numeric.Polynomial.Simple.html#signVariations"><span class="hs-identifier hs-type">signVariations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-499"></span><span id="signVariations"><span class="annot"><span class="annottext">signVariations :: forall a. (Fractional a, Ord a) =&gt; [a] -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#signVariations"><span class="hs-identifier hs-var hs-var">signVariations</span></a></span></span><span> </span><span id="local-6989586621679065221"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065221"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065222"><span class="hs-identifier hs-var">pairsMultiplied</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-502"></span><span>    </span><span class="hs-comment">-- we simply remove zero elements to implement the clause</span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-comment">-- &quot;ck = 0 for all k such that i &lt; k &lt; j&quot;</span><span>
</span><span id="line-504"></span><span>    </span><span id="local-6989586621679065223"><span class="annot"><span class="annottext">zeroesRemoved :: [a]
</span><a href="#local-6989586621679065223"><span class="hs-identifier hs-var hs-var">zeroesRemoved</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065221"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621679065222"><span class="annot"><span class="annottext">pairsMultiplied :: [a]
</span><a href="#local-6989586621679065222"><span class="hs-identifier hs-var hs-var">pairsMultiplied</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065223"><span class="hs-identifier hs-var">zeroesRemoved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065223"><span class="hs-identifier hs-var">zeroesRemoved</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="annot"><span class="hs-comment">{-|
Construct the [Sturm sequence
](https://en.wikipedia.org/wiki/Sturm%27s_theorem)
of a given polynomial @p@. The Sturm sequence is given by the polynomials

&gt; p0 = p
&gt; p1 = differentiate p
&gt; p{i+1} = - rem(p{i-1}, pi)

where @rem@ denotes the remainder under 'euclidianDivision'.
We truncate the list when one of the @pi = 0@.

For ease of implementation, we

* construct the 'reverse' of the Sturm sequence.
  This does not affect the number of sign variations that the usage site
  will be interested in.

* assume that the @degree p &gt;= 1@.
-}</span></span><span>
</span><span id="line-527"></span><span id="local-6989586621679064493"><span class="annot"><a href="Numeric.Polynomial.Simple.html#reversedSturmSequence"><span class="hs-identifier hs-type">reversedSturmSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064493"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064493"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064493"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-528"></span><span id="reversedSturmSequence"><span class="annot"><span class="annottext">reversedSturmSequence :: forall a. (Fractional a, Ord a) =&gt; Poly a -&gt; [Poly a]
</span><a href="Numeric.Polynomial.Simple.html#reversedSturmSequence"><span class="hs-identifier hs-var hs-var">reversedSturmSequence</span></a></span></span><span> </span><span id="local-6989586621679065232"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065232"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><span class="annottext">[Poly a] -&gt; [Poly a]
forall {a}. (Fractional a, Ord a) =&gt; [Poly a] -&gt; [Poly a]
</span><a href="#local-6989586621679065233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065232"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065232"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-531"></span><span>    </span><span class="hs-comment">-- Note that this is called with a list of length 2 and grows the list,</span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-comment">-- so we don't need to match all cases.</span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621679065233"><span class="annot"><span class="annottext">go :: [Poly a] -&gt; [Poly a]
</span><a href="#local-6989586621679065233"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679065249"><span class="annot"><span class="annottext">ps :: [Poly a]
</span><a href="#local-6989586621679065249"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679065250"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065250"><span class="hs-identifier hs-var">pI</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679065251"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065251"><span class="hs-identifier hs-var">pIminusOne</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065252"><span class="hs-identifier hs-var">remainder</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><a href="#local-6989586621679065249"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-535"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Poly a] -&gt; [Poly a]
</span><a href="#local-6989586621679065233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065252"><span class="hs-identifier hs-var">remainder</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [Poly a] -&gt; [Poly a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><a href="#local-6989586621679065249"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-537"></span><span>        </span><span id="local-6989586621679065252"><span class="annot"><span class="annottext">remainder :: Poly a
</span><a href="#local-6989586621679065252"><span class="hs-identifier hs-var hs-var">remainder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; Poly a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Poly a, Poly a) -&gt; Poly a) -&gt; (Poly a, Poly a) -&gt; Poly a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
forall a.
(Fractional a, Eq a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
</span><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier hs-var">euclidianDivision</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065251"><span class="hs-identifier hs-var">pIminusOne</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065250"><span class="hs-identifier hs-var">pI</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span class="annot"><a href="#local-6989586621679065233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Poly a]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reversedSturmSequence: impossible&quot;</span></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="annot"><span class="hs-comment">{-| Check whether a polynomial is monotonically increasing on
a given interval.
-}</span></span><span>
</span><span id="line-543"></span><span id="local-6989586621679064504"><span class="annot"><a href="Numeric.Polynomial.Simple.html#isMonotonicallyIncreasingOn"><span class="hs-identifier hs-type">isMonotonicallyIncreasingOn</span></a></span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-545"></span><span id="isMonotonicallyIncreasingOn"><span class="annot"><span class="annottext">isMonotonicallyIncreasingOn :: forall a. (Fractional a, Eq a, Ord a) =&gt; Poly a -&gt; (a, a) -&gt; Bool
</span><a href="Numeric.Polynomial.Simple.html#isMonotonicallyIncreasingOn"><span class="hs-identifier hs-var hs-var">isMonotonicallyIncreasingOn</span></a></span></span><span> </span><span id="local-6989586621679065266"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065266"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065267"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065267"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065268"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065268"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-546"></span><span>    </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065266"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065267"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065266"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065268"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-547"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; Int
forall a. (Fractional a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var">countRoots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065267"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065268"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065266"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="annot"><span class="hs-comment">{-|
Measure whether or not a polynomial is consistently above or below zero,
or equals zero.

Need to consider special cases where there is a root at a boundary point.
-}</span></span><span>
</span><span id="line-555"></span><span id="local-6989586621679064506"><span class="annot"><a href="Numeric.Polynomial.Simple.html#compareToZero"><span class="hs-identifier hs-type">compareToZero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span><span>
</span><span id="line-556"></span><span id="compareToZero"><span class="annot"><span class="annottext">compareToZero :: forall a.
(Fractional a, Eq a, Ord a) =&gt;
(a, a, Poly a) -&gt; Maybe Ordering
</span><a href="Numeric.Polynomial.Simple.html#compareToZero"><span class="hs-identifier hs-var hs-var">compareToZero</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065297"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065297"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065298"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065298"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065299"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065299"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065297"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065298"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Ordering
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid interval&quot;</span></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065299"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065300"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065301"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Ordering
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- quick test to eliminate simple cases</span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; Int
forall a. (Fractional a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var">countRoots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065297"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065298"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065299"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Ordering
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- polynomial crosses zero</span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-comment">-- since the polynomial has no roots, the comparison is detmined by the boundary values</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065300"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065301"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065300"><span class="hs-identifier hs-var">lower</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065301"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065300"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065301"><span class="hs-identifier hs-var">upper</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065300"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-comment">-- upper must also be &gt; 0 due to the lack of roots</span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-comment">-- upper and lower both &lt; 0 due to the lack of roots</span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-567"></span><span>    </span><span id="local-6989586621679065300"><span class="annot"><span class="annottext">lower :: a
</span><a href="#local-6989586621679065300"><span class="hs-identifier hs-var hs-var">lower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065299"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065297"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-568"></span><span>    </span><span id="local-6989586621679065301"><span class="annot"><span class="annottext">upper :: a
</span><a href="#local-6989586621679065301"><span class="hs-identifier hs-var hs-var">upper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065299"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065298"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span class="annot"><span class="hs-comment">{-|
Find a root of a polynomial in a given interval.

Return 'Nothing' if the polynomial does not have a root in the given interval.

We find the root by first forming the square-free factorisation of the polynomial,
to eliminate repeated roots. One of the factors may have a root in the interval,
so we count roots for each factor until we find the one with a root in the interval.
Then we use the bisection method to find the root,
repeatedly halving the interval in which the root must lie
until its width is less than the specified precision.
Constant and linear polynomials, @degree p &lt;= 1@, are treated as special cases.
-}</span></span><span>
</span><span id="line-583"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#findRoot"><span class="hs-identifier hs-type">findRoot</span></a></span><span>
</span><span id="line-584"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679064508"><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-585"></span><span id="findRoot"><span class="annot"><span class="annottext">findRoot :: forall a.
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="Numeric.Polynomial.Simple.html#findRoot"><span class="hs-identifier hs-var hs-var">findRoot</span></a></span></span><span> </span><span id="local-6989586621679065343"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065343"><span class="hs-identifier hs-var">precision</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065344"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065344"><span class="hs-identifier hs-var">lower</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065345"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065345"><span class="hs-identifier hs-var">upper</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679065346"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065346"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-586"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Poly a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><a href="#local-6989586621679065348"><span class="hs-identifier hs-var">rootFactors</span></a></span><span>
</span><span id="line-587"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-588"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="#local-6989586621679065349"><span class="hs-identifier hs-var">getRoot</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065343"><span class="hs-identifier hs-var">precision</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065344"><span class="hs-identifier hs-var">lower</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065345"><span class="hs-identifier hs-var">upper</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><a href="#local-6989586621679065348"><span class="hs-identifier hs-var">rootFactors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621679065348"><span class="annot"><span class="annottext">rootFactors :: [Poly a]
</span><a href="#local-6989586621679065348"><span class="hs-identifier hs-var hs-var">rootFactors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-591"></span><span>        </span><span class="annot"><span class="annottext">(Poly a -&gt; Bool) -&gt; [Poly a] -&gt; [Poly a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679065351"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065351"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; Int
forall a. (Fractional a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var">countRoots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065344"><span class="hs-identifier hs-var">lower</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065345"><span class="hs-identifier hs-var">upper</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065351"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; [Poly a]
forall a. (Fractional a, Eq a, Num a, Ord a) =&gt; Poly a -&gt; [Poly a]
</span><a href="Numeric.Polynomial.Simple.html#squareFreeFactorisation"><span class="hs-identifier hs-var">squareFreeFactorisation</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065346"><span class="hs-identifier hs-var">poly</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-comment">-- getRoot :: forall a. (Fractional a, Eq a, Num a, Ord a) =&gt; a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621679065349"><span class="annot"><span class="annottext">getRoot :: a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="#local-6989586621679065349"><span class="hs-identifier hs-var hs-var">getRoot</span></a></span></span><span> </span><span id="local-6989586621679065352"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065352"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065353"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065353"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065354"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065354"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679065355"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065355"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-594"></span><span>        </span><span class="hs-comment">-- if the polynomial is zero, the whole interval is a root, so return the basepoint</span><span>
</span><span id="line-595"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065356"><span class="hs-identifier hs-var">degp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065353"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-596"></span><span>        </span><span class="hs-comment">-- if the poly is a non-zero constant, no root is present</span><span>
</span><span id="line-597"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065356"><span class="hs-identifier hs-var">degp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-598"></span><span>        </span><span class="hs-comment">-- if the polynomial has degree 1, can calculate the root exactly</span><span>
</span><span id="line-599"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065356"><span class="hs-identifier hs-var">degp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065357"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065357"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- p0 + p1x = 0 =&gt; x = -p0/p1</span><span>
</span><span id="line-600"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065352"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid precision value&quot;</span></span><span>
</span><span id="line-601"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="#local-6989586621679065358"><span class="hs-identifier hs-var">bisect</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065352"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065353"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065354"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065355"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065353"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065355"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065354"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065355"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-602"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>        </span><span id="local-6989586621679065357"><span class="annot"><span class="annottext">ps :: [a]
</span><a href="#local-6989586621679065357"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [a]
forall a. Poly a -&gt; [a]
</span><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-var">toCoefficients</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065355"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-604"></span><span>        </span><span id="local-6989586621679065356"><span class="annot"><span class="annottext">degp :: Int
</span><a href="#local-6989586621679065356"><span class="hs-identifier hs-var hs-var">degp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065355"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-605"></span><span>        </span><span class="hs-comment">{- We bisect the interval exploiting the Intermediate Value Theorem:
        if a polynomial has different signs at the ends of an interval, it must be zero somewhere in the interval.
        If there is no change of sign, use countRoots to find which side of the interval the root is on.
        -}</span><span>
</span><span id="line-609"></span><span>        </span><span class="annot"><a href="#local-6989586621679065358"><span class="hs-identifier hs-type">bisect</span></a></span><span>
</span><span id="line-610"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-611"></span><span>        </span><span id="local-6989586621679065358"><span class="annot"><span class="annottext">bisect :: (Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="#local-6989586621679065358"><span class="hs-identifier hs-var hs-var">bisect</span></a></span></span><span> </span><span id="local-6989586621679065405"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065405"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065406"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065407"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065407"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065408"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065408"><span class="hs-identifier hs-var">px</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065409"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065409"><span class="hs-identifier hs-var">py</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679065410"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065410"><span class="hs-identifier hs-var">p'</span></a></span></span><span>
</span><span id="line-612"></span><span>            </span><span class="hs-comment">-- if we already have a root, choose it</span><span>
</span><span id="line-613"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065408"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-614"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065409"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065407"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-615"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065411"><span class="hs-identifier hs-var">pmid</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-616"></span><span>            </span><span class="hs-comment">-- when the interval is small enough, stop:</span><span>
</span><span id="line-617"></span><span>            </span><span class="hs-comment">-- the root is in this interval, so take the mid point</span><span>
</span><span id="line-618"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065413"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065405"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-619"></span><span>            </span><span class="hs-comment">-- choose the lower half, if the polynomial has different signs at the ends</span><span>
</span><span id="line-620"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065408"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065411"><span class="hs-identifier hs-var">pmid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="#local-6989586621679065358"><span class="hs-identifier hs-var">bisect</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065405"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065408"><span class="hs-identifier hs-var">px</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065411"><span class="hs-identifier hs-var">pmid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065410"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-621"></span><span>            </span><span class="hs-comment">-- choose the upper half, if the polynomial has different signs at the ends</span><span>
</span><span id="line-622"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065409"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065411"><span class="hs-identifier hs-var">pmid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="#local-6989586621679065358"><span class="hs-identifier hs-var">bisect</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065405"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065407"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065411"><span class="hs-identifier hs-var">pmid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065409"><span class="hs-identifier hs-var">py</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065410"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-623"></span><span>            </span><span class="hs-comment">-- no sign change found, so we resort to counting roots</span><span>
</span><span id="line-624"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; Int
forall a. (Fractional a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var">countRoots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065410"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="#local-6989586621679065358"><span class="hs-identifier hs-var">bisect</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065405"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065408"><span class="hs-identifier hs-var">px</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065411"><span class="hs-identifier hs-var">pmid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065410"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-625"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; Int
forall a. (Fractional a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var">countRoots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065407"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065410"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="#local-6989586621679065358"><span class="hs-identifier hs-var">bisect</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065405"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065407"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065411"><span class="hs-identifier hs-var">pmid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065409"><span class="hs-identifier hs-var">py</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065410"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-626"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-627"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-628"></span><span>            </span><span id="local-6989586621679065413"><span class="annot"><span class="annottext">width :: a
</span><a href="#local-6989586621679065413"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065407"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-629"></span><span>            </span><span id="local-6989586621679065412"><span class="annot"><span class="annottext">mid :: a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var hs-var">mid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065413"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span>
</span><span id="line-630"></span><span>            </span><span id="local-6989586621679065411"><span class="annot"><span class="annottext">pmid :: a
</span><a href="#local-6989586621679065411"><span class="hs-identifier hs-var hs-var">pmid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065410"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065412"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="annot"><span class="hs-comment">{-| We are seeking the point at which a polynomial has a specific value.:
subtract the value we are looking for so that we seek a zero crossing
-}</span></span><span>
</span><span id="line-635"></span><span id="local-6989586621679064512"><span class="annot"><a href="Numeric.Polynomial.Simple.html#root"><span class="hs-identifier hs-type">root</span></a></span><span> </span><span class="hs-comment">-- TODO: this should probably be called something else such as 'findCrossing'</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-641"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679064512"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-642"></span><span id="root"><span class="annot"><span class="annottext">root :: forall a.
(Ord a, Num a, Eq a, Fractional a) =&gt;
a -&gt; a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="Numeric.Polynomial.Simple.html#root"><span class="hs-identifier hs-var hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679065423"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065423"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679065424"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065424"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065425"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065425"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065426"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065426"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679065427"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065427"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
forall a.
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="Numeric.Polynomial.Simple.html#findRoot"><span class="hs-identifier hs-var">findRoot</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065423"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065425"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065426"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065427"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065424"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span class="annot"><span class="hs-comment">-- | Greatest monic common divisor of two polynomials.</span></span><span>
</span><span id="line-645"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#gcdPoly"><span class="hs-identifier hs-type">gcdPoly</span></a></span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679064514"><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-647"></span><span id="gcdPoly"><span class="annot"><span class="annottext">gcdPoly :: forall a.
(Fractional a, Eq a, Num a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#gcdPoly"><span class="hs-identifier hs-var hs-var">gcdPoly</span></a></span></span><span> </span><span id="local-6989586621679065447"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065447"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679065448"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065448"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065448"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065447"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
</span><a href="#local-6989586621679065449"><span class="hs-identifier hs-var">makeMonic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a.
(Fractional a, Eq a, Num a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#gcdPoly"><span class="hs-identifier hs-var">gcdPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065448"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
</span><a href="#local-6989586621679065450"><span class="hs-identifier hs-var">polyRemainder</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065447"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065448"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-649"></span><span>    </span><span class="annot"><a href="#local-6989586621679065449"><span class="hs-identifier hs-type">makeMonic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621679065449"><span class="annot"><span class="annottext">makeMonic :: Poly a -&gt; Poly a
</span><a href="#local-6989586621679065449"><span class="hs-identifier hs-var hs-var">makeMonic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679065451"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065451"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065451"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679065451"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>    </span><span class="annot"><a href="#local-6989586621679065450"><span class="hs-identifier hs-type">polyRemainder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064514"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-652"></span><span>    </span><span id="local-6989586621679065450"><span class="annot"><span class="annottext">polyRemainder :: Poly a -&gt; Poly a -&gt; Poly a
</span><a href="#local-6989586621679065450"><span class="hs-identifier hs-var hs-var">polyRemainder</span></a></span></span><span> </span><span id="local-6989586621679065452"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065452"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679065453"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065453"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; Poly a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
forall a.
(Fractional a, Eq a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
</span><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier hs-var">euclidianDivision</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065452"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065453"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span class="annot"><span class="hs-comment">{-|
We compute the square-free factorisation of a polynomial using Yun's algorithm.
Yun, David Y.Y. (1976). &quot;On square-free decomposition algorithms&quot;.
SYMSAC '76 Proceedings of the third ACM Symposium on Symbolic and Algebraic Computation.
Association for Computing Machinery. pp. 26&#8211;35. doi:10.1145/800205.806320. ISBN 978-1-4503-7790-4. S2CID 12861227.
https://dl.acm.org/doi/10.1145/800205.806320
G &lt;- gcd (P, P')
C1 &lt;- P / G
D1 &lt;- P' / G - C1'
until Ci = 1 do
    Pi &lt;- gcd (Ci, Di)
    Ci+1 &lt;- Ci/Pi
    Di+1 &lt;- Di / Ai - Ci+1'
-}</span></span><span>
</span><span id="line-668"></span><span id="local-6989586621679064511"><span class="annot"><a href="Numeric.Polynomial.Simple.html#squareFreeFactorisation"><span class="hs-identifier hs-type">squareFreeFactorisation</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-670"></span><span id="squareFreeFactorisation"><span class="annot"><span class="annottext">squareFreeFactorisation :: forall a. (Fractional a, Eq a, Num a, Ord a) =&gt; Poly a -&gt; [Poly a]
</span><a href="Numeric.Polynomial.Simple.html#squareFreeFactorisation"><span class="hs-identifier hs-var hs-var">squareFreeFactorisation</span></a></span></span><span> </span><span id="local-6989586621679065475"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-671"></span><span>    </span><span class="hs-comment">-- if p has degree &lt;= 1 it can have no factors but itself</span><span>
</span><span id="line-672"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; [Poly a]
forall {a}. (Fractional a, Ord a) =&gt; Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679065476"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065477"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065478"><span class="hs-identifier hs-var">d1</span></a></span><span>  </span><span>
</span><span id="line-673"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621679065479"><span class="annot"><span class="annottext">diffP :: Poly a
</span><a href="#local-6989586621679065479"><span class="hs-identifier hs-var hs-var">diffP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span id="local-6989586621679065480"><span class="annot"><span class="annottext">g0 :: Poly a
</span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var hs-var">g0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a.
(Fractional a, Eq a, Num a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#gcdPoly"><span class="hs-identifier hs-var">gcdPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065479"><span class="hs-identifier hs-var">diffP</span></a></span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621679065477"><span class="annot"><span class="annottext">c1 :: Poly a
</span><a href="#local-6989586621679065477"><span class="hs-identifier hs-var hs-var">c1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall {a}. (Fractional a, Ord a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="#local-6989586621679065481"><span class="hs-operator hs-var">`divide`</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var">g0</span></a></span><span>
</span><span id="line-677"></span><span>    </span><span id="local-6989586621679065478"><span class="annot"><span class="annottext">d1 :: Poly a
</span><a href="#local-6989586621679065478"><span class="hs-identifier hs-var hs-var">d1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065479"><span class="hs-identifier hs-var">diffP</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall {a}. (Fractional a, Ord a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="#local-6989586621679065481"><span class="hs-operator hs-var">`divide`</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var">g0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065477"><span class="hs-identifier hs-var">c1</span></a></span><span>
</span><span id="line-678"></span><span>    </span><span id="local-6989586621679065481"><span class="annot"><span class="annottext">divide :: Poly a -&gt; Poly a -&gt; Poly a
</span><a href="#local-6989586621679065481"><span class="hs-identifier hs-var hs-var">divide</span></a></span></span><span> </span><span id="local-6989586621679065491"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065491"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679065492"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065492"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; Poly a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
forall a.
(Fractional a, Eq a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; (Poly a, Poly a)
</span><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier hs-var">euclidianDivision</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065491"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065492"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621679065476"><span class="annot"><span class="annottext">go :: Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679065476"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679065518"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065518"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679065519"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065519"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-680"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065518"><span class="hs-identifier hs-var">c</span></a></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- terminate the recursion</span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065520"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679065476"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065521"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065522"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="hs-comment">-- skip over constant polynomials</span><span>
</span><span id="line-682"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065520"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [Poly a] -&gt; [Poly a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679065476"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065521"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065522"><span class="hs-identifier hs-var">d'</span></a></span><span>
</span><span id="line-683"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-684"></span><span>        </span><span id="local-6989586621679065520"><span class="annot"><span class="annottext">a' :: Poly a
</span><a href="#local-6989586621679065520"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a.
(Fractional a, Eq a, Num a, Ord a) =&gt;
Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#gcdPoly"><span class="hs-identifier hs-var">gcdPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065518"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065519"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-685"></span><span>        </span><span id="local-6989586621679065521"><span class="annot"><span class="annottext">c' :: Poly a
</span><a href="#local-6989586621679065521"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065518"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall {a}. (Fractional a, Ord a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="#local-6989586621679065481"><span class="hs-operator hs-var">`divide`</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065520"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-686"></span><span>        </span><span id="local-6989586621679065522"><span class="annot"><span class="annottext">d' :: Poly a
</span><a href="#local-6989586621679065522"><span class="hs-identifier hs-var hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065519"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall {a}. (Fractional a, Ord a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="#local-6989586621679065481"><span class="hs-operator hs-var">`divide`</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065520"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679065521"><span class="hs-identifier hs-var">c'</span></a></span><span>
</span><span id="line-687"></span></pre></body></html>