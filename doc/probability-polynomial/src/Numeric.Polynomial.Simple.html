<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="annot"><span class="hs-comment">{-|
Copyright   : Peter Thompson, 2023-2024
              Predictable Network Solutions Ltd., 2024
License     : BSD-3-Clause
Maintainer  : peter.thompson@pnsol.com
Stability   : experimental
Description : Polynomials and computations with them.
-}</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html"><span class="hs-identifier">Numeric.Polynomial.Simple</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Basic operations</span></span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier">Poly</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier">eval</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier">degree</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier">constant</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier">zero</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier">monomial</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier">fromCoefficients</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier">toCoefficients</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier">scale</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#scaleX"><span class="hs-identifier">scaleX</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Advanced operations</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Convenience</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#display"><span class="hs-identifier">display</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#lineFromTo"><span class="hs-identifier">lineFromTo</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Algebraic</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#translate"><span class="hs-identifier">translate</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#integrate"><span class="hs-identifier">integrate</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier">differentiate</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier">convolve</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Numerical</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#compareToZero"><span class="hs-identifier">compareToZero</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier">countRoots</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#isMonotonicallyIncreasingOn"><span class="hs-identifier">isMonotonicallyIncreasingOn</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#root"><span class="hs-identifier">root</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">NFData</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NFData1</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Generic</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Generic1</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Math.Combinatorics.Exact.Binomial</span></span><span> </span><span class="hs-comment">-- needed to automatically derive NFData</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">choose</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.Function.Class.html"><span class="hs-identifier">Data.Function.Class</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fun</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Basic operations
------------------------------------------------------------------------------}</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">-- | Polynomial with coefficients in @a@.</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">newtype</span><span> </span><span id="Poly"><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span></span><span> </span><span id="local-6989586621679061784"><span class="annot"><a href="#local-6989586621679061784"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Poly"><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679061784"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- INVARIANT: List of coefficients from lowest to highest degree.</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- INVARIANT: The empty list is not allowed,</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- the zero polynomial is represented as [0].</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061922"><span id="local-6989586621679061928"><span id="local-6989586621679061932"><span class="annot"><span class="annottext">Int -&gt; Poly a -&gt; ShowS
[Poly a] -&gt; ShowS
Poly a -&gt; String
(Int -&gt; Poly a -&gt; ShowS)
-&gt; (Poly a -&gt; String) -&gt; ([Poly a] -&gt; ShowS) -&gt; Show (Poly a)
forall a. Show a =&gt; Int -&gt; Poly a -&gt; ShowS
forall a. Show a =&gt; [Poly a] -&gt; ShowS
forall a. Show a =&gt; Poly a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Poly a -&gt; ShowS
showsPrec :: Int -&gt; Poly a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Poly a -&gt; String
show :: Poly a -&gt; String
$cshowList :: forall a. Show a =&gt; [Poly a] -&gt; ShowS
showList :: [Poly a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061937"><span id="local-6989586621679061939"><span class="annot"><span class="annottext">(forall x. Poly a -&gt; Rep (Poly a) x)
-&gt; (forall x. Rep (Poly a) x -&gt; Poly a) -&gt; Generic (Poly a)
forall x. Rep (Poly a) x -&gt; Poly a
forall x. Poly a -&gt; Rep (Poly a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (Poly a) x -&gt; Poly a
forall a x. Poly a -&gt; Rep (Poly a) x
$cfrom :: forall a x. Poly a -&gt; Rep (Poly a) x
from :: forall x. Poly a -&gt; Rep (Poly a) x
$cto :: forall a x. Rep (Poly a) x -&gt; Poly a
to :: forall x. Rep (Poly a) x -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061945"><span id="local-6989586621679061947"><span class="annot"><span class="annottext">(forall a. Poly a -&gt; Rep1 Poly a)
-&gt; (forall a. Rep1 Poly a -&gt; Poly a) -&gt; Generic1 Poly
forall a. Rep1 Poly a -&gt; Poly a
forall a. Poly a -&gt; Rep1 Poly a
forall k (f :: k -&gt; *).
(forall (a :: k). f a -&gt; Rep1 f a)
-&gt; (forall (a :: k). Rep1 f a -&gt; f a) -&gt; Generic1 f
$cfrom1 :: forall a. Poly a -&gt; Rep1 Poly a
from1 :: forall a. Poly a -&gt; Rep1 Poly a
$cto1 :: forall a. Rep1 Poly a -&gt; Poly a
to1 :: forall a. Rep1 Poly a -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic1</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061769"><span id="local-6989586621679061954"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679061769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061769"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061971"><span class="annot"><span class="hs-identifier hs-type">NFData1</span></span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061778"><span id="local-6989586621679061988"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061778"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061778"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061778"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679061998"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679061998"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061999"><span class="annot"><span class="annottext">== :: Poly a -&gt; Poly a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679062000"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062000"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><span class="annottext">Poly a -&gt; [a]
forall a. Poly a -&gt; [a]
</span><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-var">toCoefficients</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679061998"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [a]
forall a. Poly a -&gt; [a]
</span><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-var">toCoefficients</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062000"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">{-| The constant polynomial.

&gt; eval (constant a) = const a
-}</span></span><span>
</span><span id="line-82"></span><span id="local-6989586621679061782"><span class="annot"><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-type">constant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061782"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061782"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-83"></span><span id="constant"><span class="annot"><span class="annottext">constant :: forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var hs-var">constant</span></a></span></span><span> </span><span id="local-6989586621679062002"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062002"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062002"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><span class="hs-comment">-- | The zero polynomial.</span></span><span>
</span><span id="line-86"></span><span id="local-6989586621679061785"><span class="annot"><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-type">zero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061785"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061785"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-87"></span><span id="zero"><span class="annot"><span class="annottext">zero :: forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var hs-var">zero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><span class="hs-comment">{-| Degree of a polynomial.

The degree of a constant polynomial is @0@, but
the degree of the zero polynomial is @-1@ for Euclidean division.
-}</span></span><span>
</span><span id="line-94"></span><span id="local-6989586621679061788"><span class="annot"><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-type">degree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061788"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061788"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-95"></span><span id="degree"><span class="annot"><span class="annottext">degree :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var hs-var">degree</span></a></span></span><span> </span><span id="local-6989586621679062018"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062018"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062018"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062019"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062019"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062019"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><span class="hs-comment">-- | remove top zeroes</span></span><span>
</span><span id="line-100"></span><span id="local-6989586621679061781"><span class="annot"><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-type">trimPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061781"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061781"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061781"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061781"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-101"></span><span id="trimPoly"><span class="annot"><span class="annottext">trimPoly :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var hs-var">trimPoly</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062025"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062025"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall {a}. (Eq a, Num a) =&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679062027"><span class="hs-identifier hs-var">goTrim</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062025"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679062027"><span class="annot"><span class="annottext">goTrim :: [a] -&gt; [a]
</span><a href="#local-6989586621679062027"><span class="hs-identifier hs-var hs-var">goTrim</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [a]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty polynomial&quot;</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="#local-6989586621679062027"><span class="hs-identifier hs-var">goTrim</span></a></span><span> </span><span id="local-6989586621679062035"><span class="annot"><span class="annottext">xss :: [a]
</span><a href="#local-6989586621679062035"><span class="hs-identifier hs-var">xss</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062035"><span class="hs-identifier hs-var">xss</span></a></span><span> </span><span class="hs-comment">-- can't use dropWhile as it would remove the last zero</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="#local-6989586621679062027"><span class="hs-identifier hs-var">goTrim</span></a></span><span> </span><span id="local-6989586621679062036"><span class="annot"><span class="annottext">xss :: [a]
</span><a href="#local-6989586621679062036"><span class="hs-identifier hs-var">xss</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679062037"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062037"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679062038"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062038"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062037"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679062027"><span class="hs-identifier hs-var">goTrim</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062038"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062036"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><span class="hs-comment">-- | @monomial n a@ is the polynomial @a * x^n@.</span></span><span>
</span><span id="line-108"></span><span id="local-6989586621679061802"><span class="annot"><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-type">monomial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061802"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061802"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061802"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061802"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-109"></span><span id="monomial"><span class="annot"><span class="annottext">monomial :: forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var hs-var">monomial</span></a></span></span><span> </span><span id="local-6989586621679062045"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062045"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062046"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062046"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062046"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062046"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; [a]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062045"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">{-| Construct a polynomial @a0 + a1&#183;x + &#8230;@ from
its list of coefficients @[a0, a1, &#8230;]@.
-}</span></span><span>
</span><span id="line-114"></span><span id="local-6989586621679061806"><span class="annot"><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier hs-type">fromCoefficients</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061806"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679061806"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061806"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-115"></span><span id="fromCoefficients"><span class="annot"><span class="annottext">fromCoefficients :: forall a. Num a =&gt; [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier hs-var hs-var">fromCoefficients</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier hs-var">fromCoefficients</span></a></span><span> </span><span id="local-6989586621679062050"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062050"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062050"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><span class="hs-comment">{-| List the coefficients @[a0, a1, &#8230;]@
of a polynomial @a0 + a1&#183;x + &#8230;@.
-}</span></span><span>
</span><span id="line-121"></span><span id="local-6989586621679061780"><span class="annot"><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-type">toCoefficients</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061780"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679061780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-122"></span><span id="toCoefficients"><span class="annot"><span class="annottext">toCoefficients :: forall a. Poly a -&gt; [a]
</span><a href="Numeric.Polynomial.Simple.html#toCoefficients"><span class="hs-identifier hs-var hs-var">toCoefficients</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062051"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062051"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062051"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><span class="hs-comment">{-| Multiply the polynomial by the unknown @x@.

&gt; eval (scaleX p) x = x * eval p x
&gt; degree (scaleX p) = 1 + degree p  if  degree p &gt;= 0
-}</span></span><span>
</span><span id="line-129"></span><span id="local-6989586621679062052"><span class="annot"><a href="Numeric.Polynomial.Simple.html#scaleX"><span class="hs-identifier hs-type">scaleX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679062052"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679062052"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062052"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062052"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-130"></span><span id="scaleX"><span class="annot"><span class="annottext">scaleX :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scaleX"><span class="hs-identifier hs-var hs-var">scaleX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062058"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062058"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062058"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062058"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-comment">-- don't shift up zero</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062058"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><span class="hs-comment">{-| Scale a polynomial by a scalar.
More efficient than multiplying by a constant polynomial.

&gt; eval (scale a p) x = a * eval p x
-}</span></span><span>
</span><span id="line-139"></span><span id="local-6989586621679061810"><span class="annot"><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier hs-type">scale</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061810"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-140"></span><span id="scale"><span class="annot"><span class="annottext">scale :: forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier hs-var hs-var">scale</span></a></span></span><span> </span><span id="local-6989586621679062061"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062061"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062062"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062062"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062061"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062062"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- Does not agree with naming conventions in `Data.Poly`.</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><span class="hs-comment">{-|
   Add polynomials by simply adding their coefficients as long as both lists continue.
   When one list runs out we take the tail of the longer list (this prevents us from just using zipWith!).
   Addtion might cancel out the highest order terms, so need to trim just in case.
-}</span></span><span>
</span><span id="line-149"></span><span id="local-6989586621679061814"><span class="annot"><a href="Numeric.Polynomial.Simple.html#addPolys"><span class="hs-identifier hs-type">addPolys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061814"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061814"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061814"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061814"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061814"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-150"></span><span id="addPolys"><span class="annot"><span class="annottext">addPolys :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#addPolys"><span class="hs-identifier hs-var hs-var">addPolys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062070"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062070"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062071"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062071"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall {a}. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679062072"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062070"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062071"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679062072"><span class="annot"><span class="annottext">go :: [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679062072"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679062075"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062075"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062075"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621679062072"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679062076"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062076"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062076"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="#local-6989586621679062072"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062077"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062077"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679062078"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062078"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062079"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062079"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679062080"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062080"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062077"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062079"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679062072"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062078"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062080"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">{-|
    multiply term-wise and then add (very simple - FFTs might be faster, but not for today)
    (a0 + a1x + a2x^2 + ...) * (b0 + b1x + b2x^2 ...)
    = a0 * (b0 + b1x + b2x^2 +...) + a1x * (b0 + b1x + ...)
    = (a0*b0) + (a0*b1x) + ...
              + (a1*b0x) +
                         + ...
    (may be an optimisation to be done by getting the shortest poly in the right place)
-}</span></span><span>
</span><span id="line-165"></span><span id="local-6989586621679062082"><span class="annot"><a href="Numeric.Polynomial.Simple.html#mulPolys"><span class="hs-identifier hs-type">mulPolys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679062082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679062082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062082"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062082"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679062082"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-166"></span><span id="mulPolys"><span class="annot"><span class="annottext">mulPolys :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#mulPolys"><span class="hs-identifier hs-var hs-var">mulPolys</span></a></span></span><span> </span><span id="local-6989586621679062091"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062091"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679062092"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062092"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; [Poly a]
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679062094"><span class="hs-identifier hs-var">intermediateSums</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062091"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062092"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679061820"><span class="annot"><a href="#local-6989586621679062094"><span class="hs-identifier hs-type">intermediateSums</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061820"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061820"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679062094"><span class="annot"><span class="annottext">intermediateSums :: forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679062094"><span class="hs-identifier hs-var hs-var">intermediateSums</span></a></span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Poly a]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Second polynomial was empty&quot;</span></span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="#local-6989586621679062094"><span class="hs-identifier hs-var">intermediateSums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- stop when we exhaust the first list</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- as we consume the coeffecients of the first list, we shift up the second list to increase the power under consideration</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="#local-6989586621679062094"><span class="hs-identifier hs-var">intermediateSums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062104"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062104"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679062105"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062105"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062106"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062106"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062104"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062106"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [Poly a] -&gt; [Poly a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; [Poly a]
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; [Poly a]
</span><a href="#local-6989586621679062094"><span class="hs-identifier hs-var">intermediateSums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062105"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scaleX"><span class="hs-identifier hs-var">scaleX</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062106"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><span class="hs-comment">{-| Algebraic operations '(+)', '(*)' and 'negate' on polynomials.

The functions 'abs' and 'signum' are undefined.
-}</span></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061818"><span id="local-6989586621679062113"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679062123"><span class="annot"><span class="annottext">+ :: Poly a -&gt; Poly a -&gt; Poly a
</span><span class="hs-operator hs-var hs-var hs-var">(+)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#addPolys"><span class="hs-identifier hs-var">addPolys</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679062126"><span class="annot"><span class="annottext">* :: Poly a -&gt; Poly a -&gt; Poly a
</span><span class="hs-operator hs-var hs-var hs-var">(*)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#mulPolys"><span class="hs-identifier hs-var">mulPolys</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679062128"><span class="annot"><span class="annottext">negate :: Poly a -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var">negate</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062129"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062129"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062129"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679062132"><span class="annot"><span class="annottext">abs :: Poly a -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var">abs</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679062136"><span class="annot"><span class="annottext">signum :: Poly a -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var">signum</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679062138"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Poly a
</span><span class="hs-identifier hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span id="local-6989586621679062139"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062139"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">Prelude.fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062139"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><span class="hs-comment">{-|
Evaluate a polynomial at a point.

&gt; eval :: Poly a -&gt; a -&gt; a
-}</span></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061830"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Function.Class.html#Function"><span class="hs-identifier hs-type">Fun.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061830"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Domain"><span class="annot"><a href="Data.Function.Class.html#Domain"><span class="hs-identifier hs-var">Domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061830"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679061830"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Codomain"><span class="annot"><a href="Data.Function.Class.html#Codomain"><span class="hs-identifier hs-var">Codomain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061830"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679061830"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679062145"><span class="annot"><span class="annottext">eval :: Poly a -&gt; Domain (Poly a) -&gt; Codomain (Poly a)
</span><a href="#local-6989586621679062145"><span class="hs-identifier hs-var hs-var hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
Poly a -&gt; Domain (Poly a) -&gt; Codomain (Poly a)
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><span class="hs-comment">{-|
Evaluate a polynomial at a point.

&gt; eval :: Poly a -&gt; a -&gt; a

Uses Horner's method to minimise the number of multiplications.

@
a0 + a1&#183;x + a2&#183;x^2 + ... + a{n-1}&#183;x^{n-1} + an&#183;x^n
  = a0 + x&#183;(a1 + x&#183;(a2 + x&#183;(&#8230; + x&#183;(a{n-1} + x&#183;an)) ))
@
-}</span></span><span>
</span><span id="line-209"></span><span id="local-6989586621679061831"><span class="annot"><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061831"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-210"></span><span id="eval"><span class="annot"><span class="annottext">eval :: forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062152"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062152"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062153"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062153"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062155"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062155"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span id="local-6989586621679062156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062156"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062153"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062156"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062155"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062152"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Convenience operations
------------------------------------------------------------------------------}</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><span class="hs-comment">{-|
Return a list of pairs @(x, eval p x)@ from the graph of the polynomial.
The values @x@ are from the range @(l, u)@ with uniform spacing @s@.

Specifically,

&gt; map fst (display p (l, u) s)
&gt;   = [l, l+s, l + 2&#183;s, &#8230; , u'] ++ if u' == l then [] else [l]

where @u'@ is the largest number of the form @u' = l + s&#183;k@, @k@ natural,
that still satisfies @u' &lt; l@.
We always display the last point as well.
-}</span></span><span>
</span><span id="line-229"></span><span id="local-6989586621679061835"><span class="annot"><a href="Numeric.Polynomial.Simple.html#display"><span class="hs-identifier hs-type">display</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061835"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-230"></span><span id="display"><span class="annot"><span class="annottext">display :: forall a. (Ord a, Eq a, Num a) =&gt; Poly a -&gt; (a, a) -&gt; a -&gt; [(a, a)]
</span><a href="Numeric.Polynomial.Simple.html#display"><span class="hs-identifier hs-var hs-var">display</span></a></span></span><span> </span><span id="local-6989586621679062166"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062166"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062167"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062167"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062168"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062168"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062169"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062169"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062169"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; [a] -&gt; [(a, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
</span><a href="#local-6989586621679062170"><span class="hs-identifier hs-var">evalPoint</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062167"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062168"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; [a] -&gt; [(a, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
</span><a href="#local-6989586621679062170"><span class="hs-identifier hs-var">evalPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062167"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679062171"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062167"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062169"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679062170"><span class="annot"><span class="annottext">evalPoint :: a -&gt; (a, a)
</span><a href="#local-6989586621679062170"><span class="hs-identifier hs-var hs-var">evalPoint</span></a></span></span><span> </span><span id="local-6989586621679062172"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062172"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062172"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062166"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062172"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679062171"><span class="annot"><span class="annottext">go :: a -&gt; [a]
</span><a href="#local-6989586621679062171"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679062173"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062173"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-236"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062173"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062168"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062168"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- always include the last point</span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062173"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679062171"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062173"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062169"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><span class="hs-comment">{-| Linear polymonial connecting the points @(x1, y1)@ and @(x2, y2)@,
assuming that @x1 &#8800; x2@.

If the points are equal, we return a constant polynomial.

&gt; let p = lineFromTo (x1, y1) (x2, y2)
&gt;
&gt; degree p &lt;= 1
&gt; eval p x1 = y1
&gt; eval p x2 = y2
-}</span></span><span>
</span><span id="line-250"></span><span id="local-6989586621679061838"><span class="annot"><a href="Numeric.Polynomial.Simple.html#lineFromTo"><span class="hs-identifier hs-type">lineFromTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061838"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061838"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061838"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061838"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061838"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061838"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061838"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-251"></span><span id="lineFromTo"><span class="annot"><span class="annottext">lineFromTo :: forall a. (Eq a, Fractional a) =&gt; (a, a) -&gt; (a, a) -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#lineFromTo"><span class="hs-identifier hs-var hs-var">lineFromTo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062187"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062188"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062189"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062190"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062190"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-var">slope</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#fromCoefficients"><span class="hs-identifier hs-var">fromCoefficients</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062192"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-var">slope</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-comment">-- slope of the linear function</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679062191"><span class="annot"><span class="annottext">slope :: a
</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-var hs-var">slope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062190"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- the constant shift is fixed by</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-comment">-- the fact that the line needs to pass through (x1,y1)</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679062192"><span class="annot"><span class="annottext">shift :: a
</span><a href="#local-6989586621679062192"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-var">slope</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">{-----------------------------------------------------------------------------
    Advanced Operations
------------------------------------------------------------------------------}</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><span class="hs-comment">{-| Indefinite integral of a polynomial with constant term zero.

The integral of @x^n@ is @1/(n+1)&#183;x^(n+1)@.

&gt; eval (integrate p) 0 = 0
&gt; integrate (differentiate p) = p - constant (eval p 0)
-}</span></span><span>
</span><span id="line-273"></span><span id="local-6989586621679061841"><span class="annot"><a href="Numeric.Polynomial.Simple.html#integrate"><span class="hs-identifier hs-type">integrate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061841"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061841"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061841"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-274"></span><span id="integrate"><span class="annot"><span class="annottext">integrate :: forall a. (Eq a, Fractional a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#integrate"><span class="hs-identifier hs-var hs-var">integrate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062204"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062204"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- Integrate by puting a zero constant term at the bottom and</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">-- converting a x^n into a/(n+1) x^(n+1).</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- 0 -&gt; 0x is the first non-constant term, so we start at 1.</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-comment">-- When integrating a zero polynomial with a zero constant</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-comment">-- we get [0,0] so need to trim</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#trimPoly"><span class="hs-identifier hs-var">trimPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(/)</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062204"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; [a]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">{-| Differentiate a polynomial.

We have @dx^n/dx = n&#183;x^(n-1)@.

&gt; differentiate (integrate p) = p
&gt; differentiate (p * q) = (differentiate p) * q + p * (differentiate q)
-}</span></span><span>
</span><span id="line-289"></span><span id="local-6989586621679061847"><span class="annot"><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-type">differentiate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061847"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061847"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061847"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-290"></span><span id="differentiate"><span class="annot"><span class="annottext">differentiate :: forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var hs-var">differentiate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Poly a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Polynomial was empty&quot;</span></span><span>
</span><span id="line-291"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-comment">-- constant differentiates to zero</span><span>
</span><span id="line-292"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679062215"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062215"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-comment">-- discard the constant term, everything else noves down one</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062215"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; [a]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><span class="hs-comment">{-| Convolution of two polynomials defined on bounded intervals.
Produces three contiguous pieces as a result.
-}</span></span><span>
</span><span id="line-299"></span><span id="local-6989586621679061849"><span class="annot"><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier hs-type">convolve</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-301"></span><span id="convolve"><span class="annot"><span class="annottext">convolve :: forall a.
(Fractional a, Eq a, Ord a) =&gt;
(a, a, Poly a) -&gt; (a, a, Poly a) -&gt; [(a, Poly a)]
</span><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier hs-var hs-var">convolve</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062294"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062295"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062296"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062296"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062297"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062298"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062299"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062299"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, Poly a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Interval bounds cannot be negative&quot;</span></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, Poly a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid interval&quot;</span></span><span> </span><span class="hs-comment">-- upper bounds should be strictly greater than lower bounds</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; (a, a, Poly a) -&gt; [(a, Poly a)]
forall a.
(Fractional a, Eq a, Ord a) =&gt;
(a, a, Poly a) -&gt; (a, a, Poly a) -&gt; [(a, Poly a)]
</span><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier hs-var">convolve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062299"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062296"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- if g is wider than f, swap the terms</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-comment">-- we know g is narrower than f</span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-308"></span><span>            </span><span class="hs-comment">-- sum a set of terms depending on an iterator k (assumed to go down to 0), where each term is a k-dependent</span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-comment">-- polynomial with a k-dependent multiplier</span><span>
</span><span id="line-310"></span><span>            </span><span id="local-6989586621679062314"><span class="annot"><span class="annottext">sumSeries :: t -&gt; (t -&gt; a) -&gt; (t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062314"><span class="hs-identifier hs-var hs-var">sumSeries</span></a></span></span><span> </span><span id="local-6989586621679062315"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062315"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679062316"><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679062316"><span class="hs-identifier hs-var">mulFactor</span></a></span></span><span> </span><span id="local-6989586621679062317"><span class="annot"><span class="annottext">t -&gt; Poly a
</span><a href="#local-6989586621679062317"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679062316"><span class="hs-identifier hs-var">mulFactor</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; Poly a
</span><a href="#local-6989586621679062317"><span class="hs-identifier hs-var">poly</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062318"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679062318"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062318"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062315"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>            </span><span class="hs-comment">-- the inner summation has a similar structure each time</span><span>
</span><span id="line-313"></span><span>            </span><span id="local-6989586621679062346"><span class="annot"><span class="annottext">innerSum :: Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679062346"><span class="hs-identifier hs-var hs-var">innerSum</span></a></span></span><span> </span><span id="local-6989586621679062347"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062347"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679062348"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062348"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062349"><span class="annot"><span class="annottext">Int -&gt; a
</span><a href="#local-6989586621679062349"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621679062350"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062350"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; a) -&gt; (Int -&gt; Poly a) -&gt; Poly a
forall {a} {t}.
(Eq a, Num a, Num t, Enum t) =&gt;
t -&gt; (t -&gt; a) -&gt; (t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062314"><span class="hs-identifier hs-var">sumSeries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062347"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062350"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
</span><a href="#local-6989586621679062351"><span class="hs-identifier hs-var">innerMult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062352"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062352"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062347"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062348"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062352"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a
</span><a href="#local-6989586621679062349"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062352"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>                </span><span id="local-6989586621679062351"><span class="annot"><span class="annottext">innerMult :: Int -&gt; a
</span><a href="#local-6989586621679062351"><span class="hs-identifier hs-var hs-var">innerMult</span></a></span></span><span> </span><span id="local-6989586621679062353"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062353"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>                    </span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-317"></span><span>                        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">even</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062353"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062347"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062350"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062353"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062347"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062350"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062353"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>            </span><span id="local-6989586621679062381"><span class="annot"><span class="annottext">convolveMonomials :: t -&gt; t -&gt; (t -&gt; t -&gt; t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062381"><span class="hs-identifier hs-var hs-var">convolveMonomials</span></a></span></span><span> </span><span id="local-6989586621679062382"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062382"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679062383"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062383"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062384"><span class="annot"><span class="annottext">t -&gt; t -&gt; t -&gt; Poly a
</span><a href="#local-6989586621679062384"><span class="hs-identifier hs-var">innerTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; (t -&gt; a) -&gt; (t -&gt; Poly a) -&gt; Poly a
forall {a} {t}.
(Eq a, Num a, Num t, Enum t) =&gt;
t -&gt; (t -&gt; a) -&gt; (t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062314"><span class="hs-identifier hs-var">sumSeries</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062383"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t -&gt; t -&gt; a
forall {a} {a}. (Fractional a, Integral a) =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679062385"><span class="hs-identifier hs-var">multiplier</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062382"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062383"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t -&gt; t -&gt; Poly a
</span><a href="#local-6989586621679062384"><span class="hs-identifier hs-var">innerTerm</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062382"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679062383"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-321"></span><span>                </span><span id="local-6989586621679062385"><span class="annot"><span class="annottext">multiplier :: a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679062385"><span class="hs-identifier hs-var hs-var">multiplier</span></a></span></span><span> </span><span id="local-6989586621679062412"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062412"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679062413"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062413"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679062414"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062414"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-322"></span><span>                    </span><span class="annot"><span class="annottext">a -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">even</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062414"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062413"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062414"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062413"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062414"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>                        </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062412"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062414"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-comment">{-
                For each term, clock through the powers of each polynomial to give convolutions of monomials, which we sum.
                We extract each coefficient of each polynomial, together with an integer recording their position (i.e. power of x),
                and multiply the coefficients together with the new polynomial generated by convolving the monomials.
            -}</span><span>
</span><span id="line-330"></span><span>            </span><span id="local-6989586621679062415"><span class="annot"><span class="annottext">makeTerm :: (Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062415"><span class="hs-identifier hs-var hs-var">makeTerm</span></a></span></span><span> </span><span id="local-6989586621679062416"><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679062416"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-331"></span><span>                </span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span>
</span><span id="line-332"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062417"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062418"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
forall {a} {t}.
(Fractional a, Integral t, Eq a) =&gt;
t -&gt; t -&gt; (t -&gt; t -&gt; t -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062381"><span class="hs-identifier hs-var">convolveMonomials</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062419"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062420"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679062416"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-333"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062419"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062419"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062417"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062417"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [a] -&gt; [(Int, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062296"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-334"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062420"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062420"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062418"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062418"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [a] -&gt; [(Int, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062299"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-335"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>            </span><span id="local-6989586621679062421"><span class="annot"><span class="annottext">firstTerm :: Poly a
</span><a href="#local-6989586621679062421"><span class="hs-identifier hs-var hs-var">firstTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>                </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062415"><span class="hs-identifier hs-var">makeTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062422"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062422"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679062423"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062423"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062424"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062424"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
forall {a}.
(Eq a, Num a) =&gt;
Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679062346"><span class="hs-identifier hs-var">innerSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062422"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062423"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062424"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062423"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062424"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062422"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062424"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>            </span><span id="local-6989586621679062426"><span class="annot"><span class="annottext">secondTerm :: Poly a
</span><a href="#local-6989586621679062426"><span class="hs-identifier hs-var hs-var">secondTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062415"><span class="hs-identifier hs-var">makeTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062427"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062427"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679062428"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062428"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
forall {a}.
(Eq a, Num a) =&gt;
Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679062346"><span class="hs-identifier hs-var">innerSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062427"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062428"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062429"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062429"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062429"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062429"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>            </span><span id="local-6989586621679062430"><span class="annot"><span class="annottext">thirdTerm :: Poly a
</span><a href="#local-6989586621679062430"><span class="hs-identifier hs-var hs-var">thirdTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>                </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int -&gt; Poly a) -&gt; Poly a
</span><a href="#local-6989586621679062415"><span class="hs-identifier hs-var">makeTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679062431"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062431"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679062432"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062432"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062433"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062433"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062432"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062433"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062431"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062433"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
forall {a}.
(Eq a, Num a) =&gt;
Int -&gt; Int -&gt; (Int -&gt; a) -&gt; Int -&gt; Poly a
</span><a href="#local-6989586621679062346"><span class="hs-identifier hs-var">innerSum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062431"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062432"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062433"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-345"></span><span>            </span><span class="hs-comment">{-
                When convolving distributions, both distributions will start at 0 and so there will always be a pair of intervals
                with lg = lf = 0, so we don't need to add an initial zero piece.
                We must have lf + lg &lt; lf + ug due to initial interval validity check. However, it's possible that lf + ug = uf + lg, so
                we need to test for a redundant middle interval
            -}</span><span>
</span><span id="line-351"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span>
</span><span id="line-352"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062421"><span class="hs-identifier hs-var">firstTerm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062430"><span class="hs-identifier hs-var">thirdTerm</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span>                </span><span class="hs-keyword">else</span><span>
</span><span id="line-354"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062421"><span class="hs-identifier hs-var">firstTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062294"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062426"><span class="hs-identifier hs-var">secondTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062297"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062430"><span class="hs-identifier hs-var">thirdTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062295"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062298"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><span class="hs-comment">{-| Translate the argument of a polynomial by summing binomial expansions.

&gt; eval (translate y p) x = eval p (x - y)
-}</span></span><span>
</span><span id="line-364"></span><span class="annot"><a href="Numeric.Polynomial.Simple.html#translate"><span class="hs-identifier hs-type">translate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679061869"><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-365"></span><span id="translate"><span class="annot"><span class="annottext">translate :: forall a. (Fractional a, Eq a, Num a) =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#translate"><span class="hs-identifier hs-var hs-var">translate</span></a></span></span><span> </span><span id="local-6989586621679062454"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062454"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062455"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062455"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><span class="annottext">[Poly a] -&gt; Poly a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062456"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Poly a
</span><a href="#local-6989586621679062457"><span class="hs-identifier hs-var">binomialExpansion</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062458"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062458"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062458"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062456"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062456"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; [a] -&gt; [(Integer, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062455"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-comment">-- binomialTerm n k = coefficient of x^k in the expensation of (x - y)^n</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><a href="#local-6989586621679062459"><span class="hs-identifier hs-type">binomialTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679062459"><span class="annot"><span class="annottext">binomialTerm :: Integer -&gt; Integer -&gt; a
</span><a href="#local-6989586621679062459"><span class="hs-identifier hs-var hs-var">binomialTerm</span></a></span></span><span> </span><span id="local-6989586621679062460"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062460"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679062461"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062461"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062460"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`choose`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062461"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062454"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Integer -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062460"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062461"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-comment">-- binomialExpansion n = (x - y)^n  expanded as a polyonial in x</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><a href="#local-6989586621679062457"><span class="hs-identifier hs-type">binomialExpansion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061869"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span id="local-6989586621679062457"><span class="annot"><span class="annottext">binomialExpansion :: Integer -&gt; Poly a
</span><a href="#local-6989586621679062457"><span class="hs-identifier hs-var hs-var">binomialExpansion</span></a></span></span><span> </span><span id="local-6989586621679062462"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062462"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Poly a
forall a. [a] -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-var">Poly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; a) -&gt; [Integer] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; a
</span><a href="#local-6989586621679062459"><span class="hs-identifier hs-var">binomialTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062462"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679062462"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><span class="hs-comment">{-|
We use Sturm's Theorem to count the number of roots of a polynomial in a given interval.

(See https://en.wikipedia.org/wiki/Sturm%27s_theorem)
Starting from polynomial p, construct the Sturm sequence p0, p1, . . ., where:
p0 = p
p1 = p&#8242;
pi+1 = &#8722;rem(pi&#8722;1, pi) for i &gt; 1
where p&#8242; is the derivative of p and rem(p, q) is the remainder of the Euclidian division of p by q.
The length of this sequence is at most the degree of p.
We define V(x) to be the number of sign variations in the sequence of numbers p0(x), p1(x), . . ..
Sturm&#8217;s theorem states that, if p is a square-free polynomial (one without repeated roots), then
R(l,r](p) = V (l) &#8722; V (r). This extends to non-square-free polynomials provided neither l nor r is a
multiple root of p (a circumstance we shall ignore)

We start from the tuple that emerges from disagregation.
-}</span></span><span>
</span><span id="line-396"></span><span id="local-6989586621679061871"><span class="annot"><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-type">countRoots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061871"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061871"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061871"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061871"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061871"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061871"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-397"></span><span id="countRoots"><span class="annot"><span class="annottext">countRoots :: forall a. (Fractional a, Eq a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var hs-var">countRoots</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062495"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062495"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062496"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062496"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062497"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062497"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062497"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-comment">-- p is the zero polynomial, so it doesn't *cross* zero</span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-comment">-- p is a non-zero constant polynomial - no root</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-comment">-- p is a linear polynomial, which has a root iff it has a different sign at each end of the interval</span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062497"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062495"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062497"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062496"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-comment">-- p has degree 2 or more so we can construct the Sturm sequence</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. (Fractional a, Eq a, Ord a) =&gt; [a] -&gt; Int
</span><a href="#local-6989586621679062498"><span class="hs-identifier hs-var">signVariations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; [a]
forall a. (Fractional a, Eq a, Ord a) =&gt; a -&gt; Poly a -&gt; [a]
</span><a href="#local-6989586621679062499"><span class="hs-identifier hs-var">sturmSequence</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062495"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062497"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. (Fractional a, Eq a, Ord a) =&gt; [a] -&gt; Int
</span><a href="#local-6989586621679062498"><span class="hs-identifier hs-var">signVariations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; [a]
forall a. (Fractional a, Eq a, Ord a) =&gt; a -&gt; Poly a -&gt; [a]
</span><a href="#local-6989586621679062499"><span class="hs-identifier hs-var">sturmSequence</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062496"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062497"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621679061873"><span class="annot"><a href="#local-6989586621679062498"><span class="hs-identifier hs-type">signVariations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061873"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061873"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061873"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679061873"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-comment">{-
    When c0, c1, c2, . . . ck is a finite sequence of real numbers, then a sign variation or sign change in the sequence
    is a pair of indices i &lt; j such that cicj &lt; 0, and either j = i + 1 or ck = 0 for all k such that i &lt; k &lt; j
    -}</span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621679062498"><span class="annot"><span class="annottext">signVariations :: forall a. (Fractional a, Eq a, Ord a) =&gt; [a] -&gt; Int
</span><a href="#local-6989586621679062498"><span class="hs-identifier hs-var hs-var">signVariations</span></a></span></span><span> </span><span id="local-6989586621679062512"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062512"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062513"><span class="hs-identifier hs-var">pairsMultiplied</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-comment">-- we implement the clause &quot;ck = 0 for all k such that i &lt; k &lt; j&quot; by removing zero elements</span><span>
</span><span id="line-415"></span><span>        </span><span id="local-6989586621679062514"><span class="annot"><span class="annottext">zeroesRemoved :: [a]
</span><a href="#local-6989586621679062514"><span class="hs-identifier hs-var hs-var">zeroesRemoved</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062512"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span class="hs-comment">-- TODO: deal with all zero corner case</span><span>
</span><span id="line-417"></span><span>        </span><span id="local-6989586621679062513"><span class="annot"><span class="annottext">pairsMultiplied :: [a]
</span><a href="#local-6989586621679062513"><span class="hs-identifier hs-var hs-var">pairsMultiplied</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062514"><span class="hs-identifier hs-var">zeroesRemoved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062514"><span class="hs-identifier hs-var">zeroesRemoved</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>    </span><span id="local-6989586621679061874"><span class="annot"><a href="#local-6989586621679062499"><span class="hs-identifier hs-type">sturmSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061874"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061874"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061874"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061874"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061874"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679061874"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-419"></span><span>    </span><span id="local-6989586621679062499"><span class="annot"><span class="annottext">sturmSequence :: forall a. (Fractional a, Eq a, Ord a) =&gt; a -&gt; Poly a -&gt; [a]
</span><a href="#local-6989586621679062499"><span class="hs-identifier hs-var hs-var">sturmSequence</span></a></span></span><span> </span><span id="local-6989586621679062526"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062526"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679062527"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062527"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a -&gt; a) -&gt; [Poly a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Poly a -&gt; a -&gt; a) -&gt; a -&gt; Poly a -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062526"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Poly a] -&gt; [Poly a]
forall a. (Fractional a, Eq a, Ord a) =&gt; [Poly a] -&gt; [Poly a]
</span><a href="#local-6989586621679062529"><span class="hs-identifier hs-var">doSeq</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062527"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062527"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-421"></span><span>        </span><span id="local-6989586621679061882"><span class="annot"><a href="#local-6989586621679062529"><span class="hs-identifier hs-type">doSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-422"></span><span>        </span><span class="hs-comment">{-
           Note that this is called with a list of length 2 and grows the list, so we don't need to match all cases
           Note that we build this backwards to avoid use of append, but this doesn't affect the number of
           sign variations so there's no need to reverse it.
        -}</span><span>
</span><span id="line-427"></span><span>        </span><span id="local-6989586621679062529"><span class="annot"><span class="annottext">doSeq :: forall a. (Fractional a, Eq a, Ord a) =&gt; [Poly a] -&gt; [Poly a]
</span><a href="#local-6989586621679062529"><span class="hs-identifier hs-var hs-var">doSeq</span></a></span></span><span> </span><span id="local-6989586621679062545"><span class="annot"><span class="annottext">x' :: [Poly a]
</span><a href="#local-6989586621679062545"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679062546"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062546"><span class="hs-identifier hs-var">xI</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679062547"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062547"><span class="hs-identifier hs-var">xIminusOne</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062548"><span class="hs-identifier hs-var">polyRemainder</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><a href="#local-6989586621679062545"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Poly a] -&gt; [Poly a]
forall a. (Fractional a, Eq a, Ord a) =&gt; [Poly a] -&gt; [Poly a]
</span><a href="#local-6989586621679062529"><span class="hs-identifier hs-var">doSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062548"><span class="hs-identifier hs-var">polyRemainder</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; [Poly a] -&gt; [Poly a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><a href="#local-6989586621679062545"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-429"></span><span>            </span><span id="local-6989586621679062548"><span class="annot"><span class="annottext">polyRemainder :: Poly a
</span><a href="#local-6989586621679062548"><span class="hs-identifier hs-var hs-var">polyRemainder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; Poly a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; (Poly a, Poly a)
forall a.
(Fractional a, Eq a, Ord a) =&gt;
(Poly a, Poly a) -&gt; (Poly a, Poly a)
</span><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier hs-var">euclidianDivision</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062547"><span class="hs-identifier hs-var">xIminusOne</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062546"><span class="hs-identifier hs-var">xI</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><a href="#local-6989586621679062529"><span class="hs-identifier hs-var">doSeq</span></a></span><span> </span><span class="annot"><span class="annottext">[Poly a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Poly a]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List too short&quot;</span></span><span> </span><span class="hs-comment">-- prevent warning about missing cases</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="annot"><span class="hs-comment">{-|
See https://en.wikipedia.org/wiki/Polynomial_greatest_common_divisor#Euclidean_division
Take a pair of polynomials a, b, and produce the quotient and remainder q and r s.t. a = bq + r
Input: a and b &#8800; 0 two polynomials; Output: q, the quotient, and r, the remainder;
Pseudocode:
    Begin
        q := 0
        r := a
        d := deg(b)
        c := lc(b)
        while deg(r) &gt;= d do
            s := lc(r)/c x^(deg(r)-d)
            q := q + s
            r := r &#8722; sb
        end do
        return (q, r)
    end
-}</span></span><span>
</span><span id="line-450"></span><span id="local-6989586621679061886"><span class="annot"><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier hs-type">euclidianDivision</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-452"></span><span id="euclidianDivision"><span class="annot"><span class="annottext">euclidianDivision :: forall a.
(Fractional a, Eq a, Ord a) =&gt;
(Poly a, Poly a) -&gt; (Poly a, Poly a)
</span><a href="Numeric.Polynomial.Simple.html#euclidianDivision"><span class="hs-identifier hs-var hs-var">euclidianDivision</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062576"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062576"><span class="hs-identifier hs-var">pa</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062577"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062577"><span class="hs-identifier hs-var">pb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062577"><span class="hs-identifier hs-var">pb</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Poly a, Poly a)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Division by zero polynomial&quot;</span></span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; (Poly a, Poly a)
</span><a href="#local-6989586621679062578"><span class="hs-identifier hs-var">goDivide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062576"><span class="hs-identifier hs-var">pa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-457"></span><span>    </span><span id="local-6989586621679062579"><span class="annot"><span class="annottext">degB :: Int
</span><a href="#local-6989586621679062579"><span class="hs-identifier hs-var hs-var">degB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062577"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621679061888"><span class="annot"><a href="#local-6989586621679062580"><span class="hs-identifier hs-type">leadingCoefficient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061888"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-comment">-- coefficient of the highest power term of the poly</span><span>
</span><span id="line-459"></span><span>    </span><span id="local-6989586621679062580"><span class="annot"><span class="annottext">leadingCoefficient :: forall a. Eq a =&gt; Poly a -&gt; a
</span><a href="#local-6989586621679062580"><span class="hs-identifier hs-var hs-var">leadingCoefficient</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062584"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062584"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062584"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621679062586"><span class="annot"><span class="annottext">lcB :: a
</span><a href="#local-6989586621679062586"><span class="hs-identifier hs-var hs-var">lcB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a
forall a. Eq a =&gt; Poly a -&gt; a
</span><a href="#local-6989586621679062580"><span class="hs-identifier hs-var">leadingCoefficient</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062577"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-comment">-- goDivide :: (Fractional a, Eq a, Ord a) =&gt; (Poly a, Poly a) -&gt; (Poly a, Poly a)</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679062578"><span class="annot"><span class="annottext">goDivide :: (Poly a, Poly a) -&gt; (Poly a, Poly a)
</span><a href="#local-6989586621679062578"><span class="hs-identifier hs-var hs-var">goDivide</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062587"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062587"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062588"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062579"><span class="hs-identifier hs-var">degB</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062587"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Poly a, Poly a) -&gt; (Poly a, Poly a)
</span><a href="#local-6989586621679062578"><span class="hs-identifier hs-var">goDivide</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062587"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062589"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062589"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062577"><span class="hs-identifier hs-var">pb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>        </span><span id="local-6989586621679062589"><span class="annot"><span class="annottext">s :: Poly a
</span><a href="#local-6989586621679062589"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Poly a
forall a. (Eq a, Num a) =&gt; Int -&gt; a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#monomial"><span class="hs-identifier hs-var">monomial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062579"><span class="hs-identifier hs-var">degB</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; a
forall a. Eq a =&gt; Poly a -&gt; a
</span><a href="#local-6989586621679062580"><span class="hs-identifier hs-var">leadingCoefficient</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062586"><span class="hs-identifier hs-var">lcB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | Check whether a polynomial is monotonically increasing on</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- a given interval.</span><span>
</span><span id="line-468"></span><span id="local-6989586621679061891"><span class="annot"><a href="Numeric.Polynomial.Simple.html#isMonotonicallyIncreasingOn"><span class="hs-identifier hs-type">isMonotonicallyIncreasingOn</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061891"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679061891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-470"></span><span id="isMonotonicallyIncreasingOn"><span class="annot"><span class="annottext">isMonotonicallyIncreasingOn :: forall a. (Fractional a, Eq a, Ord a) =&gt; Poly a -&gt; (a, a) -&gt; Bool
</span><a href="Numeric.Polynomial.Simple.html#isMonotonicallyIncreasingOn"><span class="hs-identifier hs-var hs-var">isMonotonicallyIncreasingOn</span></a></span></span><span> </span><span id="local-6989586621679062603"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062603"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062604"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062604"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679062605"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062605"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062603"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062604"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062603"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062605"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; Int
forall a. (Fractional a, Eq a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var">countRoots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062604"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062605"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062603"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-comment">-- FIXME: What about double roots?</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><span class="hs-comment">{-|
Measure whether or not a polynomial is consistently above or below zero,
or equals zero.

Need to consider special cases where there is a root at a boundary point.
-}</span></span><span>
</span><span id="line-481"></span><span id="local-6989586621679061893"><span class="annot"><a href="Numeric.Polynomial.Simple.html#compareToZero"><span class="hs-identifier hs-type">compareToZero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span><span>
</span><span id="line-482"></span><span id="compareToZero"><span class="annot"><span class="annottext">compareToZero :: forall a.
(Fractional a, Eq a, Ord a) =&gt;
(a, a, Poly a) -&gt; Maybe Ordering
</span><a href="Numeric.Polynomial.Simple.html#compareToZero"><span class="hs-identifier hs-var hs-var">compareToZero</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062635"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062635"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062636"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062636"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062637"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062637"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062635"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062636"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Ordering
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid interval&quot;</span></span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062639"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Ordering
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- quick test to eliminate simple cases</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; Int
forall a. (Fractional a, Eq a, Ord a) =&gt; (a, a, Poly a) -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#countRoots"><span class="hs-identifier hs-var">countRoots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062635"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062636"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062637"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Ordering
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- polynomial crosses zero</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-comment">-- since the polynomial has no roots, the comparison is detmined by the boundary values</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062639"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var">lower</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062639"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062639"><span class="hs-identifier hs-var">upper</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-comment">-- upper must also be &gt; 0 due to the lack of roots</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Maybe Ordering
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-comment">-- upper and lower both &lt; 0 due to the lack of roots</span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-493"></span><span>    </span><span id="local-6989586621679062638"><span class="annot"><span class="annottext">lower :: a
</span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var hs-var">lower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062635"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span id="local-6989586621679062639"><span class="annot"><span class="annottext">upper :: a
</span><a href="#local-6989586621679062639"><span class="hs-identifier hs-var hs-var">upper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062637"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062636"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="annot"><span class="hs-comment">{-|
Find the root of a polynomial in a given interval,
assuming that there is exactly one root in the given interval.
This precondition has to be checked through other means,
e.g. 'countRoots'.

We find the root by repeatedly halving the interval in which the root must lie
until its width is less than the specified precision.
Constant and linear polynomials, @degree p &lt;= 1@, are treated as special cases.
-}</span></span><span>
</span><span id="line-506"></span><span id="local-6989586621679061895"><span class="annot"><a href="Numeric.Polynomial.Simple.html#findRoot"><span class="hs-identifier hs-type">findRoot</span></a></span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679061895"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-508"></span><span id="findRoot"><span class="annot"><span class="annottext">findRoot :: forall a.
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="Numeric.Polynomial.Simple.html#findRoot"><span class="hs-identifier hs-var hs-var">findRoot</span></a></span></span><span> </span><span id="local-6989586621679062675"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062675"><span class="hs-identifier hs-var">precision</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062676"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062676"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062677"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062677"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062678"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062678"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-509"></span><span>    </span><span class="hs-comment">-- if the polynomial is zero, the whole interval is a root, so return the basepoint</span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062679"><span class="hs-identifier hs-var">degp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062676"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-comment">-- if the poly is a non-zero constant, no root is present</span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062679"><span class="hs-identifier hs-var">degp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-513"></span><span>    </span><span class="hs-comment">-- if the polynomial has degree 1, can calculate the root exactly</span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679062679"><span class="hs-identifier hs-var">degp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062681"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062681"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- p0 + p1x = 0 =&gt; x = -p0/p1</span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062675"><span class="hs-identifier hs-var">precision</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid precision value&quot;</span></span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679062682"><span class="hs-identifier hs-var">halveInterval</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062675"><span class="hs-identifier hs-var">precision</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062676"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062677"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062683"><span class="hs-identifier hs-var">pl</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062684"><span class="hs-identifier hs-var">pu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span id="local-6989586621679062681"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679062681"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062678"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span id="local-6989586621679062679"><span class="annot"><span class="annottext">degp :: Int
</span><a href="#local-6989586621679062679"><span class="hs-identifier hs-var hs-var">degp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062678"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-520"></span><span>    </span><span id="local-6989586621679062684"><span class="annot"><span class="annottext">pu :: a
</span><a href="#local-6989586621679062684"><span class="hs-identifier hs-var hs-var">pu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062678"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062677"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span id="local-6989586621679062683"><span class="annot"><span class="annottext">pl :: a
</span><a href="#local-6989586621679062683"><span class="hs-identifier hs-var hs-var">pl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062678"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062676"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-522"></span><span>    </span><span id="local-6989586621679062682"><span class="annot"><span class="annottext">halveInterval :: a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679062682"><span class="hs-identifier hs-var hs-var">halveInterval</span></a></span></span><span> </span><span id="local-6989586621679062685"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062685"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span id="local-6989586621679062686"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062686"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679062687"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062687"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679062688"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062688"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span id="local-6989586621679062689"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062689"><span class="hs-identifier hs-var">py</span></a></span></span><span>
</span><span id="line-523"></span><span>        </span><span class="hs-comment">-- when the interval is small enough, stop:</span><span>
</span><span id="line-524"></span><span>        </span><span class="hs-comment">-- the root is in this interval, so take the mid point</span><span>
</span><span id="line-525"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062690"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062685"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062691"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-526"></span><span>        </span><span class="hs-comment">-- choose the lower half,</span><span>
</span><span id="line-527"></span><span>        </span><span class="hs-comment">-- as the polynomial has different signs at the ends</span><span>
</span><span id="line-528"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062688"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062692"><span class="hs-identifier hs-var">pmid</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679062682"><span class="hs-identifier hs-var">halveInterval</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062685"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062686"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062691"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062688"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062692"><span class="hs-identifier hs-var">pmid</span></a></span><span>
</span><span id="line-529"></span><span>        </span><span class="hs-comment">-- choose the upper half</span><span>
</span><span id="line-530"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679062682"><span class="hs-identifier hs-var">halveInterval</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062685"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062691"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062687"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062692"><span class="hs-identifier hs-var">pmid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062689"><span class="hs-identifier hs-var">py</span></a></span><span>
</span><span id="line-531"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>        </span><span id="local-6989586621679062690"><span class="annot"><span class="annottext">width :: a
</span><a href="#local-6989586621679062690"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062687"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062686"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-533"></span><span>        </span><span id="local-6989586621679062691"><span class="annot"><span class="annottext">mid :: a
</span><a href="#local-6989586621679062691"><span class="hs-identifier hs-var hs-var">mid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062686"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062690"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span>
</span><span id="line-534"></span><span>        </span><span id="local-6989586621679062692"><span class="annot"><span class="annottext">pmid :: a
</span><a href="#local-6989586621679062692"><span class="hs-identifier hs-var hs-var">pmid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062678"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062691"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="annot"><span class="hs-comment">{-| Otherwise we have a polynomial:
subtract the value we are looking for so that we seek a zero crossing
-}</span></span><span>
</span><span id="line-539"></span><span id="local-6989586621679061897"><span class="annot"><a href="Numeric.Polynomial.Simple.html#root"><span class="hs-identifier hs-type">root</span></a></span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-543"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679061897"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-546"></span><span id="root"><span class="annot"><span class="annottext">root :: forall a.
(Ord a, Num a, Eq a, Fractional a) =&gt;
a -&gt; a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="Numeric.Polynomial.Simple.html#root"><span class="hs-identifier hs-var hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679062702"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062702"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679062703"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062703"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679062704"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062704"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679062705"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062705"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679062706"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062706"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
forall a.
(Fractional a, Eq a, Num a, Ord a) =&gt;
a -&gt; (a, a) -&gt; Poly a -&gt; Maybe a
</span><a href="Numeric.Polynomial.Simple.html#findRoot"><span class="hs-identifier hs-var">findRoot</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062702"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062704"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062705"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679062706"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679062703"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span></pre></body></html>