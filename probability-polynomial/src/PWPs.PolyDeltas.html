<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="annot"><span class="hs-comment">{-|
Module      : Deltas
Description : Polynomials extended with delta functions
Copyright   : (c) Peter Thompson, 2024
License     : BSD-2-Clause
Maintainer  : peter.thompson@pnsol.com
Stability   : experimental

We extend the polynomials with delta functions so that we can have 'pieces' of either.
We can add and multiply polynomials and add deltas; multiplying deltas only makes sense
in the context of multiplying CDFs, when it will be OK.
We will only be combining a delta and a poly over a zero interval, where the delta dominates.
We can define the operators in a way that keeps the deltas intact and makes the
piecewise integration/differentiation work.
-}</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html"><span class="hs-identifier">PWPs.PolyDeltas</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier">PolyDelta</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Numeric.Polynomial.Simple.html"><span class="hs-identifier">Numeric.Polynomial.Simple</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Poly</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PWPs.PiecewiseClasses.html"><span class="hs-identifier">PWPs.PiecewiseClasses</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="annot"><span class="hs-comment">{-|
A PolyDelta is either a polynomial or a (shifted, scaled) Delta with a mass.
The position of a Delta is stored as its basepoint when doing piecewise operations.
-}</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">data</span><span> </span><span id="PolyDelta"><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-var">PolyDelta</span></a></span></span><span> </span><span id="local-6989586621679074572"><span class="annot"><a href="#local-6989586621679074572"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Pd"><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="D"><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679074572"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074668"><span id="local-6989586621679074676"><span id="local-6989586621679074680"><span class="annot"><span class="annottext">Int -&gt; PolyDelta a -&gt; ShowS
[PolyDelta a] -&gt; ShowS
PolyDelta a -&gt; String
(Int -&gt; PolyDelta a -&gt; ShowS)
-&gt; (PolyDelta a -&gt; String)
-&gt; ([PolyDelta a] -&gt; ShowS)
-&gt; Show (PolyDelta a)
forall a. Show a =&gt; Int -&gt; PolyDelta a -&gt; ShowS
forall a. Show a =&gt; [PolyDelta a] -&gt; ShowS
forall a. Show a =&gt; PolyDelta a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; PolyDelta a -&gt; ShowS
showsPrec :: Int -&gt; PolyDelta a -&gt; ShowS
$cshow :: forall a. Show a =&gt; PolyDelta a -&gt; String
show :: PolyDelta a -&gt; String
$cshowList :: forall a. Show a =&gt; [PolyDelta a] -&gt; ShowS
showList :: [PolyDelta a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074563"><span id="local-6989586621679074688"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679074563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074695"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074695"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679074696"><span class="annot"><span class="annottext">== :: PolyDelta a -&gt; PolyDelta a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074697"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074697"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074695"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074697"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074698"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074698"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074699"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074699"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074698"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074699"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074702"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>    </span><span id="local-6989586621679074708"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; PolyDelta a -&gt; PolyDelta b
</span><span class="hs-identifier hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679074709"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679074709"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074710"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074710"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; PolyDelta b
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679074709"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074710"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679074711"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679074711"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074712"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074712"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly b -&gt; PolyDelta b
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Poly a -&gt; Poly b
forall a b. (a -&gt; b) -&gt; Poly a -&gt; Poly b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679074711"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074712"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">type</span><span> </span><span id="MyConstraints"><span class="annot"><a href="PWPs.PolyDeltas.html#MyConstraints"><span class="hs-identifier hs-var">MyConstraints</span></a></span></span><span> </span><span id="local-6989586621679074713"><span class="annot"><a href="#local-6989586621679074713"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074713"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679074713"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679074713"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">type</span><span> </span><span id="EqNum"><span class="annot"><a href="PWPs.PolyDeltas.html#EqNum"><span class="hs-identifier hs-var">EqNum</span></a></span></span><span> </span><span id="local-6989586621679074714"><span class="annot"><a href="#local-6989586621679074714"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074714"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679074714"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">type</span><span> </span><span id="OrdNumEqFrac"><span class="annot"><a href="PWPs.PolyDeltas.html#OrdNumEqFrac"><span class="hs-identifier hs-var">OrdNumEqFrac</span></a></span></span><span> </span><span id="local-6989586621679074715"><span class="annot"><a href="#local-6989586621679074715"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679074715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679074715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679074715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- Polynomials have zero mass at a single point, so they are dominated by Ds and Hs</span><span>
</span><span id="line-48"></span><span id="local-6989586621679074573"><span class="annot"><a href="PWPs.PolyDeltas.html#plusPD"><span class="hs-identifier hs-type">plusPD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679074573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074573"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-49"></span><span id="plusPD"><span class="annot"><span class="annottext">plusPD :: forall a.
(Eq a, Fractional a) =&gt;
PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#plusPD"><span class="hs-identifier hs-var hs-var">plusPD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074724"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074724"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074725"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074725"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074724"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074725"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="annot"><a href="PWPs.PolyDeltas.html#plusPD"><span class="hs-identifier hs-var">plusPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074727"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074727"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074727"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-51"></span><span class="annot"><a href="PWPs.PolyDeltas.html#plusPD"><span class="hs-identifier hs-var">plusPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074728"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074728"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074728"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-52"></span><span class="annot"><a href="PWPs.PolyDeltas.html#plusPD"><span class="hs-identifier hs-var">plusPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074729"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074729"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074730"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074730"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074729"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074730"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621679074731"><span class="annot"><a href="PWPs.PolyDeltas.html#timesPD"><span class="hs-identifier hs-type">timesPD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074731"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679074731"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074731"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074731"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074731"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-55"></span><span id="timesPD"><span class="annot"><span class="annottext">timesPD :: forall a.
(Eq a, Fractional a) =&gt;
PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#timesPD"><span class="hs-identifier hs-var hs-var">timesPD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074738"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074738"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074739"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074739"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074738"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074739"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="annot"><a href="PWPs.PolyDeltas.html#timesPD"><span class="hs-identifier hs-var">timesPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074741"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074741"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074741"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-57"></span><span class="annot"><a href="PWPs.PolyDeltas.html#timesPD"><span class="hs-identifier hs-var">timesPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074742"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074742"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074742"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-58"></span><span class="annot"><a href="PWPs.PolyDeltas.html#timesPD"><span class="hs-identifier hs-var">timesPD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074743"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074743"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074744"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074744"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074743"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074744"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074584"><span id="local-6989586621679074748"><span class="annot"><a href="PWPs.PolyDeltas.html#MyConstraints"><span class="hs-identifier hs-type">MyConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074584"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074584"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>    </span><span id="local-6989586621679074762"><span class="annot"><span class="annottext">+ :: PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
</span><span class="hs-operator hs-var hs-var hs-var">(+)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
forall a.
(Eq a, Fractional a) =&gt;
PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#plusPD"><span class="hs-identifier hs-var">plusPD</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621679074765"><span class="annot"><span class="annottext">* :: PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
</span><span class="hs-operator hs-var hs-var hs-var">(*)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
forall a.
(Eq a, Fractional a) =&gt;
PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#timesPD"><span class="hs-identifier hs-var">timesPD</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679074768"><span class="annot"><span class="annottext">negate :: PolyDelta a -&gt; PolyDelta a
</span><span class="hs-identifier hs-var hs-var hs-var">negate</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; PolyDelta a -&gt; PolyDelta a
forall a b. (a -&gt; b) -&gt; PolyDelta a -&gt; PolyDelta b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621679074771"><span class="annot"><span class="annottext">abs :: PolyDelta a -&gt; PolyDelta a
</span><a href="#local-6989586621679074771"><span class="hs-identifier hs-var hs-var hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; PolyDelta a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679074776"><span class="annot"><span class="annottext">signum :: PolyDelta a -&gt; PolyDelta a
</span><a href="#local-6989586621679074776"><span class="hs-identifier hs-var hs-var hs-var">signum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; PolyDelta a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-66"></span><span>    </span><span id="local-6989586621679074779"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; PolyDelta a
</span><span class="hs-identifier hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span id="local-6989586621679074780"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679074780"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">(Poly a -&gt; PolyDelta a) -&gt; Poly a -&gt; PolyDelta a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">Poly.constant</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Poly a) -&gt; a -&gt; Poly a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">Prelude.fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679074780"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span id="local-6989586621679074593"><span class="annot"><a href="PWPs.PolyDeltas.html#scalePD"><span class="hs-identifier hs-type">scalePD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#EqNum"><span class="hs-identifier hs-type">EqNum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074593"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074593"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074593"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074593"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-69"></span><span id="scalePD"><span class="annot"><span class="annottext">scalePD :: forall a. EqNum a =&gt; a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#scalePD"><span class="hs-identifier hs-var hs-var">scalePD</span></a></span></span><span> </span><span id="local-6989586621679074787"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074787"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074788"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074788"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. Num a =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#scale"><span class="hs-identifier hs-var">Poly.scale</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074787"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074788"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="annot"><a href="PWPs.PolyDeltas.html#scalePD"><span class="hs-identifier hs-var">scalePD</span></a></span><span> </span><span id="local-6989586621679074790"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074790"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074791"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074791"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074790"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074791"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span id="local-6989586621679074597"><span class="annot"><a href="PWPs.PolyDeltas.html#evaluatePD"><span class="hs-identifier hs-type">evaluatePD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#EqNum"><span class="hs-identifier hs-type">EqNum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074597"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074597"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074597"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074597"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-73"></span><span id="evaluatePD"><span class="annot"><span class="annottext">evaluatePD :: forall a. EqNum a =&gt; a -&gt; PolyDelta a -&gt; a
</span><a href="PWPs.PolyDeltas.html#evaluatePD"><span class="hs-identifier hs-var hs-var">evaluatePD</span></a></span></span><span> </span><span id="local-6989586621679074796"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074796"><span class="hs-identifier hs-var">point</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074797"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074797"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; a -&gt; a
forall a. Num a =&gt; Poly a -&gt; a -&gt; a
</span><a href="Numeric.Polynomial.Simple.html#eval"><span class="hs-identifier hs-var">Poly.eval</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074797"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074796"><span class="hs-identifier hs-var">point</span></a></span><span>
</span><span id="line-74"></span><span class="annot"><a href="PWPs.PolyDeltas.html#evaluatePD"><span class="hs-identifier hs-var">evaluatePD</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074799"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074799"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074799"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span id="local-6989586621679074600"><span class="annot"><a href="PWPs.PolyDeltas.html#boostPD"><span class="hs-identifier hs-type">boostPD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#MyConstraints"><span class="hs-identifier hs-type">MyConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074600"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074600"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074600"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074600"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-77"></span><span id="boostPD"><span class="annot"><span class="annottext">boostPD :: forall a. MyConstraints a =&gt; a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#boostPD"><span class="hs-identifier hs-var hs-var">boostPD</span></a></span></span><span> </span><span id="local-6989586621679074803"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074803"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074804"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074804"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074804"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; PolyDelta a -&gt; PolyDelta a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Poly a
forall a. a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#constant"><span class="hs-identifier hs-var">Poly.constant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074803"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="annot"><a href="PWPs.PolyDeltas.html#boostPD"><span class="hs-identifier hs-var">boostPD</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074805"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074805"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074805"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074606"><span class="annot"><a href="PWPs.PolyDeltas.html#MyConstraints"><span class="hs-identifier hs-type">MyConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PiecewiseClasses.html#Evaluable"><span class="hs-identifier hs-type">Evaluable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679074815"><span class="annot"><span class="annottext">evaluate :: a -&gt; PolyDelta a -&gt; a
</span><a href="#local-6989586621679074815"><span class="hs-identifier hs-var hs-var hs-var">evaluate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a -&gt; a
forall a. EqNum a =&gt; a -&gt; PolyDelta a -&gt; a
</span><a href="PWPs.PolyDeltas.html#evaluatePD"><span class="hs-identifier hs-var">evaluatePD</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679074818"><span class="annot"><span class="annottext">boost :: a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="#local-6989586621679074818"><span class="hs-identifier hs-var hs-var hs-var">boost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a -&gt; PolyDelta a
forall a. MyConstraints a =&gt; a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#boostPD"><span class="hs-identifier hs-var">boostPD</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679074821"><span class="annot"><span class="annottext">scale :: a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="#local-6989586621679074821"><span class="hs-identifier hs-var hs-var hs-var">scale</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a -&gt; PolyDelta a
forall a. EqNum a =&gt; a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#scalePD"><span class="hs-identifier hs-var">scalePD</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><span class="hs-comment">-- | Removes excess basepoints if the objects on either side are the same</span></span><span>
</span><span id="line-85"></span><span id="local-6989586621679074607"><span class="annot"><a href="PWPs.PolyDeltas.html#aggregate"><span class="hs-identifier hs-type">aggregate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074607"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679074607"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074607"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074607"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074607"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074607"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-86"></span><span id="aggregate"><span class="annot"><span class="annottext">aggregate :: forall a. (Eq a, Num a) =&gt; [(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
</span><a href="PWPs.PolyDeltas.html#aggregate"><span class="hs-identifier hs-var hs-var">aggregate</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, PolyDelta a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Empty list of polydeltas&quot;</span></span><span>
</span><span id="line-87"></span><span class="annot"><a href="PWPs.PolyDeltas.html#aggregate"><span class="hs-identifier hs-var">aggregate</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679074834"><span class="annot"><span class="annottext">(a, PolyDelta a)
</span><a href="#local-6989586621679074834"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(a, PolyDelta a)
</span><a href="#local-6989586621679074834"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- need at least two elements to do anything</span><span>
</span><span id="line-88"></span><span class="annot"><a href="PWPs.PolyDeltas.html#aggregate"><span class="hs-identifier hs-var">aggregate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679074835"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074835"><span class="hs-identifier hs-var">bx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074836"><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074836"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679074837"><span class="annot"><span class="annottext">ys :: [(a, PolyDelta a)]
</span><a href="#local-6989586621679074837"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074838"><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074838"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679074839"><span class="annot"><span class="annottext">[(a, PolyDelta a)]
</span><a href="#local-6989586621679074839"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074836"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; PolyDelta a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074838"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
forall a. (Eq a, Num a) =&gt; [(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
</span><a href="PWPs.PolyDeltas.html#aggregate"><span class="hs-identifier hs-var">aggregate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074835"><span class="hs-identifier hs-var">bx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074836"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, PolyDelta a) -&gt; [(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, PolyDelta a)]
</span><a href="#local-6989586621679074839"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- throw away the second basepoint</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074835"><span class="hs-identifier hs-var">bx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074836"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, PolyDelta a) -&gt; [(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
forall a. (Eq a, Num a) =&gt; [(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
</span><a href="PWPs.PolyDeltas.html#aggregate"><span class="hs-identifier hs-var">aggregate</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, PolyDelta a)]
</span><a href="#local-6989586621679074837"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><span class="hs-comment">{-|
When both arguments are polynomials, we check the intervals are non-zero then use convolvePolys and just map the type.
For a delta, lower == upper (invariant to be checked), and the effect of the delta is to translate the other
argument (whichever it is) along by this amount. Need to ensure there is still an initial interval based at zero.
-}</span></span><span>
</span><span id="line-97"></span><span id="local-6989586621679074611"><span class="annot"><a href="PWPs.PolyDeltas.html#convolvePolyDeltas"><span class="hs-identifier hs-type">convolvePolyDeltas</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-102"></span><span id="convolvePolyDeltas"><span class="annot"><span class="annottext">convolvePolyDeltas :: forall a.
(Num a, Fractional a, Ord a) =&gt;
(a, a, PolyDelta a) -&gt; (a, a, PolyDelta a) -&gt; [(a, PolyDelta a)]
</span><a href="PWPs.PolyDeltas.html#convolvePolyDeltas"><span class="hs-identifier hs-var hs-var">convolvePolyDeltas</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074905"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074905"><span class="hs-identifier hs-var">lf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074906"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074906"><span class="hs-identifier hs-var">uf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074907"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074907"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074908"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074908"><span class="hs-identifier hs-var">lg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074909"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074909"><span class="hs-identifier hs-var">ug</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074910"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074910"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074906"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074905"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074909"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074908"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, PolyDelta a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid polynomial interval width&quot;</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-comment">-- convolve the polynomials to get a list of intervals, put the type back and remove redundant intervals</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><span class="annottext">[(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
forall a. (Eq a, Num a) =&gt; [(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
</span><a href="PWPs.PolyDeltas.html#aggregate"><span class="hs-identifier hs-var">aggregate</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, PolyDelta a)] -&gt; [(a, PolyDelta a)])
-&gt; [(a, PolyDelta a)] -&gt; [(a, PolyDelta a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((a, Poly a) -&gt; (a, PolyDelta a))
-&gt; [(a, Poly a)] -&gt; [(a, PolyDelta a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679074913"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074913"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074914"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074914"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074913"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074914"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, a, Poly a) -&gt; (a, a, Poly a) -&gt; [(a, Poly a)]
forall a.
(Fractional a, Eq a, Ord a) =&gt;
(a, a, Poly a) -&gt; (a, a, Poly a) -&gt; [(a, Poly a)]
</span><a href="Numeric.Polynomial.Simple.html#convolve"><span class="hs-identifier hs-var">Poly.convolve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074905"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074906"><span class="hs-identifier hs-var">uf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074907"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074908"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074909"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074910"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="annot"><a href="PWPs.PolyDeltas.html#convolvePolyDeltas"><span class="hs-identifier hs-var">convolvePolyDeltas</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074916"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074916"><span class="hs-identifier hs-var">lf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074917"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074917"><span class="hs-identifier hs-var">uf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074918"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074918"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074919"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074919"><span class="hs-identifier hs-var">lg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074920"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074920"><span class="hs-identifier hs-var">ug</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074921"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074921"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074916"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074917"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, PolyDelta a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-zero delta interval&quot;</span></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074920"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074919"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, PolyDelta a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid polynomial interval width&quot;</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">-- convolving with a zero-sized delta or a zero polynomial gives nothing</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074918"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074921"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- degenerate case of delta at zero: don't shift but scale by the mass of the delta</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074916"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074919"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a -&gt; PolyDelta a
forall a. EqNum a =&gt; a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#scalePD"><span class="hs-identifier hs-var">scalePD</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074918"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074921"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074920"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- translate the polynomial and the interval by the location of the delta and scale it by the delta mass</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- shifted poly can't be zero, so no point in aggregating</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074919"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074916"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a -&gt; PolyDelta a
forall a. EqNum a =&gt; a -&gt; PolyDelta a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#scalePD"><span class="hs-identifier hs-var">scalePD</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074918"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Poly a -&gt; Poly a
forall a. (Fractional a, Eq a, Num a) =&gt; a -&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#translate"><span class="hs-identifier hs-var">Poly.translate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074916"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074921"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074920"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074916"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span class="annot"><a href="PWPs.PolyDeltas.html#convolvePolyDeltas"><span class="hs-identifier hs-var">convolvePolyDeltas</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074925"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074925"><span class="hs-identifier hs-var">lf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074926"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074926"><span class="hs-identifier hs-var">uf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074927"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074927"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074928"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074928"><span class="hs-identifier hs-var">lg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074929"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074929"><span class="hs-identifier hs-var">ug</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074930"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074930"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a, PolyDelta a) -&gt; (a, a, PolyDelta a) -&gt; [(a, PolyDelta a)]
forall a.
(Num a, Fractional a, Ord a) =&gt;
(a, a, PolyDelta a) -&gt; (a, a, PolyDelta a) -&gt; [(a, PolyDelta a)]
</span><a href="PWPs.PolyDeltas.html#convolvePolyDeltas"><span class="hs-identifier hs-var">convolvePolyDeltas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074928"><span class="hs-identifier hs-var">lg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074929"><span class="hs-identifier hs-var">ug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074930"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074925"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074926"><span class="hs-identifier hs-var">uf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074927"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- commutative</span><span>
</span><span id="line-122"></span><span class="annot"><a href="PWPs.PolyDeltas.html#convolvePolyDeltas"><span class="hs-identifier hs-var">convolvePolyDeltas</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074931"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074931"><span class="hs-identifier hs-var">lf</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074932"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074932"><span class="hs-identifier hs-var">uf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074933"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074933"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074934"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074934"><span class="hs-identifier hs-var">lg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074935"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074935"><span class="hs-identifier hs-var">ug</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074936"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074936"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- both deltas</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074931"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074932"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074934"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074935"><span class="hs-identifier hs-var">ug</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(a, PolyDelta a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-zero delta interval&quot;</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">-- convolving with a zero-sized delta gives nothing</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074933"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074936"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">-- degenerate case of deltas at zero: no shifting but mutiply the masses</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074934"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074931"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074933"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074936"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">-- Shift by the sum of the basepoints, multiply the masses, and insert a new initial zero interval</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074934"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074931"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074933"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074936"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074934"><span class="hs-identifier hs-var">lg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074931"><span class="hs-identifier hs-var">lf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074623"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679074623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679074623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679074623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PiecewiseClasses.html#CompactConvolvable"><span class="hs-identifier hs-type">CompactConvolvable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074623"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679074946"><span class="annot"><span class="annottext">convolveIntervals :: (a, a, PolyDelta a) -&gt; (a, a, PolyDelta a) -&gt; [(a, PolyDelta a)]
</span><a href="#local-6989586621679074946"><span class="hs-identifier hs-var hs-var hs-var">convolveIntervals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a, PolyDelta a) -&gt; (a, a, PolyDelta a) -&gt; [(a, PolyDelta a)]
forall a.
(Num a, Fractional a, Ord a) =&gt;
(a, a, PolyDelta a) -&gt; (a, a, PolyDelta a) -&gt; [(a, PolyDelta a)]
</span><a href="PWPs.PolyDeltas.html#convolvePolyDeltas"><span class="hs-identifier hs-var">convolvePolyDeltas</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><span class="hs-comment">{-|
    We merge polynomials if they are equal. We merge Ds/Hs by adding them (not that we expect this case).
    We merge a zero D/H with a polynomial by discarding it. Other cases do not merge.
-}</span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074627"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679074627"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074627"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679074627"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PiecewiseClasses.html#Mergeable"><span class="hs-identifier hs-type">Mergeable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074627"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679074959"><span class="annot"><span class="annottext">mergeObject :: PolyDelta a -&gt; PolyDelta a -&gt; Maybe (PolyDelta a)
</span><a href="#local-6989586621679074959"><span class="hs-identifier hs-var hs-var hs-var">mergeObject</span></a></span></span><span> </span><span id="local-6989586621679074961"><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074961"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679074962"><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074962"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074961"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PolyDelta a
</span><a href="#local-6989586621679074962"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074963"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074963"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074964"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074964"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074963"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074964"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; Maybe (PolyDelta a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074964"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (PolyDelta a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074965"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074965"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074966"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074966"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074965"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; Maybe (PolyDelta a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074966"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (PolyDelta a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074967"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074967"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074968"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074968"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; Maybe (PolyDelta a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074967"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074968"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolyDelta a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PolyDelta a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (PolyDelta a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679074970"><span class="annot"><span class="annottext">zero :: PolyDelta a
</span><a href="#local-6989586621679074970"><span class="hs-identifier hs-var hs-var hs-var">zero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
forall a. Num a =&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#zero"><span class="hs-identifier hs-var">Poly.zero</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621679074628"><span class="annot"><a href="PWPs.PolyDeltas.html#displayPolyDelta"><span class="hs-identifier hs-type">displayPolyDelta</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#OrdNumEqFrac"><span class="hs-identifier hs-type">OrdNumEqFrac</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679074628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-149"></span><span id="displayPolyDelta"><span class="annot"><span class="annottext">displayPolyDelta :: forall a.
OrdNumEqFrac a =&gt;
a -&gt; (a, a, PolyDelta a) -&gt; Either (a, a) [(a, a)]
</span><a href="PWPs.PolyDeltas.html#displayPolyDelta"><span class="hs-identifier hs-var hs-var">displayPolyDelta</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074986"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074986"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074987"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074987"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679074988"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074988"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074986"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074987"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either (a, a) [(a, a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Non-zero delta interval&quot;</span></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; Either (a, a) [(a, a)]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074986"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074988"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span class="annot"><a href="PWPs.PolyDeltas.html#displayPolyDelta"><span class="hs-identifier hs-var">displayPolyDelta</span></a></span><span> </span><span id="local-6989586621679074989"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074989"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074990"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074990"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074991"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074991"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679074992"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074992"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074990"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074991"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either (a, a) [(a, a)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid polynomial interval&quot;</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, a)] -&gt; Either (a, a) [(a, a)]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; (a, a) -&gt; a -&gt; [(a, a)]
forall a. (Ord a, Eq a, Num a) =&gt; Poly a -&gt; (a, a) -&gt; a -&gt; [(a, a)]
</span><a href="Numeric.Polynomial.Simple.html#display"><span class="hs-identifier hs-var">Poly.display</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679074992"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074990"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074991"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074989"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074639"><span class="annot"><a href="PWPs.PolyDeltas.html#OrdNumEqFrac"><span class="hs-identifier hs-type">OrdNumEqFrac</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PiecewiseClasses.html#Displayable"><span class="hs-identifier hs-type">Displayable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074639"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679074999"><span class="annot"><span class="annottext">displayObject :: a -&gt; (a, a, PolyDelta a) -&gt; Either (a, a) [(a, a)]
</span><a href="#local-6989586621679074999"><span class="hs-identifier hs-var hs-var hs-var">displayObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a, PolyDelta a) -&gt; Either (a, a) [(a, a)]
forall a.
OrdNumEqFrac a =&gt;
a -&gt; (a, a, PolyDelta a) -&gt; Either (a, a) [(a, a)]
</span><a href="PWPs.PolyDeltas.html#displayPolyDelta"><span class="hs-identifier hs-var">displayPolyDelta</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074643"><span class="annot"><a href="PWPs.PolyDeltas.html#OrdNumEqFrac"><span class="hs-identifier hs-type">OrdNumEqFrac</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074643"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PiecewiseClasses.html#ComplexityMeasureable"><span class="hs-identifier hs-type">ComplexityMeasureable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074643"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679075014"><span class="annot"><span class="annottext">measureComplexity :: PolyDelta a -&gt; Int
</span><a href="#local-6989586621679075014"><span class="hs-identifier hs-var hs-var hs-var">measureComplexity</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679075016"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679075016"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">Poly.degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679075016"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Int
forall a. (Eq a, Num a) =&gt; Poly a -&gt; Int
</span><a href="Numeric.Polynomial.Simple.html#degree"><span class="hs-identifier hs-var">Poly.degree</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679075016"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><a href="PWPs.PiecewiseClasses.html#measureComplexity"><span class="hs-identifier hs-var">measureComplexity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074650"><span class="annot"><a href="PWPs.PolyDeltas.html#MyConstraints"><span class="hs-identifier hs-type">MyConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PiecewiseClasses.html#StepDifferentiable"><span class="hs-identifier hs-type">StepDifferentiable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074650"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074650"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679075027"><span class="annot"><span class="annottext">differentiateStep :: (a, Poly a) -&gt; PolyDelta a
</span><a href="#local-6989586621679075027"><span class="hs-identifier hs-var hs-var hs-var">differentiateStep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075029"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075029"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075030"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679075030"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075029"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; PolyDelta a
forall a. Poly a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-var">Pd</span></a></span><span> </span><span class="annot"><span class="annottext">(Poly a -&gt; PolyDelta a)
-&gt; (Poly a -&gt; Poly a) -&gt; Poly a -&gt; PolyDelta a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. Num a =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#differentiate"><span class="hs-identifier hs-var">Poly.differentiate</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679075030"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; PolyDelta a
forall a. a -&gt; PolyDelta a
</span><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075029"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621679074655"><span class="annot"><a href="PWPs.PolyDeltas.html#integratePD"><span class="hs-identifier hs-type">integratePD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679074655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074655"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679074655"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-167"></span><span id="integratePD"><span class="annot"><span class="annottext">integratePD :: forall a. (Eq a, Fractional a) =&gt; PolyDelta a -&gt; Either a (Poly a)
</span><a href="PWPs.PolyDeltas.html#integratePD"><span class="hs-identifier hs-var hs-var">integratePD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#Pd"><span class="hs-identifier hs-type">Pd</span></a></span><span> </span><span id="local-6989586621679075038"><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679075038"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Poly a -&gt; Either a (Poly a)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Poly a -&gt; Poly a
forall a. (Eq a, Fractional a) =&gt; Poly a -&gt; Poly a
</span><a href="Numeric.Polynomial.Simple.html#integrate"><span class="hs-identifier hs-var">Poly.integrate</span></a></span><span> </span><span class="annot"><span class="annottext">Poly a
</span><a href="#local-6989586621679075038"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span class="annot"><a href="PWPs.PolyDeltas.html#integratePD"><span class="hs-identifier hs-var">integratePD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#D"><span class="hs-identifier hs-type">D</span></a></span><span> </span><span id="local-6989586621679075040"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075040"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a (Poly a)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075040"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-169"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679074663"><span class="annot"><a href="PWPs.PolyDeltas.html#MyConstraints"><span class="hs-identifier hs-type">MyConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074663"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PWPs.PiecewiseClasses.html#StepIntegrable"><span class="hs-identifier hs-type">StepIntegrable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074663"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PWPs.PolyDeltas.html#PolyDelta"><span class="hs-identifier hs-type">PolyDelta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Polynomial.Simple.html#Poly"><span class="hs-identifier hs-type">Poly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679075049"><span class="annot"><span class="annottext">integrateStep :: PolyDelta a -&gt; Either a (Poly a)
</span><a href="#local-6989586621679075049"><span class="hs-identifier hs-var hs-var hs-var">integrateStep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolyDelta a -&gt; Either a (Poly a)
forall a. (Eq a, Fractional a) =&gt; PolyDelta a -&gt; Either a (Poly a)
</span><a href="PWPs.PolyDeltas.html#integratePD"><span class="hs-identifier hs-var">integratePD</span></a></span><span>
</span><span id="line-171"></span></pre></body></html>